<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.12">
<title>Spring Boot Features</title>
<link rel="stylesheet" href="css/site.css">
<script src="js/setup.js"></script><script defer src="js/site.js"></script>
<script type="application/json" id="anchor-rewrite">
{
"actuator-properties":"application-properties.actuator",
"auto-configuration-classes-from-actuator":"auto-configuration-classes.actuator",
"auto-configuration-classes-from-autoconfigure-module":"auto-configuration-classes.core",
"boot-documentation":"documentation",
"boot-documentation-about":"documentation.about",
"boot-documentation-advanced":"documentation.advanced",
"boot-documentation-first-steps":"documentation.first-steps",
"boot-documentation-getting-help":"documentation.getting-help",
"boot-documentation-learning":"documentation.features",
"boot-documentation-production":"documentation.actuator",
"boot-documentation-upgrading":"documentation.upgrading",
"boot-documentation-workingwith":"documentation.using",
"boot-features":"features",
"boot-features-activemq":"features.messaging.jms.activemq",
"boot-features-adding-active-profiles":"features.profiles.adding-active-profiles",
"boot-features-amqp":"features.messaging.amqp",
"boot-features-application-admin":"features.spring-application.admin",
"boot-features-application-arguments":"features.spring-application.application-arguments",
"boot-features-application-availability":"features.spring-application.application-availability",
"boot-features-application-availability-liveness-state":"features.spring-application.application-availability.liveness",
"boot-features-application-availability-managing":"features.spring-application.application-availability.managing",
"boot-features-application-availability-readiness-state":"features.spring-application.application-availability.readiness",
"boot-features-application-events-and-listeners":"features.spring-application.application-events-and-listeners",
"boot-features-application-exit":"features.spring-application.application-exit",
"boot-features-application-startup-tracking":"features.spring-application.startup-tracking",
"boot-features-artemis":"features.messaging.jms.artemis",
"boot-features-banner":"features.spring-application.banner",
"boot-features-bean-conditions":"features.developing-auto-configuration.condition-annotations.bean-conditions",
"boot-features-caching":"features.caching",
"boot-features-caching-provider":"features.caching.provider",
"boot-features-caching-provider-caffeine":"features.caching.provider.caffeine",
"boot-features-caching-provider-couchbase":"features.caching.provider.couchbase",
"boot-features-caching-provider-ehcache2":"features.caching.provider.ehcache2",
"boot-features-caching-provider-generic":"features.caching.provider.generic",
"boot-features-caching-provider-hazelcast":"features.caching.provider.hazelcast",
"boot-features-caching-provider-infinispan":"features.caching.provider.infinispan",
"boot-features-caching-provider-jcache":"features.caching.provider.jcache",
"boot-features-caching-provider-none":"features.caching.provider.none",
"boot-features-caching-provider-redis":"features.caching.provider.redis",
"boot-features-caching-provider-simple":"features.caching.provider.simple",
"boot-features-cassandra":"features.nosql.cassandra",
"boot-features-class-conditions":"features.developing-auto-configuration.condition-annotations.class-conditions",
"boot-features-command-line-runner":"features.spring-application.command-line-runner",
"boot-features-condition-annotations":"features.developing-auto-configuration.condition-annotations",
"boot-features-configfileapplicationcontextinitializer-test-utility":"features.testing.utilities.config-data-application-context-initializer",
"boot-features-configure-datasource":"features.sql.datasource",
"boot-features-connect-to-production-database":"features.sql.datasource.production",
"boot-features-connect-to-production-database-configuration":"features.sql.datasource.configuration",
"boot-features-connect-to-production-database-connection-pool":"features.sql.datasource.connection-pool",
"boot-features-connecting-to-a-jndi-datasource":"features.sql.datasource.jndi",
"boot-features-connecting-to-cassandra":"features.nosql.cassandra.connecting",
"boot-features-connecting-to-couchbase":"features.nosql.couchbase.connecting",
"boot-features-connecting-to-elasticsearch-reactive-rest":"features.nosql.elasticsearch.connecting-using-reactive-rest",
"boot-features-connecting-to-elasticsearch-rest":"features.nosql.elasticsearch.connecting-using-rest",
"boot-features-connecting-to-elasticsearch-spring-data":"features.nosql.elasticsearch.connecting-using-spring-data",
"boot-features-connecting-to-influxdb":"features.nosql.influxdb.connecting",
"boot-features-connecting-to-mongodb":"features.nosql.mongodb.connecting",
"boot-features-connecting-to-neo4j":"features.nosql.neo4j.connecting",
"boot-features-connecting-to-redis":"features.nosql.redis.connecting",
"boot-features-connecting-to-solr":"features.nosql.solr.connecting",
"boot-features-container-images":"features.container-images",
"boot-features-container-images-building":"features.container-images.building",
"boot-features-container-images-buildpacks":"features.container-images.building.buildpacks",
"boot-features-container-images-docker":"features.container-images.building.dockerfiles",
"boot-features-cors":"features.developing-web-applications.spring-mvc.cors",
"boot-features-couchbase":"features.nosql.couchbase",
"boot-features-creating-and-dropping-jpa-databases":"features.sql.jpa-and-spring-data.creating-and-dropping",
"boot-features-custom-log-configuration":"features.logging.custom-log-configuration",
"boot-features-custom-log-groups":"features.logging.log-groups",
"boot-features-custom-log-levels":"features.logging.log-levels",
"boot-features-custom-starter":"features.developing-auto-configuration.custom-starter",
"boot-features-custom-starter-configuration-keys":"features.developing-auto-configuration.custom-starter.configuration-keys",
"boot-features-custom-starter-module-autoconfigure":"features.developing-auto-configuration.custom-starter.autoconfigure-module",
"boot-features-custom-starter-module-starter":"features.developing-auto-configuration.custom-starter.starter-module",
"boot-features-custom-starter-naming":"features.developing-auto-configuration.custom-starter.naming",
"boot-features-customizing-configurableservletwebserverfactory-directly":"features.developing-web-applications.embedded-container.customizing.direct",
"boot-features-customizing-embedded-containers":"features.developing-web-applications.embedded-container.customizing",
"boot-features-customizing-spring-application":"features.spring-application.customizing-spring-application",
"boot-features-data-jdbc":"features.sql.jdbc",
"boot-features-developing-auto-configuration":"features.developing-auto-configuration",
"boot-features-developing-web-applications":"features.developing-web-applications",
"boot-features-elasticsearch":"features.nosql.elasticsearch",
"boot-features-email":"features.email",
"boot-features-embedded-container":"features.developing-web-applications.embedded-container",
"boot-features-embedded-container-application-context":"features.developing-web-applications.embedded-container.application-context",
"boot-features-embedded-container-context-initializer":"features.developing-web-applications.embedded-container.context-initializer",
"boot-features-embedded-container-servlets-filters-listeners":"features.developing-web-applications.embedded-container.servlets-filters-listeners",
"boot-features-embedded-container-servlets-filters-listeners-beans":"features.developing-web-applications.embedded-container.servlets-filters-listeners.beans",
"boot-features-embedded-container-servlets-filters-listeners-scanning":"features.developing-web-applications.embedded-container.context-initializer.scanning",
"boot-features-embedded-database-support":"features.sql.datasource.embedded",
"boot-features-embedded-kafka":"features.messaging.kafka.embedded",
"boot-features-encrypting-properties":"features.external-config.encrypting",
"boot-features-entity-classes":"features.sql.jpa-and-spring-data.entity-classes",
"boot-features-error-handling":"features.developing-web-applications.spring-mvc.error-handling",
"boot-features-error-handling-custom-error-pages":"features.developing-web-applications.spring-mvc.error-handling.error-pages",
"boot-features-error-handling-mapping-error-pages-without-mvc":"features.developing-web-applications.spring-mvc.error-handling.error-pages-without-spring-mvc",
"boot-features-error-handling-war-deployment":"features.developing-web-applications.spring-mvc.error-handling.in-a-war-deployment",
"boot-features-external-config":"features.external-config",
"boot-features-external-config-3rd-party-configuration":"features.external-config.typesafe-configuration-properties.third-party-configuration",
"boot-features-external-config-application-json":"features.external-config.application-json",
"boot-features-external-config-application-property-files":"features.external-config.files",
"boot-features-external-config-command-line-args":"features.external-config.command-line-args",
"boot-features-external-config-complex-type-merge":"features.external-config.typesafe-configuration-properties.merging-complex-types",
"boot-features-external-config-constructor-binding":"features.external-config.typesafe-configuration-properties.constructor-binding",
"boot-features-external-config-conversion":"features.external-config.typesafe-configuration-properties.conversion",
"boot-features-external-config-conversion-datasize":"features.external-config.typesafe-configuration-properties.conversion.data-sizes",
"boot-features-external-config-conversion-duration":"features.external-config.typesafe-configuration-properties.conversion.durations",
"boot-features-external-config-conversion-period":"features.external-config.typesafe-configuration-properties.conversion.periods",
"boot-features-external-config-enabling":"features.external-config.typesafe-configuration-properties.enabling-annotated-types",
"boot-features-external-config-exposing-yaml-to-spring":"features.external-config.yaml.directly-loading",
"boot-features-external-config-file-activation-properties":"features.external-config.files.activation-properties",
"boot-features-external-config-files":"features.external-config.files",
"boot-features-external-config-files-configtree":"features.external-config.files.configtree",
"boot-features-external-config-files-importing":"features.external-config.files.importing",
"boot-features-external-config-files-importing-extensionless":"features.external-config.file.importing-extensionless",
"boot-features-external-config-files-multi-document":"features.external-config.files.multi-document",
"boot-features-external-config-files-profile-specific":"features.external-config.files.profile-specific",
"boot-features-external-config-files-wildcards":"features.external-config.files.wildcard-locations",
"boot-features-external-config-java-bean-binding":"features.external-config.typesafe-configuration-properties.java-bean-binding",
"boot-features-external-config-loading-yaml":"features.external-config.yaml.directly-loading",
"boot-features-external-config-optional-prefix":"features.external-config.files.optional-prefix",
"boot-features-external-config-placeholders-in-properties":"features.external-config.files.property-placeholders",
"boot-features-external-config-random-values":"features.external-config.random-values",
"boot-features-external-config-relaxed-binding":"features.external-config.typesafe-configuration-properties.relaxed-binding",
"boot-features-external-config-relaxed-binding-from-environment-variables":"features.external-config.typesafe-configuration-properties.relaxed-binding.environment-variables",
"boot-features-external-config-relaxed-binding-maps":"features.external-config.typesafe-configuration-properties.relaxed-binding.maps",
"boot-features-external-config-system-environment":"features.external-config.system-environment",
"boot-features-external-config-typesafe-configuration-properties":"features.external-config.typesafe-configuration-properties",
"boot-features-external-config-using":"features.external-config.typesafe-configuration-properties.using-annotated-types",
"boot-features-external-config-validation":"features.external-config.typesafe-configuration-properties.validation",
"boot-features-external-config-vs-value":"features.external-config.typesafe-configuration-properties.vs-value-annotation",
"boot-features-external-config-yaml":"features.external-config.yaml",
"boot-features-external-config-yaml-to-properties":"features.external-config.yaml.mapping-to-properties",
"boot-features-fluent-builder-api":"features.spring-application.fluent-builder-api",
"boot-features-graceful-shutdown":"features.graceful-shutdown",
"boot-features-hazelcast":"features.hazelcast",
"boot-features-influxdb":"features.nosql.influxdb",
"boot-features-integration":"features.spring-integration",
"boot-features-internationalization":"features.internationalization",
"boot-features-jersey":"features.developing-web-applications.jersey",
"boot-features-jms":"features.messaging.jms",
"boot-features-jms-jndi":"features.messaging.jms.jndi",
"boot-features-jmx":"features.jmx",
"boot-features-jooq":"features.sql.jooq",
"boot-features-jooq-codegen":"features.sql.jooq.codegen",
"boot-features-jooq-customizing":"features.sql.jooq.customizing",
"boot-features-jooq-dslcontext":"features.sql.jooq.dslcontext",
"boot-features-jooq-sqldialect":"features.sql.jooq.sqldialect",
"boot-features-jpa-and-spring-data":"features.sql.jpa-and-spring-data",
"boot-features-jpa-in-web-environment":"features.sql.jpa-and-spring-data.open-entity-manager-in-view",
"boot-features-json":"features.json",
"boot-features-json-components":"features.developing-web-applications.spring-mvc.json",
"boot-features-json-gson":"features.json.gson",
"boot-features-json-jackson":"features.json.jackson",
"boot-features-json-json-b":"features.json.json-b",
"boot-features-jsp-limitations":"features.developing-web-applications.embedded-container.jsp-limitations",
"boot-features-jta":"features.jta",
"boot-features-jta-atomikos":"features.jta.atomikos",
"boot-features-jta-javaee":"features.jta.javaee",
"boot-features-jta-mixed-jms":"features.jta.mixing-xa-and-non-xa-connections",
"boot-features-jta-supporting-alternative-embedded":"features.jta.supporting-alternative-embedded-transaction-manager",
"boot-features-kafka":"features.messaging.kafka",
"boot-features-kafka-extra-props":"features.messaging.kafka.additional-properties",
"boot-features-kafka-receiving-a-message":"features.messaging.kafka.receiving",
"boot-features-kafka-sending-a-message":"features.messaging.kafka.sending",
"boot-features-kafka-streams":"features.messaging.kafka.streams",
"boot-features-kotlin":"features.kotlin",
"boot-features-kotlin-api":"features.kotlin.api",
"boot-features-kotlin-api-extensions":"features.kotlin.api.extensions",
"boot-features-kotlin-api-runapplication":"features.kotlin.api.run-application",
"boot-features-kotlin-configuration-properties":"features.kotlin.configuration-properties",
"boot-features-kotlin-dependency-management":"features.kotlin.dependency-management",
"boot-features-kotlin-null-safety":"features.kotlin.null-safety",
"boot-features-kotlin-requirements":"features.kotlin.requirements",
"boot-features-kotlin-resources":"features.kotlin.resources",
"boot-features-kotlin-resources-examples":"features.kotlin.resources.examples",
"boot-features-kotlin-resources-further-reading":"features.kotlin.resources.further-reading",
"boot-features-kotlin-testing":"features.kotlin.testing",
"boot-features-lazy-initialization":"features.spring-application.lazy-initialization",
"boot-features-ldap":"features.nosql.ldap",
"boot-features-ldap-connecting":"features.nosql.ldap.connecting",
"boot-features-ldap-embedded":"features.nosql.ldap.embedded",
"boot-features-ldap-spring-data-repositories":"features.nosql.ldap.repositories",
"boot-features-locating-auto-configuration-candidates":"features.developing-auto-configuration.locating-auto-configuration-candidates",
"boot-features-log-shutdown-hook":"features.logging.shutdown-hook",
"boot-features-logback-environment-properties":"features.logging.logback-extensions.environment-properties",
"boot-features-logback-extensions":"features.logging.logback-extensions",
"boot-features-logback-extensions-profile-specific":"features.logging.logback-extensions.profile-specific",
"boot-features-logging":"features.logging",
"boot-features-logging-color-coded-output":"features.logging.console-output.color-coded",
"boot-features-logging-console-output":"features.logging.console-output",
"boot-features-logging-file-output":"features.logging.file-output",
"boot-features-logging-file-rotation":"features.logging.file-rotation",
"boot-features-logging-format":"features.logging.log-format",
"boot-features-messaging":"features.messaging",
"boot-features-mongo-embedded":"features.nosql.mongodb.embedded",
"boot-features-mongo-template":"features.nosql.mongodb.template",
"boot-features-mongodb":"features.nosql.mongodb",
"boot-features-neo4j":"features.nosql.neo4j",
"boot-features-nosql":"features.nosql",
"boot-features-output-capture-test-utility":"features.testing.utilities.output-capture",
"boot-features-profile-specific-configuration":"features.profiles.profile-specific-configuration-files",
"boot-features-profiles":"features.profiles",
"boot-features-profiles-groups":"features.profiles.groups",
"boot-features-programmatic-embedded-container-customization":"features.developing-web-applications.embedded-container.customizing.programmatic",
"boot-features-programmatically-setting-profiles":"features.profiles.programmatically-setting-profiles",
"boot-features-property-conditions":"features.developing-auto-configuration.condition-annotations.property-conditions",
"boot-features-quartz":"features.quartz",
"boot-features-r2dbc":"features.sql.r2dbc",
"boot-features-r2dbc-embedded-database":"features.sql.r2dbc.embedded",
"boot-features-r2dbc-using-database-client":"features.sql.r2dbc.using-database-client",
"boot-features-rabbitmq":"features.messaging.amqp.rabbitmq",
"boot-features-reactive-server":"features.developing-web-applications.reactive-server",
"boot-features-reactive-server-resources":"features.developing-web-applications.reactive-server-resources-configuration",
"boot-features-redis":"features.nosql.redis",
"boot-features-resource-conditions":"features.developing-auto-configuration.condition-annotations.resource-conditions",
"boot-features-rest-templates-test-utility":"features.testing.utilities.test-rest-template",
"boot-features-resttemplate":"features.resttemplate",
"boot-features-resttemplate-customization":"features.resttemplate.customization",
"boot-features-rsocket":"features.rsocket",
"boot-features-rsocket-messaging":"features.rsocket.messaging",
"boot-features-rsocket-requester":"features.rsocket.requester",
"boot-features-rsocket-server-auto-configuration":"features.rsocket.server-auto-configuration",
"boot-features-rsocket-strategies-auto-configuration":"features.rsocket.strategies-auto-configuration",
"boot-features-security":"features.security",
"boot-features-security-actuator":"features.security.actuator",
"boot-features-security-authorization-server":"features.security.oauth2.authorization-server",
"boot-features-security-csrf":"features.security.actuator.csrf",
"boot-features-security-mvc":"features.security.spring-mvc",
"boot-features-security-oauth2":"features.security.oauth2",
"boot-features-security-oauth2-client":"features.security.oauth2.client",
"boot-features-security-oauth2-common-providers":"features.security.oauth2.client.common-providers",
"boot-features-security-oauth2-server":"features.security.oauth2.server",
"boot-features-security-saml":"features.security.saml2",
"boot-features-security-saml2-relying-party":"features.security.saml2.relying-party",
"boot-features-security-webflux":"features.security.spring-webflux",
"boot-features-session":"features.spring-session",
"boot-features-solr":"features.nosql.solr",
"boot-features-spel-conditions":"features.developing-auto-configuration.condition-annotations.spel-conditions",
"boot-features-spring-application":"features.spring-application",
"boot-features-spring-data-cassandra-repositories":"features.nosql.cassandra.repositories",
"boot-features-spring-data-couchbase-repositories":"features.nosql.couchbase.repositories",
"boot-features-spring-data-elasticsearch-repositories":"features.nosql.elasticsearch.repositories",
"boot-features-spring-data-jpa-repositories":"features.sql.jpa-and-spring-data.repositories",
"boot-features-spring-data-mongo-repositories":"features.nosql.mongodb.repositories",
"boot-features-spring-data-mongodb-repositories":"features.nosql.mongodb.repositories",
"boot-features-spring-data-neo4j-repositories":"features.nosql.neo4j.repositories",
"boot-features-spring-data-r2dbc-repositories":"features.sql.r2dbc.repositories",
"boot-features-spring-hateoas":"features.developing-web-applications.spring-mvc.spring-hateoas",
"boot-features-spring-message-codes":"features.developing-web-applications.spring-mvc.message-codes",
"boot-features-spring-mvc":"features.developing-web-applications.spring-mvc",
"boot-features-spring-mvc-auto-configuration":"features.developing-web-applications.spring-mvc.auto-configuration",
"boot-features-spring-mvc-message-converters":"features.developing-web-applications.spring-mvc.message-converters",
"boot-features-spring-mvc-pathmatch":"features.developing-web-applications.spring-mvc.content-negotiation",
"boot-features-spring-mvc-static-content":"features.developing-web-applications.spring-mvc.static-content",
"boot-features-spring-mvc-template-engines":"features.developing-web-applications.spring-mvc.template-engines",
"boot-features-spring-mvc-web-binding-initializer":"features.developing-web-applications.spring-mvc.binding-initializer",
"boot-features-spring-mvc-welcome-page":"features.developing-web-applications.spring-mvc.welcome-page",
"boot-features-sql":"features.sql",
"boot-features-sql-h2-console":"features.sql.h2-web-console",
"boot-features-sql-h2-console-custom-path":"features.sql.h2-web-console.custom-path",
"boot-features-startup-failure":"features.spring-application.startup-failure",
"boot-features-task-execution-scheduling":"features.task-execution-and-scheduling",
"boot-features-test-autoconfig":"features.developing-auto-configuration.testing",
"boot-features-test-autoconfig-overriding-classpath":"features.developing-auto-configuration.testing.overriding-classpath",
"boot-features-test-autoconfig-simulating-web-context":"features.developing-auto-configuration.testing.simulating-a-web-context",
"boot-features-test-property-values":"features.testing.utilities.test-property-values",
"boot-features-test-scope-dependencies":"features.testing.test-scope-dependencies",
"boot-features-test-utilities":"features.testing.utilities",
"boot-features-testing":"features.testing",
"boot-features-testing-spring-applications":"features.testing.spring-applications",
"boot-features-testing-spring-boot-application-arguments":"features.testing.spring-boot-applications.using-application-arguments",
"boot-features-testing-spring-boot-applications":"features.testing.spring-boot-applications",
"boot-features-testing-spring-boot-applications-customizing-web-test-client":"features.testing.spring-boot-applications.customizing-web-test-client",
"boot-features-testing-spring-boot-applications-detecting-config":"features.testing.spring-boot-applications.detecting-configuration",
"boot-features-testing-spring-boot-applications-detecting-web-app-type":"features.testing.spring-boot-applications.detecting-web-app-type",
"boot-features-testing-spring-boot-applications-excluding-config":"features.testing.spring-boot-applications.excluding-configuration",
"boot-features-testing-spring-boot-applications-jmx":"features.testing.spring-boot-applications.jmx",
"boot-features-testing-spring-boot-applications-metrics":"features.testing.spring-boot-applications.metrics",
"boot-features-testing-spring-boot-applications-mocking-beans":"features.testing.spring-boot-applications.mocking-beans",
"boot-features-testing-spring-boot-applications-testing-auto-configured-additional-auto-config":"features.testing.spring-boot-applications.additional-autoconfiguration-and-slicing",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-cassandra-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-cassandra",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-data-jdbc-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-jdbc",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-jdbc-test":"features.testing.spring-boot-applications.autoconfigured-jdbc",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-jooq-test":"features.testing.spring-boot-applications.autoconfigured-jooq",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-jpa-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-jpa",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-json-tests":"features.testing.spring-boot-applications.json-tests",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-ldap-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-ldap",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-mongo-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-mongodb",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-mvc-tests":"features.testing.spring-boot-applications.spring-mvc-tests",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-neo4j-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-neo4j",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-redis-test":"features.testing.spring-boot-applications.autoconfigured-spring-data-redis",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-rest-client":"features.testing.spring-boot-applications.autoconfigured-rest-client",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-rest-docs":"features.testing.spring-boot-applications.autoconfigured-spring-restdocs",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-rest-docs-mock-mvc":"features.testing.spring-boot-applications.autoconfigured-spring-restdocs.with-mock-mvc",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-rest-docs-rest-assured":"features.testing.spring-boot-applications.autoconfigured-spring-restdocs.with-rest-assured",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-rest-docs-web-test-client":"features.testing.spring-boot-applications.autoconfigured-spring-restdocs.with-web-test-client",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-tests":"features.testing.spring-boot-applications.autoconfigured-tests",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-webflux-tests":"features.testing.spring-boot-applications.spring-webflux-tests",
"boot-features-testing-spring-boot-applications-testing-autoconfigured-webservices":"features.testing.spring-boot-applications.autoconfigured-webservices",
"boot-features-testing-spring-boot-applications-testing-user-configuration":"features.testing.spring-boot-applications.user-configuration-and-slicing",
"boot-features-testing-spring-boot-applications-testing-with-mock-environment":"features.testing.spring-boot-applications.with-mock-environment",
"boot-features-testing-spring-boot-applications-testing-with-running-server":"features.testing.spring-boot-applications.with-running-server",
"boot-features-testing-spring-boot-applications-with-spock":"features.testing.spring-boot-applications.spock",
"boot-features-understanding-auto-configured-beans":"features.developing-auto-configuration.understanding-auto-configured-beans",
"boot-features-using-amqp-receiving":"features.messaging.amqp.receiving",
"boot-features-using-amqp-sending":"features.messaging.amqp.sending",
"boot-features-using-jdbc-template":"features.sql.jdbc-template",
"boot-features-using-jms-receiving":"features.messaging.jms.receiving",
"boot-features-using-jms-sending":"features.messaging.jms.sending",
"boot-features-validation":"features.validation",
"boot-features-web-application-conditions":"features.developing-auto-configuration.condition-annotations.web-application-conditions",
"boot-features-web-environment":"features.spring-application.web-environment",
"boot-features-webclient":"features.webclient",
"boot-features-webclient-customization":"features.webclient.customization",
"boot-features-webclient-runtime":"features.webclient.runtime",
"boot-features-webflux":"features.developing-web-applications.spring-webflux",
"boot-features-webflux-auto-configuration":"features.developing-web-applications.spring-webflux.auto-configuration",
"boot-features-webflux-error-handling":"features.developing-web-applications.spring-webflux.error-handling",
"boot-features-webflux-error-handling-custom-error-pages":"features.developing-web-applications.spring-webflux.error-handling.error-pages",
"boot-features-webflux-httpcodecs":"features.developing-web-applications.spring-webflux.httpcodecs",
"boot-features-webflux-static-content":"features.developing-web-applications.spring-webflux.static-content",
"boot-features-webflux-template-engines":"features.developing-web-applications.spring-webflux.template-engines",
"boot-features-webflux-web-filters":"features.developing-web-applications.spring-webflux.web-filters",
"boot-features-webflux-welcome-page":"features.developing-web-applications.spring-webflux.welcome-page",
"boot-features-webservices":"features.webservices",
"boot-features-webservices-template":"features.webservices.template",
"boot-features-websockets":"features.websockets",
"boot-features-whats-next":"features.whats-next",
"boot-layering-docker-images":"features.container-images.layering",
"build-tool-plugins-antlib":"build-tool-plugins.antlib",
"build-tool-plugins-find-a-main-class":"build-tool-plugins.other-build-systems.finding-main-class",
"build-tool-plugins-gradle-plugin":"build-tool-plugins.gradle",
"build-tool-plugins-maven-plugin":"build-tool-plugins.maven",
"build-tool-plugins-nested-libraries":"build-tool-plugins.other-build-systems.nested-libraries",
"build-tool-plugins-other-build-systems":"build-tool-plugins.other-build-systems",
"build-tool-plugins-repackage-implementation":"build-tool-plugins.other-build-systems.example-repackage-implementation",
"build-tool-plugins-repackaging-archives":"build-tool-plugins.other-build-systems.repackaging-archives",
"build-tool-plugins-whats-next":"build-tool-plugins.whats-next",
"cache-properties":"application-properties.cache",
"cli-automatic-main-method":"cli.using-the-cli.run.automatic-main-method",
"cli-deduced-grab-annotations":"cli.using-the-cli.run.deduced-grab-annotations",
"cli-default-grab-deduced-coordinates":"cli.using-the-cli.run.deduced-grab-coordinates",
"cli-default-grab-deduced-coordinates-custom-dependency-management":"cli.using-the-cli.run.custom-dependency-management",
"cli-default-import-statements":"cli.using-the-cli.run.default-import-statements",
"cli-groovy-beans-dsl":"cli.groovy-beans-dsl",
"cli-init":"cli.using-the-cli.initialize-new-project",
"cli-install-uninstall":"cli.using-the-cli.extensions",
"cli-installation":"cli.installation",
"cli-jar":"cli.using-the-cli.packaging",
"cli-maven-settings":"cli.maven-setting",
"cli-multiple-source-files":"cli.using-the-cli.multiple-source-files",
"cli-run":"cli.using-the-cli.run",
"cli-shell":"cli.using-the-cli.embedded-shell",
"cli-using-the-cli":"cli.using-the-cli",
"cli-whats-next":"cli.whats-next",
"cloud-deployment":"deployment.cloud",
"cloud-deployment-aws":"deployment.cloud.aws",
"cloud-deployment-aws-beanstalk":"deployment.cloud.aws.beanstalk",
"cloud-deployment-aws-java-se-platform":"deployment.cloud.aws.beanstalk.java-se-platform",
"cloud-deployment-aws-summary":"deployment.cloud.aws.summary",
"cloud-deployment-aws-tomcat-platform":"deployment.cloud.aws.beanstalk.tomcat-platform",
"cloud-deployment-boxfuse":"deployment.cloud.boxfuse",
"cloud-deployment-cloud-foundry":"deployment.cloud.cloud-foundry",
"cloud-deployment-cloud-foundry-services":"deployment.cloud.cloud-foundry.binding-to-services",
"cloud-deployment-gae":"deployment.cloud.google",
"cloud-deployment-heroku":"deployment.cloud.heroku",
"cloud-deployment-kubernetes":"deployment.cloud.kubernetes",
"cloud-deployment-kubernetes-container-lifecycle":"deployment.cloud.kubernetes.container-lifecycle",
"cloud-deployment-openshift":"deployment.cloud.openshift",
"common-application-properties":"application-properties",
"common-application-properties-actuator":"application-properties.actuator",
"common-application-properties-cache":"application-properties.cache",
"common-application-properties-core":"application-properties.core",
"common-application-properties-data":"application-properties.data",
"common-application-properties-data-migration":"application-properties.data-migration",
"common-application-properties-devtools":"application-properties.devtools",
"common-application-properties-integration":"application-properties.integration",
"common-application-properties-json":"application-properties.json",
"common-application-properties-mail":"application-properties.mail",
"common-application-properties-rsocket":"application-properties.rsocket",
"common-application-properties-security":"application-properties.security",
"common-application-properties-server":"application-properties.server",
"common-application-properties-templating":"application-properties.templating",
"common-application-properties-testing":"application-properties.testing",
"common-application-properties-transaction":"application-properties.transaction",
"common-application-properties-web":"application-properties.web",
"configuration-metadata-additional-metadata":"configuration-metadata.annotation-processor.adding-additional-metadata",
"configuration-metadata-annotation-processor":"configuration-metadata.annotation-processor",
"configuration-metadata-annotation-processor-metadata-generation":"configuration-metadata.annotation-processor.automatic-metadata-generation",
"configuration-metadata-annotation-processor-metadata-generation-nested":"configuration-metadata.annotation-processor.automatic-metadata-generation.nested-properties",
"configuration-metadata-annotation-processor-setup":"configuration-metadata.annotation-processor.configuring",
"configuration-metadata-format":"configuration-metadata.format",
"configuration-metadata-group-attributes":"configuration-metadata.format.group",
"configuration-metadata-hints-attributes":"configuration-metadata.format.hints",
"configuration-metadata-property-attributes":"configuration-metadata.format.property",
"configuration-metadata-providing-manual-hints":"configuration-metadata.manual-hints",
"configuration-metadata-providing-manual-hints-any":"configuration-metadata.manual-hints.value-providers.any",
"configuration-metadata-providing-manual-hints-class-reference":"configuration-metadata.manual-hints.value-providers.class-reference",
"configuration-metadata-providing-manual-hints-handle-as":"configuration-metadata.manual-hints.value-providers.handle-as",
"configuration-metadata-providing-manual-hints-logger-name":"configuration-metadata.manual-hints.value-providers.logger-name",
"configuration-metadata-providing-manual-hints-spring-bean-reference":"configuration-metadata.manual-hints.value-providers.spring-bean-reference",
"configuration-metadata-providing-manual-hints-spring-profile-name":"configuration-metadata.manual-hints.value-providers.spring-profile-name",
"configuration-metadata-providing-manual-hints-value-hint":"configuration-metadata.manual-hints.value-hint",
"configuration-metadata-providing-manual-hints-value-providers":"configuration-metadata.manual-hints.value-providers",
"configuration-metadata-repeated-items":"configuration-metadata.format.repeated-items",
"configuring-file-system-watcher":"using.devtools.globalsettings.configuring-file-system-watcher",
"containers-deployment":"deployment.containers",
"core-properties":"application-properties.core",
"data-migration-properties":"application-properties.data-migration",
"data-properties":"application-properties.data",
"dependency-versions-coordinates":"dependency-versions.coordinates",
"dependency-versions-properties":"dependency-versions.properties",
"deployment-initd-service":"deployment.installing.nix-services.init-d",
"deployment-initd-service-securing":"deployment.installing.nix-services.init-d.securing",
"deployment-install":"deployment.installing",
"deployment-install-supported-operating-systems":"deployment.installing.supported-operating-systems",
"deployment-script-customization":"deployment.installing.nix-services.script-customization",
"deployment-script-customization-when-it-runs":"deployment.installing.nix-services.script-customization.when-running",
"deployment-script-customization-when-it-written":"deployment.installing.nix-services.script-customization.when-written",
"deployment-service":"deployment.installing.nix-services",
"deployment-systemd-service":"deployment.installing.nix-services.system-d",
"deployment-whats-next":"deployment.whats-next",
"deployment-windows":"deployment.installing.windows-services",
"devtools-properties":"application-properties.devtools",
"executable-jar-alternatives":"executable-jar.alternatives",
"executable-jar-jar-file-structure":"executable-jar.nested-jars.jar-structure",
"executable-jar-jarfile":"executable-jar.jarfile-class",
"executable-jar-jarfile-compatibility":"executable-jar.jarfile-class.compatibilty",
"executable-jar-launcher-manifest":"executable-jar.launching.manifest",
"executable-jar-launching":"executable-jar.launching",
"executable-jar-nested-jars":"executable-jar.nested-jars",
"executable-jar-property-launcher-features":"executable-jar.property-launcher",
"executable-jar-restrictions":"executable-jar.restrictions",
"executable-jar-war-file-structure":"executable-jar.nested-jars.war-structure",
"executable-jar-war-index-files":"executable-jar.nested-jars.index-files",
"executable-jar-war-index-files-classpath":"executable-jar.nested-jars.classpath-index",
"executable-jar-war-index-files-layers":"executable-jar.nested-jars.layer-index",
"getting-started-cli-command-line-completion":"getting-started.installing.cli.completion",
"getting-started-cli-example":"getting-started.installing.cli.quick-start",
"getting-started-first-application":"getting-started.first-application",
"getting-started-first-application-annotations":"getting-started.first-application.code.mvc-annotations",
"getting-started-first-application-auto-configuration":"getting-started.first-application.code.enable-auto-configuration",
"getting-started-first-application-code":"getting-started.first-application.code",
"getting-started-first-application-dependencies":"getting-started.first-application.dependencies",
"getting-started-first-application-executable-jar":"getting-started.first-application.executable-jar",
"getting-started-first-application-main-method":"getting-started.first-application.code.main-method",
"getting-started-first-application-pom":"getting-started.first-application.pom",
"getting-started-first-application-run":"getting-started.first-application.run",
"getting-started-gradle-installation":"getting-started.installing.java.gradle",
"getting-started-homebrew-cli-installation":"getting-started.installing.cli.homebrew",
"getting-started-installation-instructions-for-java":"getting-started.installing.java",
"getting-started-installing-spring-boot":"getting-started.installing",
"getting-started-installing-the-cli":"getting-started.installing.cli",
"getting-started-introducing-spring-boot":"getting-started.introducing-spring-boot",
"getting-started-macports-cli-installation":"getting-started.installing.cli.macports",
"getting-started-manual-cli-installation":"getting-started.installing.cli.manual-installation",
"getting-started-maven-installation":"getting-started.installing.java.maven",
"getting-started-scoop-cli-installation":"getting-started.installing.cli.scoop",
"getting-started-sdkman-cli-installation":"getting-started.installing.cli.sdkman",
"getting-started-system-requirements":"getting-started.system-requirements",
"getting-started-system-requirements-servlet-containers":"getting-started.system-requirements.servlet-containers",
"getting-started-upgrading-from-an-earlier-version":"getting-started.installing.upgrading",
"getting-started-whats-next":"getting-started.whats-next",
"how-to-enable-http-response-compression":"howto.webserver.enable-response-compression",
"howto-actuator":"howto.actuator",
"howto-add-a-servlet-filter-or-listener":"howto.webserver.add-servlet-filter-listener",
"howto-add-a-servlet-filter-or-listener-as-spring-bean":"howto.webserver.add-servlet-filter-listener.spring-bean",
"howto-add-a-servlet-filter-or-listener-using-scanning":"howto.webserver.add-servlet-filter-listener.using-scanning",
"howto-automatic-expansion":"howto.properties-and-configuration.expand-properties",
"howto-automatic-expansion-gradle":"howto.properties-and-configuration.expand-properties.gradle",
"howto-automatic-expansion-maven":"howto.properties-and-configuration.expand-properties.maven",
"howto-batch-applications":"howto.batch",
"howto-build":"howto.build",
"howto-build-an-application-context-hierarchy":"howto.application.context-hierarchy",
"howto-build-an-executable-archive-with-ant":"howto.build.build-an-executable-archive-with-ant-without-using-spring-boot-antlib",
"howto-build-info":"howto.build.generate-info",
"howto-change-configuration-depending-on-the-environment":"howto.properties-and-configuration.change-configuration-depending-on-the-environment",
"howto-change-the-http-port":"howto.webserver.change-port",
"howto-change-the-http-port-or-address-of-the-actuator-endpoints":"howto.actuator.change-http-port-or-address",
"howto-change-the-location-of-external-properties":"howto.properties-and-configuration.external-properties-location",
"howto-change-the-user-details-service-and-add-user-accounts":"howto.security.change-user-details-service-and-add-user-accounts",
"howto-configure-a-component-that-is-used-by-JPA":"howto.data-access.configure-a-component-that-is-used-by-jpa",
"howto-configure-a-datasource":"howto.data-access.configure-custom-datasource",
"howto-configure-accesslogs":"howto.webserver.configure-access-logs",
"howto-configure-hibernate-naming-strategy":"howto.data-access.configure-hibernate-naming-strategy",
"howto-configure-hibernate-second-level-caching":"howto.data-access.configure-hibernate-second-level-caching",
"howto-configure-http2":"howto.webserver.configure-http2",
"howto-configure-http2-jetty":"howto.webserver.configure-http2.jetty",
"howto-configure-http2-netty":"howto.webserver.configure-http2.netty",
"howto-configure-http2-tomcat":"howto.webserver.configure-http2.tomcat",
"howto-configure-http2-undertow":"howto.webserver.configure-http2.undertow",
"howto-configure-jOOQ-with-multiple-datasources":"howto.data-access.configure-jooq-with-multiple-datasources",
"howto-configure-jpa-properties":"howto.data-access.jpa-properties",
"howto-configure-log4j-for-logging":"howto.logging.log4j",
"howto-configure-log4j-for-logging-yaml-or-json-config":"howto.logging.log4j.yaml-or-json-config",
"howto-configure-logback-for-logging":"howto.logging.logback",
"howto-configure-logback-for-logging-fileonly":"howto.logging.logback.file-only-output",
"howto-configure-ssl":"howto.webserver.configure-ssl",
"howto-configure-webserver":"howto.webserver.configure",
"howto-convert-an-existing-application-to-spring-boot":"howto.traditional-deployment.convert-existing-application",
"howto-create-a-deployable-war-file":"howto.traditional-deployment.war",
"howto-create-a-non-web-application":"howto.application.non-web-application",
"howto-create-a-nonexecutable-jar":"howto.build.create-a-nonexecutable-jar",
"howto-create-an-additional-executable-jar":"howto.build.use-a-spring-boot-application-as-dependency",
"howto-create-an-executable-jar-with-maven":"howto.build.create-an-executable-jar-with-maven",
"howto-create-websocket-endpoints-using-serverendpoint":"howto.webserver.create-websocket-endpoints-using-serverendpoint",
"howto-customize-dependency-versions":"howto.build.customize-dependency-versions",
"howto-customize-the-environment-or-application-context":"howto.application.customize-the-environment-or-application-context",
"howto-customize-the-jackson-objectmapper":"howto.spring-mvc.customize-jackson-objectmapper",
"howto-customize-the-responsebody-rendering":"howto.spring-mvc.customize-responsebody-rendering",
"howto-customize-the-whitelabel-error-page":"howto.actuator.customize-whitelabel-error-page",
"howto-customize-tomcat-behind-a-proxy-server":"howto.webserver.use-behind-a-proxy-server.tomcat",
"howto-customize-view-resolvers":"howto.spring-mvc.customize-view-resolvers",
"howto-data-access":"howto.data-access",
"howto-database-initialization":"howto.data-initialization",
"howto-disable-registration-of-a-servlet-or-filter":"howto.webserver.add-servlet-filter-listener.spring-bean.disable",
"howto-disable-web-server":"howto.webserver.disable",
"howto-discover-build-in-options-for-external-properties":"howto.properties-and-configuration.discover-build-in-options-for-external-properties",
"howto-discover-the-http-port-at-runtime":"howto.webserver.discover-port",
"howto-embedded-web-servers":"howto.webserver",
"howto-enable-https":"howto.security.enable-https",
"howto-enable-multiple-connectors-in-tomcat":"howto.webserver.enable-multiple-connectors-in-tomcat",
"howto-enable-multiple-listeners-in-undertow":"howto.webserver.enable-multiple-listeners-in-undertow",
"howto-enable-tomcat-mbean-registry":"howto.webserver.enable-tomcat-mbean-registry",
"howto-execute-flyway-database-migrations-on-startup":"howto.data-initialization.migration-tool.flyway",
"howto-execute-liquibase-database-migrations-on-startup":"howto.data-initialization.migration-tool.liquibase",
"howto-externalize-configuration":"howto.properties-and-configuration.externalize-configuration",
"howto-extract-specific-libraries-when-an-executable-jar-runs":"howto.build.extract-specific-libraries-when-an-executable-jar-runs",
"howto-failure-analyzer":"howto.application.failure-analyzer",
"howto-git-info":"howto.build.generate-git-info",
"howto-hotswapping":"howto.hotswapping",
"howto-http-clients":"howto.http-clients",
"howto-http-clients-proxy-configuration":"howto.http-clients.rest-template-proxy-configuration",
"howto-initialize-a-database-configuring-dependencies":"howto.data-initialization.dependencies",
"howto-initialize-a-database-configuring-dependencies-depends-on-initialization-detection":"howto.data-initialization.dependencies.depends-on-initialization-detection",
"howto-initialize-a-database-configuring-dependencies-initializer-detection":"howto.data-initialization.dependencies.initializer-detection",
"howto-initialize-a-database-using-basic-scripts":"howto.data-initialization.using-basic-sql-scripts",
"howto-initialize-a-database-using-hibernate":"howto.data-initialization.using-hibernate",
"howto-initialize-a-database-using-jpa":"howto.data-initialization.using-jpa",
"howto-initialize-a-spring-batch-database":"howto.data-initialization.batch",
"howto-jersey":"howto.jersey",
"howto-jersey-alongside-another-web-framework":"howto.jersey.alongside-another-web-framework",
"howto-jersey-spring-security":"howto.jersey.spring-security",
"howto-jms-disable-transaction":"howto.messaging.disable-transacted-jms-session",
"howto-logging":"howto.logging",
"howto-map-health-indicators-to-metrics":"howto.actuator.map-health-indicators-to-metrics",
"howto-messaging":"howto.messaging",
"howto-multipart-file-upload-configuration":"howto.spring-mvc.multipart-file-uploads",
"howto-properties-and-configuration":"howto.properties-and-configuration",
"howto-reload-fast-restart":"howto.hotswapping.fast-application-restarts",
"howto-reload-freemarker-content":"howto.hotswapping.reload-templates.freemarker",
"howto-reload-groovy-template-content":"howto.hotswapping.reload-templates.groovy",
"howto-reload-java-classes-without-restarting":"howto.hotswapping.reload-java-classes-without-restarting",
"howto-reload-static-content":"howto.hotswapping.reload-static-content",
"howto-reload-thymeleaf-content":"howto.hotswapping.reload-templates.thymeleaf",
"howto-reload-thymeleaf-template-content":"howto.hotswapping.reload-templates",
"howto-remote-debug-maven-run":"howto.build.remote-debug-maven",
"howto-sanitize-sensible-values":"howto.actuator.sanitize-sensitive-values",
"howto-sanitize-sensitive-values":"howto.actuator.sanitize-sensitive-values",
"howto-security":"howto.security",
"howto-separate-entity-definitions-from-spring-configuration":"howto.data-access.separate-entity-definitions-from-spring-configuration",
"howto-set-active-spring-profiles":"howto.properties-and-configuration.set-active-spring-profiles",
"howto-spring-batch-running-command-line":"howto.batch.running-from-the-command-line",
"howto-spring-batch-running-jobs-on-startup":"howto.batch.running-jobs-on-startup",
"howto-spring-batch-specifying-a-data-source":"howto.batch.specifying-a-data-source",
"howto-spring-batch-storing-job-repository":"howto.batch.storing-job-repository",
"howto-spring-boot-application":"howto.application",
"howto-spring-mvc":"howto.spring-mvc",
"howto-switch-off-default-mvc-configuration":"howto.spring-mvc.switch-off-default-configuration",
"howto-switch-off-spring-boot-security-configuration":"howto.security.switch-off-spring-boot-configuration",
"howto-switch-off-the-spring-mvc-dispatcherservlet":"howto.spring-mvc.switch-off-dispatcherservlet",
"howto-testcontainers":"howto.testing.testcontainers",
"howto-traditional-deployment":"howto.traditional-deployment",
"howto-troubleshoot-auto-configuration":"howto.application.troubleshoot-auto-configuration",
"howto-two-datasources":"howto.data-access.configure-two-datasources",
"howto-use-a-higher-level-database-migration-tool":"howto.data-initialization.migration-tool",
"howto-use-another-web-server":"howto.webserver.use-another",
"howto-use-behind-a-proxy-server":"howto.webserver.use-behind-a-proxy-server",
"howto-use-custom-entity-manager":"howto.data-access.use-custom-entity-manager",
"howto-use-customize-spring-datas-web-support":"howto.data-access.customize-spring-data-web-support",
"howto-use-dependency-injection-hibernate-components":"howto.data-access.dependency-injection-in-hibernate-components",
"howto-use-exposing-spring-data-repositories-rest-endpoint":"howto.data-access.exposing-spring-data-repositories-as-rest",
"howto-use-jedis-instead-of-lettuce":"howto.nosql.jedis-instead-of-lettuce",
"howto-use-multiple-entity-managers":"howto.data-access.use-multiple-entity-managers",
"howto-use-short-command-line-arguments":"howto.properties-and-configuration.short-command-line-arguments",
"howto-use-spring-data-jpa--and-mongo-repositories":"howto.data-access.use-spring-data-jpa-and-mongo-repositories",
"howto-use-spring-data-repositories":"howto.data-access.spring-data-repositories",
"howto-use-test-with-spring-security":"howto.spring-mvc.testing.with-spring-security",
"howto-use-tomcat-legacycookieprocessor":"howto.webserver.use-tomcat-legacycookieprocessor",
"howto-use-traditional-persistence-xml":"howto.data-access.use-traditional-persistence-xml",
"howto-use-two-entity-managers":"howto.data-access.use-multiple-entity-managers",
"howto-use-yaml-for-external-properties":"howto.properties-and-configuration.yaml",
"howto-user-a-random-unassigned-http-port":"howto.webserver.use-random-port",
"howto-webclient-reactor-netty-customization":"howto.http-clients.webclient-reactor-netty-customization",
"howto-weblogic":"howto.traditional-deployment.weblogic",
"howto-write-a-json-rest-service":"howto.spring-mvc.write-json-rest-service",
"howto-write-an-xml-rest-service":"howto.spring-mvc.write-xml-rest-service",
"integration-properties":"application-properties.integration",
"json-properties":"application-properties.json",
"mail-properties":"application-properties.mail",
"production-ready":"actuator",
"production-ready-application-info":"actuator.endpoints.info",
"production-ready-application-info-autoconfigure":"actuator.endpoints.info.auto-configured-info-contributors",
"production-ready-application-info-build":"actuator.endpoints.info.build-information",
"production-ready-application-info-custom":"actuator.endpoints.info.writing-custom-info-contributors",
"production-ready-application-info-env":"actuator.endpoints.info.custom-application-information",
"production-ready-application-info-git":"actuator.endpoints.info.git-commit-information",
"production-ready-auditing":"actuator.auditing",
"production-ready-auditing-custom":"actuator.auditing.custom",
"production-ready-cloudfoundry":"actuator.cloud-foundry",
"production-ready-cloudfoundry-disable":"actuator.cloud-foundry.disable",
"production-ready-cloudfoundry-ssl":"actuator.cloud-foundry.ssl",
"production-ready-custom-context-path":"actuator.cloud-foundry.custom-context-path",
"production-ready-custom-mbean-names":"actuator.jmx.custom-mbean-names",
"production-ready-customizing-jolokia":"actuator.jmx.jolokia.customizing",
"production-ready-customizing-management-server-address":"actuator.monitoring.customizing-management-server-address",
"production-ready-customizing-management-server-context-path":"actuator.monitoring.customizing-management-server-context-path",
"production-ready-customizing-management-server-port":"actuator.monitoring.customizing-management-server-port",
"production-ready-disable-jmx-endpoints":"actuator.jmx.disable-jmx-endpoints",
"production-ready-disabling-http-endpoints":"actuator.monitoring.disabling-http-endpoints",
"production-ready-disabling-jolokia":"actuator.jmx.jolokia.disabling",
"production-ready-enabling":"actuator.enabling",
"production-ready-endpoints":"actuator.endpoints",
"production-ready-endpoints-caching":"actuator.endpoints.caching",
"production-ready-endpoints-cors":"actuator.endpoints.cors",
"production-ready-endpoints-custom":"actuator.endpoints.implementing-custom",
"production-ready-endpoints-custom-controller":"actuator.endpoints.implementing-custom.controller",
"production-ready-endpoints-custom-input":"actuator.endpoints.implementing-custom.input",
"production-ready-endpoints-custom-input-conversion":"actuator.endpoints.implementing-custom.input.conversion",
"production-ready-endpoints-custom-servlet":"actuator.endpoints.implementing-custom.servlet",
"production-ready-endpoints-custom-web":"actuator.endpoints.implementing-custom.web",
"production-ready-endpoints-custom-web-predicate":"actuator.endpoints.implementing-custom.web.request-predicates",
"production-ready-endpoints-custom-web-predicate-consumes":"actuator.endpoints.implementing-custom.web.consumes-predicates",
"production-ready-endpoints-custom-web-predicate-http-method":"actuator.endpoints.implementing-custom.web.method-predicates",
"production-ready-endpoints-custom-web-predicate-path":"actuator.endpoints.implementing-custom.web.path-predicates",
"production-ready-endpoints-custom-web-predicate-produces":"actuator.endpoints.implementing-custom.web.produces-predicates",
"production-ready-endpoints-custom-web-range-requests":"actuator.endpoints.implementing-custom.web.range-requests",
"production-ready-endpoints-custom-web-response-status":"actuator.endpoints.implementing-custom.web.response-status",
"production-ready-endpoints-custom-web-security":"actuator.endpoints.implementing-custom.web.security",
"production-ready-endpoints-enabling-endpoints":"actuator.endpoints.enabling",
"production-ready-endpoints-exposing-endpoints":"actuator.endpoints.exposing",
"production-ready-endpoints-hypermedia":"actuator.endpoints.hypermedia",
"production-ready-endpoints-security":"actuator.endpoints.security",
"production-ready-health":"actuator.endpoints.health",
"production-ready-health-datasource":"actuator.endpoints.health.datasource",
"production-ready-health-groups":"actuator.endpoints.health.groups",
"production-ready-health-indicators":"actuator.endpoints.health.auto-configured-health-indicators",
"production-ready-health-indicators-writing":"actuator.endpoints.health.writing-custom-health-indicators",
"production-ready-http-tracing":"actuator.tracing",
"production-ready-http-tracing-custom":"actuator.tracing.custom",
"production-ready-jmx":"actuator.jmx",
"production-ready-jolokia":"actuator.jmx.jolokia",
"production-ready-kubernetes-probes":"actuator.endpoints.kubernetes-probes",
"production-ready-kubernetes-probes-external-state":"actuator.endpoints.kubernetes-probes.external-state",
"production-ready-kubernetes-probes-lifecycle":"actuator.endpoints.kubernetes-probes.lifecycle",
"production-ready-logger-configuration":"actuator.loggers.configure",
"production-ready-loggers":"actuator.loggers",
"production-ready-management-specific-ssl":"actuator.monitoring.management-specific-ssl",
"production-ready-metrics":"actuator.metrics",
"production-ready-metrics-cache":"actuator.metrics.supported.cache",
"production-ready-metrics-common-tags":"actuator.metrics.customizing.common-tags",
"production-ready-metrics-custom":"actuator.metrics.registering-custom",
"production-ready-metrics-customizing":"actuator.metrics.customizing",
"production-ready-metrics-data-repository":"actuator.metrics.supported.spring-data-repository",
"production-ready-metrics-endpoint":"actuator.metrics.endpoint",
"production-ready-metrics-export":"actuator.metrics.export",
"production-ready-metrics-export-appoptics":"actuator.metrics.export.appoptics",
"production-ready-metrics-export-atlas":"actuator.metrics.export.atlas",
"production-ready-metrics-export-datadog":"actuator.metrics.export.datadog",
"production-ready-metrics-export-dynatrace":"actuator.metrics.export.dynatrace",
"production-ready-metrics-export-elastic":"actuator.metrics.export.elastic",
"production-ready-metrics-export-ganglia":"actuator.metrics.export.ganglia",
"production-ready-metrics-export-graphite":"actuator.metrics.export.graphite",
"production-ready-metrics-export-humio":"actuator.metrics.export.humio",
"production-ready-metrics-export-influx":"actuator.metrics.export.influx",
"production-ready-metrics-export-jmx":"actuator.metrics.export.jmx",
"production-ready-metrics-export-kairos":"actuator.metrics.export.kairos",
"production-ready-metrics-export-newrelic":"actuator.metrics.export.newrelic",
"production-ready-metrics-export-prometheus":"actuator.metrics.export.prometheus",
"production-ready-metrics-export-signalfx":"actuator.metrics.export.signalfx",
"production-ready-metrics-export-simple":"actuator.metrics.export.simple",
"production-ready-metrics-export-stackdriver":"actuator.metrics.export.stackdriver",
"production-ready-metrics-export-statsd":"actuator.metrics.export.statsd",
"production-ready-metrics-export-wavefront":"actuator.metrics.export.wavefront",
"production-ready-metrics-getting-started":"actuator.metrics.getting-started",
"production-ready-metrics-hibernate":"actuator.metrics.supported.hibernate",
"production-ready-metrics-http-clients":"actuator.metrics.supported.http-clients",
"production-ready-metrics-integration":"actuator.metrics.supported.spring-integration",
"production-ready-metrics-jdbc":"actuator.metrics.supported.jdbc",
"production-ready-metrics-jersey-server":"actuator.metrics.supported.jersey",
"production-ready-metrics-jvm":"actuator.metrics.supported.jvm",
"production-ready-metrics-kafka":"actuator.metrics.supported.kafka",
"production-ready-metrics-logger":"actuator.metrics.supported.logger",
"production-ready-metrics-meter":"actuator.metrics.supported",
"production-ready-metrics-mongodb":"actuator.metrics.supported.mongodb",
"production-ready-metrics-mongodb-command":"actuator.metrics.supported.mongodb.command",
"production-ready-metrics-mongodb-connectionpool":"actuator.metrics.supported.mongodb.connection-pool",
"production-ready-metrics-per-meter-properties":"actuator.metrics.customizing.per-meter-properties",
"production-ready-metrics-rabbitmq":"actuator.metrics.supported.rabbitmq",
"production-ready-metrics-spring-mvc":"actuator.metrics.supported.spring-mvc",
"production-ready-metrics-system":"actuator.metrics.supported.system",
"production-ready-metrics-timed-annotation":"actuator.metrics.supported.timed-annotation",
"production-ready-metrics-tomcat":"actuator.metrics.supported.tomcat",
"production-ready-metrics-web-flux":"actuator.metrics.supported.spring-webflux",
"production-ready-monitoring":"actuator.monitoring",
"production-ready-process-monitoring":"actuator.process-monitoring",
"production-ready-process-monitoring-configuration":"actuator.process-monitoring.configuration",
"production-ready-process-monitoring-programmatically":"actuator.process-monitoring.programmatically",
"production-ready-whats-next":"actuator.whats-next",
"reactive-health-indicators":"actuator.endpoints.health.reactive-health-indicators",
"reactive-health-indicators-autoconfigured":"actuator.endpoints.health.auto-configured-reactive-health-indicators",
"rsocket-properties":"application-properties.rsocket",
"running-remote-client-application":"using.devtools.remote-applications.client",
"security-properties":"application-properties.security",
"server-properties":"application-properties.server",
"spring-boot-ant-exejar":"build-tool-plugins.antlib.tasks.exejar",
"spring-boot-ant-exejar-examples":"build-tool-plugins.antlib.tasks.examples",
"spring-boot-ant-findmainclass":"build-tool-plugins.antlib.findmainclass",
"spring-boot-ant-findmainclass-examples":"build-tool-plugins.antlib.findmainclass.examples",
"spring-boot-ant-tasks":"build-tool-plugins.antlib.tasks",
"spring-boot-reference-documentation":"index",
"templating-properties":"application-properties.templating",
"test-auto-configuration-slices":"test-auto-configuration.slices",
"testing-properties":"application-properties.testing",
"transaction-properties":"application-properties.transaction",
"using-boot":"using",
"using-boot-ant":"using.build-systems.ant",
"using-boot-auto-configuration":"using.auto-configuration",
"using-boot-build-systems":"using.build-systems",
"using-boot-configuration-classes":"using.configuration-classes",
"using-boot-dependency-management":"using.build-systems.dependency-management",
"using-boot-devtools":"using.devtools",
"using-boot-devtools-customizing-classload":"using.devtools.restart.customizing-the-classload",
"using-boot-devtools-globalsettings":"using.devtools.globalsettings",
"using-boot-devtools-known-restart-limitations":"using.devtools.restart.limitations",
"using-boot-devtools-livereload":"using.devtools.livereload",
"using-boot-devtools-property-defaults":"using.devtools.property-defaults",
"using-boot-devtools-remote":"using.devtools.remote-applications",
"using-boot-devtools-remote-update":"using.devtools.remote-applications.update",
"using-boot-devtools-restart":"using.devtools.restart",
"using-boot-devtools-restart-additional-paths":"using.devtools.restart.watching-additional-paths",
"using-boot-devtools-restart-disable":"using.devtools.restart.disable",
"using-boot-devtools-restart-exclude":"using.devtools.restart.excluding-resources",
"using-boot-devtools-restart-logging-condition-delta":"using.devtools.restart.logging-condition-delta",
"using-boot-devtools-restart-triggerfile":"using.devtools.restart.triggerfile",
"using-boot-disabling-specific-auto-configuration":"using.auto-configuration.disabling-specific",
"using-boot-gradle":"using.build-systems.gradle",
"using-boot-hot-swapping":"using.running-your-application.hot-swapping",
"using-boot-importing-configuration":"using.configuration-classes.importing-additional-configuration",
"using-boot-importing-xml-configuration":"using.configuration-classes.importing-xml-configuration",
"using-boot-locating-the-main-class":"using.structuring-your-code.locating-the-main-class",
"using-boot-maven":"using.build-systems.maven",
"using-boot-packaging-for-production":"using.packaging-for-production",
"using-boot-replacing-auto-configuration":"using.auto-configuration.replacing",
"using-boot-running-as-a-packaged-application":"using.running-your-application.as-a-packaged-application",
"using-boot-running-from-an-ide":"using.running-your-application.from-an-ide",
"using-boot-running-with-the-gradle-plugin":"using.running-your-application.with-the-gradle-plugin",
"using-boot-running-with-the-maven-plugin":"using.running-your-application.with-the-maven-plugin",
"using-boot-running-your-application":"using.running-your-application",
"using-boot-spring-beans-and-dependency-injection":"using.spring-beans-and-dependency-injection",
"using-boot-starter":"using.build-systems.starters",
"using-boot-structuring-your-code":"using.structuring-your-code",
"using-boot-using-springbootapplication-annotation":"using.using-the-springbootapplication-annotation",
"using-boot-using-the-default-package":"using.structuring-your-code.using-the-default-package",
"using-boot-whats-next":"using.whats-next",
"web-properties":"application-properties.web"
}
</script>
</head>
<body id="features" class="book toc2 toc-left"><div id="banner-container" class="container" role="banner">
<div id="banner" class="contained" role="banner">
<div id="switch-theme">
<input type="checkbox" id="switch-theme-checkbox" />
<label for="switch-theme-checkbox">Dark Theme</label>
</div>
</div>
</div>
<div id="tocbar-container" class="container" role="navigation">
<div id="tocbar" class="contained" role="navigation">
<button id="toggle-toc"></button>
</div>
</div>
<div id="main-container" class="container">
<div id="main" class="contained">
<div id="doc" class="doc">
<div id="header">
<h1>Spring Boot Features</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<span id="back-to-index"><a href="index.html">Back to index</a></span><ul class="sectlevel1">
<li><a href="#features.spring-application">1. SpringApplication</a>
<ul class="sectlevel2">
<li><a href="#features.spring-application.startup-failure">1.1. Startup Failure</a></li>
<li><a href="#features.spring-application.lazy-initialization">1.2. Lazy Initialization</a></li>
<li><a href="#features.spring-application.banner">1.3. Customizing the Banner</a></li>
<li><a href="#features.spring-application.customizing-spring-application">1.4. Customizing SpringApplication</a></li>
<li><a href="#features.spring-application.fluent-builder-api">1.5. Fluent Builder API</a></li>
<li><a href="#features.spring-application.application-availability">1.6. Application Availability</a>
<ul class="sectlevel3">
<li><a href="#features.spring-application.application-availability.liveness">1.6.1. Liveness State</a></li>
<li><a href="#features.spring-application.application-availability.readiness">1.6.2. Readiness State</a></li>
<li><a href="#features.spring-application.application-availability.managing">1.6.3. Managing the Application Availability State</a></li>
</ul>
</li>
<li><a href="#features.spring-application.application-events-and-listeners">1.7. Application Events and Listeners</a></li>
<li><a href="#features.spring-application.web-environment">1.8. Web Environment</a></li>
<li><a href="#features.spring-application.application-arguments">1.9. Accessing Application Arguments</a></li>
<li><a href="#features.spring-application.command-line-runner">1.10. Using the ApplicationRunner or CommandLineRunner</a></li>
<li><a href="#features.spring-application.application-exit">1.11. Application Exit</a></li>
<li><a href="#features.spring-application.admin">1.12. Admin Features</a></li>
<li><a href="#features.spring-application.startup-tracking">1.13. Application Startup tracking</a></li>
</ul>
</li>
<li><a href="#features.external-config">2. Externalized Configuration</a>
<ul class="sectlevel2">
<li><a href="#features.external-config.command-line-args">2.1. Accessing Command Line Properties</a></li>
<li><a href="#features.external-config.application-json">2.2. JSON Application Properties</a></li>
<li><a href="#features.external-config.files">2.3. External Application Properties </a>
<ul class="sectlevel3">
<li><a href="#features.external-config.files.optional-prefix">2.3.1. Optional Locations</a></li>
<li><a href="#features.external-config.files.wildcard-locations">2.3.2. Wildcard Locations</a></li>
<li><a href="#features.external-config.files.profile-specific">2.3.3. Profile Specific Files</a></li>
<li><a href="#features.external-config.files.importing">2.3.4. Importing Additional Data</a></li>
<li><a href="#features.external-config.files.importing-extensionless">2.3.5. Importing Extensionless Files</a></li>
<li><a href="#features.external-config.files.configtree">2.3.6. Using Configuration Trees</a></li>
<li><a href="#features.external-config.files.property-placeholders">2.3.7. Property Placeholders</a></li>
<li><a href="#features.external-config.files.multi-document">2.3.8. Working with Multi-Document Files</a></li>
<li><a href="#features.external-config.files.activation-properties">2.3.9. Activation Properties</a></li>
</ul>
</li>
<li><a href="#features.external-config.encrypting">2.4. Encrypting Properties</a></li>
<li><a href="#features.external-config.yaml">2.5. Working with YAML</a>
<ul class="sectlevel3">
<li><a href="#features.external-config.yaml.mapping-to-properties">2.5.1. Mapping YAML to Properties</a></li>
<li><a href="#features.external-config.yaml.directly-loading">2.5.2. Directly Loading YAML</a></li>
</ul>
</li>
<li><a href="#features.external-config.random-values">2.6. Configuring Random Values</a></li>
<li><a href="#features.external-config.system-environment">2.7. Configuring System Environment Properties</a></li>
<li><a href="#features.external-config.typesafe-configuration-properties">2.8. Type-safe Configuration Properties</a>
<ul class="sectlevel3">
<li><a href="#features.external-config.typesafe-configuration-properties.java-bean-binding">2.8.1. JavaBean properties binding</a></li>
<li><a href="#features.external-config.typesafe-configuration-properties.constructor-binding">2.8.2. Constructor binding</a></li>
<li><a href="#features.external-config.typesafe-configuration-properties.enabling-annotated-types">2.8.3. Enabling @ConfigurationProperties-annotated types</a></li>
<li><a href="#features.external-config.typesafe-configuration-properties.using-annotated-types">2.8.4. Using @ConfigurationProperties-annotated types</a></li>
<li><a href="#features.external-config.typesafe-configuration-properties.third-party-configuration">2.8.5. Third-party Configuration</a></li>
<li><a href="#features.external-config.typesafe-configuration-properties.relaxed-binding">2.8.6. Relaxed Binding</a>
<ul class="sectlevel4">
<li><a href="#features.external-config.typesafe-configuration-properties.relaxed-binding.maps">Binding Maps</a></li>
<li><a href="#features.external-config.typesafe-configuration-properties.relaxed-binding.environment-variables">Binding from Environment Variables</a></li>
</ul>
</li>
<li><a href="#features.external-config.typesafe-configuration-properties.merging-complex-types">2.8.7. Merging Complex Types</a></li>
<li><a href="#features.external-config.typesafe-configuration-properties.conversion">2.8.8. Properties Conversion</a>
<ul class="sectlevel4">
<li><a href="#features.external-config.typesafe-configuration-properties.conversion.durations">Converting Durations</a></li>
<li><a href="#features.external-config.typesafe-configuration-properties.conversion.periods">Converting periods</a></li>
<li><a href="#features.external-config.typesafe-configuration-properties.conversion.data-sizes">Converting Data Sizes</a></li>
</ul>
</li>
<li><a href="#features.external-config.typesafe-configuration-properties.validation">2.8.9. @ConfigurationProperties Validation</a></li>
<li><a href="#features.external-config.typesafe-configuration-properties.vs-value-annotation">2.8.10. @ConfigurationProperties vs. @Value</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#features.profiles">3. Profiles</a>
<ul class="sectlevel2">
<li><a href="#features.profiles.adding-active-profiles">3.1. Adding Active Profiles</a></li>
<li><a href="#features.profiles.groups">3.2. Profile Groups</a></li>
<li><a href="#features.profiles.programmatically-setting-profiles">3.3. Programmatically Setting Profiles</a></li>
<li><a href="#features.profiles.profile-specific-configuration-files">3.4. Profile-specific Configuration Files</a></li>
</ul>
</li>
<li><a href="#features.logging">4. Logging</a>
<ul class="sectlevel2">
<li><a href="#features.logging.log-format">4.1. Log Format</a></li>
<li><a href="#features.logging.console-output">4.2. Console Output</a>
<ul class="sectlevel3">
<li><a href="#features.logging.console-output.color-coded">4.2.1. Color-coded Output</a></li>
</ul>
</li>
<li><a href="#features.logging.file-output">4.3. File Output</a></li>
<li><a href="#features.logging.file-rotation">4.4. File Rotation</a></li>
<li><a href="#features.logging.log-levels">4.5. Log Levels</a></li>
<li><a href="#features.logging.log-groups">4.6. Log Groups</a></li>
<li><a href="#features.logging.shutdown-hook">4.7. Using a Log Shutdown Hook</a></li>
<li><a href="#features.logging.custom-log-configuration">4.8. Custom Log Configuration</a></li>
<li><a href="#features.logging.logback-extensions">4.9. Logback Extensions</a>
<ul class="sectlevel3">
<li><a href="#features.logging.logback-extensions.profile-specific">4.9.1. Profile-specific Configuration</a></li>
<li><a href="#features.logging.logback-extensions.environment-properties">4.9.2. Environment Properties</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#features.internationalization">5. Internationalization</a></li>
<li><a href="#features.json">6. JSON</a>
<ul class="sectlevel2">
<li><a href="#features.json.jackson">6.1. Jackson</a></li>
<li><a href="#features.json.gson">6.2. Gson</a></li>
<li><a href="#features.json.json-b">6.3. JSON-B</a></li>
</ul>
</li>
<li><a href="#features.developing-web-applications">7. Developing Web Applications</a>
<ul class="sectlevel2">
<li><a href="#features.developing-web-applications.spring-mvc">7.1. The &#8220;Spring Web MVC Framework&#8221;</a>
<ul class="sectlevel3">
<li><a href="#features.developing-web-applications.spring-mvc.auto-configuration">7.1.1. Spring MVC Auto-configuration</a></li>
<li><a href="#features.developing-web-applications.spring-mvc.message-converters">7.1.2. HttpMessageConverters</a></li>
<li><a href="#features.developing-web-applications.spring-mvc.json">7.1.3. Custom JSON Serializers and Deserializers</a></li>
<li><a href="#features.developing-web-applications.spring-mvc.message-codes">7.1.4. MessageCodesResolver</a></li>
<li><a href="#features.developing-web-applications.spring-mvc.static-content">7.1.5. Static Content</a></li>
<li><a href="#features.developing-web-applications.spring-mvc.welcome-page">7.1.6. Welcome Page</a></li>
<li><a href="#features.developing-web-applications.spring-mvc.content-negotiation">7.1.7. Path Matching and Content Negotiation</a></li>
<li><a href="#features.developing-web-applications.spring-mvc.binding-initializer">7.1.8. ConfigurableWebBindingInitializer</a></li>
<li><a href="#features.developing-web-applications.spring-mvc.template-engines">7.1.9. Template Engines</a></li>
<li><a href="#features.developing-web-applications.spring-mvc.error-handling">7.1.10. Error Handling</a>
<ul class="sectlevel4">
<li><a href="#features.developing-web-applications.spring-mvc.error-handling.error-pages">Custom Error Pages</a></li>
<li><a href="#features.developing-web-applications.spring-mvc.error-handling.error-pages-without-spring-mvc">Mapping Error Pages outside of Spring MVC</a></li>
<li><a href="#features.developing-web-applications.spring-mvc.error-handling.in-a-war-deployment">Error handling in a war deployment</a></li>
</ul>
</li>
<li><a href="#features.developing-web-applications.spring-mvc.spring-hateoas">7.1.11. Spring HATEOAS</a></li>
<li><a href="#features.developing-web-applications.spring-mvc.cors">7.1.12. CORS Support</a></li>
</ul>
</li>
<li><a href="#features.developing-web-applications.spring-webflux">7.2. The &#8220;Spring WebFlux Framework&#8221;</a>
<ul class="sectlevel3">
<li><a href="#features.developing-web-applications.spring-webflux.auto-configuration">7.2.1. Spring WebFlux Auto-configuration</a></li>
<li><a href="#features.developing-web-applications.spring-webflux.httpcodecs">7.2.2. HTTP Codecs with HttpMessageReaders and HttpMessageWriters</a></li>
<li><a href="#features.developing-web-applications.spring-webflux.static-content">7.2.3. Static Content</a></li>
<li><a href="#features.developing-web-applications.spring-webflux.welcome-page">7.2.4. Welcome Page</a></li>
<li><a href="#features.developing-web-applications.spring-webflux.template-engines">7.2.5. Template Engines</a></li>
<li><a href="#features.developing-web-applications.spring-webflux.error-handling">7.2.6. Error Handling</a>
<ul class="sectlevel4">
<li><a href="#features.developing-web-applications.spring-webflux.error-handling.error-pages">Custom Error Pages</a></li>
</ul>
</li>
<li><a href="#features.developing-web-applications.spring-webflux.web-filters">7.2.7. Web Filters</a></li>
</ul>
</li>
<li><a href="#features.developing-web-applications.jersey">7.3. JAX-RS and Jersey</a></li>
<li><a href="#features.developing-web-applications.embedded-container">7.4. Embedded Servlet Container Support</a>
<ul class="sectlevel3">
<li><a href="#features.developing-web-applications.embedded-container.servlets-filters-listeners">7.4.1. Servlets, Filters, and listeners</a>
<ul class="sectlevel4">
<li><a href="#features.developing-web-applications.embedded-container.servlets-filters-listeners.beans">Registering Servlets, Filters, and Listeners as Spring Beans</a></li>
</ul>
</li>
<li><a href="#features.developing-web-applications.embedded-container.context-initializer">7.4.2. Servlet Context Initialization</a>
<ul class="sectlevel4">
<li><a href="#features.developing-web-applications.embedded-container.context-initializer.scanning">Scanning for Servlets, Filters, and listeners</a></li>
</ul>
</li>
<li><a href="#features.developing-web-applications.embedded-container.application-context">7.4.3. The ServletWebServerApplicationContext</a></li>
<li><a href="#features.developing-web-applications.embedded-container.customizing">7.4.4. Customizing Embedded Servlet Containers</a>
<ul class="sectlevel4">
<li><a href="#features.developing-web-applications.embedded-container.customizing.programmatic">Programmatic Customization</a></li>
<li><a href="#features.developing-web-applications.embedded-container.customizing.direct">Customizing ConfigurableServletWebServerFactory Directly</a></li>
</ul>
</li>
<li><a href="#features.developing-web-applications.embedded-container.jsp-limitations">7.4.5. JSP Limitations</a></li>
</ul>
</li>
<li><a href="#features.developing-web-applications.reactive-server">7.5. Embedded Reactive Server Support</a></li>
<li><a href="#features.developing-web-applications.reactive-server-resources-configuration">7.6. Reactive Server Resources Configuration</a></li>
</ul>
</li>
<li><a href="#features.graceful-shutdown">8. Graceful shutdown</a></li>
<li><a href="#features.rsocket">9. RSocket</a>
<ul class="sectlevel2">
<li><a href="#features.rsocket.strategies-auto-configuration">9.1. RSocket Strategies Auto-configuration</a></li>
<li><a href="#features.rsocket.server-auto-configuration">9.2. RSocket server Auto-configuration</a></li>
<li><a href="#features.rsocket.messaging">9.3. Spring Messaging RSocket support</a></li>
<li><a href="#features.rsocket.requester">9.4. Calling RSocket Services with RSocketRequester</a></li>
</ul>
</li>
<li><a href="#features.security">10. Security</a>
<ul class="sectlevel2">
<li><a href="#features.security.spring-mvc">10.1. MVC Security</a></li>
<li><a href="#features.security.spring-webflux">10.2. WebFlux Security</a></li>
<li><a href="#features.security.oauth2">10.3. OAuth2</a>
<ul class="sectlevel3">
<li><a href="#features.security.oauth2.client">10.3.1. Client</a>
<ul class="sectlevel4">
<li><a href="#features.security.oauth2.client.common-providers">OAuth2 client registration for common providers</a></li>
</ul>
</li>
<li><a href="#features.security.oauth2.server">10.3.2. Resource Server</a></li>
<li><a href="#features.security.oauth2.authorization-server">10.3.3. Authorization Server</a></li>
</ul>
</li>
<li><a href="#features.security.saml2">10.4. SAML 2.0</a>
<ul class="sectlevel3">
<li><a href="#features.security.saml2.relying-party">10.4.1. Relying Party</a></li>
</ul>
</li>
<li><a href="#features.security.actuator">10.5. Actuator Security</a>
<ul class="sectlevel3">
<li><a href="#features.security.actuator.csrf">10.5.1. Cross Site Request Forgery Protection</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#features.sql">11. Working with SQL Databases</a>
<ul class="sectlevel2">
<li><a href="#features.sql.datasource">11.1. Configure a DataSource</a>
<ul class="sectlevel3">
<li><a href="#features.sql.datasource.embedded">11.1.1. Embedded Database Support</a></li>
<li><a href="#features.sql.datasource.production">11.1.2. Connection to a Production Database</a></li>
<li><a href="#features.sql.datasource.configuration">11.1.3. DataSource Configuration</a></li>
<li><a href="#features.sql.datasource.connection-pool">11.1.4. Supported Connection Pools</a></li>
<li><a href="#features.sql.datasource.jndi">11.1.5. Connection to a JNDI DataSource</a></li>
</ul>
</li>
<li><a href="#features.sql.jdbc-template">11.2. Using JdbcTemplate</a></li>
<li><a href="#features.sql.jpa-and-spring-data">11.3. JPA and Spring Data JPA</a>
<ul class="sectlevel3">
<li><a href="#features.sql.jpa-and-spring-data.entity-classes">11.3.1. Entity Classes</a></li>
<li><a href="#features.sql.jpa-and-spring-data.repositories">11.3.2. Spring Data JPA Repositories</a></li>
<li><a href="#features.sql.jpa-and-spring-data.creating-and-dropping">11.3.3. Creating and Dropping JPA Databases</a></li>
<li><a href="#features.sql.jpa-and-spring-data.open-entity-manager-in-view">11.3.4. Open EntityManager in View</a></li>
</ul>
</li>
<li><a href="#features.sql.jdbc">11.4. Spring Data JDBC</a></li>
<li><a href="#features.sql.h2-web-console">11.5. Using H2&#8217;s Web Console</a>
<ul class="sectlevel3">
<li><a href="#features.sql.h2-web-console.custom-path">11.5.1. Changing the H2 Console&#8217;s Path</a></li>
</ul>
</li>
<li><a href="#features.sql.jooq">11.6. Using jOOQ</a>
<ul class="sectlevel3">
<li><a href="#features.sql.jooq.codegen">11.6.1. Code Generation</a></li>
<li><a href="#features.sql.jooq.dslcontext">11.6.2. Using DSLContext</a></li>
<li><a href="#features.sql.jooq.sqldialect">11.6.3. jOOQ SQL Dialect</a></li>
<li><a href="#features.sql.jooq.customizing">11.6.4. Customizing jOOQ</a></li>
</ul>
</li>
<li><a href="#features.sql.r2dbc">11.7. Using R2DBC</a>
<ul class="sectlevel3">
<li><a href="#features.sql.r2dbc.embedded">11.7.1. Embedded Database Support</a></li>
<li><a href="#features.sql.r2dbc.using-database-client">11.7.2. Using DatabaseClient</a></li>
<li><a href="#features.sql.r2dbc.repositories">11.7.3. Spring Data R2DBC Repositories</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#features.nosql">12. Working with NoSQL Technologies</a>
<ul class="sectlevel2">
<li><a href="#features.nosql.redis">12.1. Redis</a>
<ul class="sectlevel3">
<li><a href="#features.nosql.redis.connecting">12.1.1. Connecting to Redis</a></li>
</ul>
</li>
<li><a href="#features.nosql.mongodb">12.2. MongoDB</a>
<ul class="sectlevel3">
<li><a href="#features.nosql.mongodb.connecting">12.2.1. Connecting to a MongoDB Database</a></li>
<li><a href="#features.nosql.mongodb.template">12.2.2. MongoTemplate</a></li>
<li><a href="#features.nosql.mongodb.repositories">12.2.3. Spring Data MongoDB Repositories</a></li>
<li><a href="#features.nosql.mongodb.embedded">12.2.4. Embedded Mongo</a></li>
</ul>
</li>
<li><a href="#features.nosql.neo4j">12.3. Neo4j</a>
<ul class="sectlevel3">
<li><a href="#features.nosql.neo4j.connecting">12.3.1. Connecting to a Neo4j Database</a></li>
<li><a href="#features.nosql.neo4j.repositories">12.3.2. Spring Data Neo4j Repositories</a></li>
</ul>
</li>
<li><a href="#features.nosql.solr">12.4. Solr</a>
<ul class="sectlevel3">
<li><a href="#features.nosql.solr.connecting">12.4.1. Connecting to Solr</a></li>
</ul>
</li>
<li><a href="#features.nosql.elasticsearch">12.5. Elasticsearch</a>
<ul class="sectlevel3">
<li><a href="#features.nosql.elasticsearch.connecting-using-rest">12.5.1. Connecting to Elasticsearch using REST clients</a></li>
<li><a href="#features.nosql.elasticsearch.connecting-using-reactive-rest">12.5.2. Connecting to Elasticsearch using Reactive REST clients</a></li>
<li><a href="#features.nosql.elasticsearch.connecting-using-spring-data">12.5.3. Connecting to Elasticsearch by Using Spring Data</a></li>
<li><a href="#features.nosql.elasticsearch.repositories">12.5.4. Spring Data Elasticsearch Repositories</a></li>
</ul>
</li>
<li><a href="#features.nosql.cassandra">12.6. Cassandra</a>
<ul class="sectlevel3">
<li><a href="#features.nosql.cassandra.connecting">12.6.1. Connecting to Cassandra</a></li>
<li><a href="#features.nosql.cassandra.repositories">12.6.2. Spring Data Cassandra Repositories</a></li>
</ul>
</li>
<li><a href="#features.nosql.couchbase">12.7. Couchbase</a>
<ul class="sectlevel3">
<li><a href="#features.nosql.couchbase.connecting">12.7.1. Connecting to Couchbase</a></li>
<li><a href="#features.nosql.couchbase.repositories">12.7.2. Spring Data Couchbase Repositories</a></li>
</ul>
</li>
<li><a href="#features.nosql.ldap">12.8. LDAP</a>
<ul class="sectlevel3">
<li><a href="#features.nosql.ldap.connecting">12.8.1. Connecting to an LDAP Server</a></li>
<li><a href="#features.nosql.ldap.repositories">12.8.2. Spring Data LDAP Repositories</a></li>
<li><a href="#features.nosql.ldap.embedded">12.8.3. Embedded In-memory LDAP Server</a></li>
</ul>
</li>
<li><a href="#features.nosql.influxdb">12.9. InfluxDB</a>
<ul class="sectlevel3">
<li><a href="#features.nosql.influxdb.connecting">12.9.1. Connecting to InfluxDB</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#features.caching">13. Caching</a>
<ul class="sectlevel2">
<li><a href="#features.caching.provider">13.1. Supported Cache Providers</a>
<ul class="sectlevel3">
<li><a href="#features.caching.provider.generic">13.1.1. Generic</a></li>
<li><a href="#features.caching.provider.jcache">13.1.2. JCache (JSR-107)</a></li>
<li><a href="#features.caching.provider.ehcache2">13.1.3. EhCache 2.x</a></li>
<li><a href="#features.caching.provider.hazelcast">13.1.4. Hazelcast</a></li>
<li><a href="#features.caching.provider.infinispan">13.1.5. Infinispan</a></li>
<li><a href="#features.caching.provider.couchbase">13.1.6. Couchbase</a></li>
<li><a href="#features.caching.provider.redis">13.1.7. Redis</a></li>
<li><a href="#features.caching.provider.caffeine">13.1.8. Caffeine</a></li>
<li><a href="#features.caching.provider.simple">13.1.9. Simple</a></li>
<li><a href="#features.caching.provider.none">13.1.10. None</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#features.messaging">14. Messaging</a>
<ul class="sectlevel2">
<li><a href="#features.messaging.jms">14.1. JMS</a>
<ul class="sectlevel3">
<li><a href="#features.messaging.jms.activemq">14.1.1. ActiveMQ Support</a></li>
<li><a href="#features.messaging.jms.artemis">14.1.2. ActiveMQ Artemis Support</a></li>
<li><a href="#features.messaging.jms.jndi">14.1.3. Using a JNDI ConnectionFactory</a></li>
<li><a href="#features.messaging.jms.sending">14.1.4. Sending a Message</a></li>
<li><a href="#features.messaging.jms.receiving">14.1.5. Receiving a Message</a></li>
</ul>
</li>
<li><a href="#features.messaging.amqp">14.2. AMQP</a>
<ul class="sectlevel3">
<li><a href="#features.messaging.amqp.rabbitmq">14.2.1. RabbitMQ support</a></li>
<li><a href="#features.messaging.amqp.sending">14.2.2. Sending a Message</a></li>
<li><a href="#features.messaging.amqp.receiving">14.2.3. Receiving a Message</a></li>
</ul>
</li>
<li><a href="#features.messaging.kafka">14.3. Apache Kafka Support</a>
<ul class="sectlevel3">
<li><a href="#features.messaging.kafka.sending">14.3.1. Sending a Message</a></li>
<li><a href="#features.messaging.kafka.receiving">14.3.2. Receiving a Message</a></li>
<li><a href="#features.messaging.kafka.streams">14.3.3. Kafka Streams</a></li>
<li><a href="#features.messaging.kafka.additional-properties">14.3.4. Additional Kafka Properties</a></li>
<li><a href="#features.messaging.kafka.embedded">14.3.5. Testing with Embedded Kafka</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#features.resttemplate">15. Calling REST Services with RestTemplate</a>
<ul class="sectlevel2">
<li><a href="#features.resttemplate.customization">15.1. RestTemplate Customization</a></li>
</ul>
</li>
<li><a href="#features.webclient">16. Calling REST Services with WebClient</a>
<ul class="sectlevel2">
<li><a href="#features.webclient.runtime">16.1. WebClient Runtime</a></li>
<li><a href="#features.webclient.customization">16.2. WebClient Customization</a></li>
</ul>
</li>
<li><a href="#features.validation">17. Validation</a></li>
<li><a href="#features.email">18. Sending Email</a></li>
<li><a href="#features.jta">19. Distributed Transactions with JTA</a>
<ul class="sectlevel2">
<li><a href="#features.jta.atomikos">19.1. Using an Atomikos Transaction Manager</a></li>
<li><a href="#features.jta.javaee">19.2. Using a Java EE Managed Transaction Manager</a></li>
<li><a href="#features.jta.mixing-xa-and-non-xa-connections">19.3. Mixing XA and Non-XA JMS Connections</a></li>
<li><a href="#features.jta.supporting-alternative-embedded-transaction-manager">19.4. Supporting an Alternative Embedded Transaction Manager</a></li>
</ul>
</li>
<li><a href="#features.hazelcast">20. Hazelcast</a></li>
<li><a href="#features.quartz">21. Quartz Scheduler</a></li>
<li><a href="#features.task-execution-and-scheduling">22. Task Execution and Scheduling</a></li>
<li><a href="#features.spring-integration">23. Spring Integration</a></li>
<li><a href="#features.spring-session">24. Spring Session</a></li>
<li><a href="#features.jmx">25. Monitoring and Management over JMX</a></li>
<li><a href="#features.testing">26. Testing</a>
<ul class="sectlevel2">
<li><a href="#features.testing.test-scope-dependencies">26.1. Test Scope Dependencies</a></li>
<li><a href="#features.testing.spring-applications">26.2. Testing Spring Applications</a></li>
<li><a href="#features.testing.spring-boot-applications">26.3. Testing Spring Boot Applications</a>
<ul class="sectlevel3">
<li><a href="#features.testing.spring-boot-applications.detecting-web-app-type">26.3.1. Detecting Web Application Type</a></li>
<li><a href="#features.testing.spring-boot-applications.detecting-configuration">26.3.2. Detecting Test Configuration</a></li>
<li><a href="#features.testing.spring-boot-applications.excluding-configuration">26.3.3. Excluding Test Configuration</a></li>
<li><a href="#features.testing.spring-boot-applications.using-application-arguments">26.3.4. Using Application Arguments</a></li>
<li><a href="#features.testing.spring-boot-applications.with-mock-environment">26.3.5. Testing with a mock environment</a></li>
<li><a href="#features.testing.spring-boot-applications.with-running-server">26.3.6. Testing with a running server</a></li>
<li><a href="#features.testing.spring-boot-applications.customizing-web-test-client">26.3.7. Customizing WebTestClient</a></li>
<li><a href="#features.testing.spring-boot-applications.jmx">26.3.8. Using JMX</a></li>
<li><a href="#features.testing.spring-boot-applications.metrics">26.3.9. Using Metrics</a></li>
<li><a href="#features.testing.spring-boot-applications.mocking-beans">26.3.10. Mocking and Spying Beans</a></li>
<li><a href="#features.testing.spring-boot-applications.autoconfigured-tests">26.3.11. Auto-configured Tests</a></li>
<li><a href="#features.testing.spring-boot-applications.json-tests">26.3.12. Auto-configured JSON Tests</a></li>
<li><a href="#features.testing.spring-boot-applications.spring-mvc-tests">26.3.13. Auto-configured Spring MVC Tests</a></li>
<li><a href="#features.testing.spring-boot-applications.spring-webflux-tests">26.3.14. Auto-configured Spring WebFlux Tests</a></li>
<li><a href="#features.testing.spring-boot-applications.autoconfigured-spring-data-cassandra">26.3.15. Auto-configured Data Cassandra Tests</a></li>
<li><a href="#features.testing.spring-boot-applications.autoconfigured-spring-data-jpa">26.3.16. Auto-configured Data JPA Tests</a></li>
<li><a href="#features.testing.spring-boot-applications.autoconfigured-jdbc">26.3.17. Auto-configured JDBC Tests</a></li>
<li><a href="#features.testing.spring-boot-applications.autoconfigured-spring-data-jdbc">26.3.18. Auto-configured Data JDBC Tests</a></li>
<li><a href="#features.testing.spring-boot-applications.autoconfigured-jooq">26.3.19. Auto-configured jOOQ Tests</a></li>
<li><a href="#features.testing.spring-boot-applications.autoconfigured-spring-data-mongodb">26.3.20. Auto-configured Data MongoDB Tests</a></li>
<li><a href="#features.testing.spring-boot-applications.autoconfigured-spring-data-neo4j">26.3.21. Auto-configured Data Neo4j Tests</a></li>
<li><a href="#features.testing.spring-boot-applications.autoconfigured-spring-data-redis">26.3.22. Auto-configured Data Redis Tests</a></li>
<li><a href="#features.testing.spring-boot-applications.autoconfigured-spring-data-ldap">26.3.23. Auto-configured Data LDAP Tests</a></li>
<li><a href="#features.testing.spring-boot-applications.autoconfigured-rest-client">26.3.24. Auto-configured REST Clients</a></li>
<li><a href="#features.testing.spring-boot-applications.autoconfigured-spring-restdocs">26.3.25. Auto-configured Spring REST Docs Tests</a>
<ul class="sectlevel4">
<li><a href="#features.testing.spring-boot-applications.autoconfigured-spring-restdocs.with-mock-mvc">Auto-configured Spring REST Docs Tests with Mock MVC</a></li>
<li><a href="#features.testing.spring-boot-applications.autoconfigured-spring-restdocs.with-web-test-client">Auto-configured Spring REST Docs Tests with WebTestClient</a></li>
<li><a href="#features.testing.spring-boot-applications.autoconfigured-spring-restdocs.with-rest-assured">Auto-configured Spring REST Docs Tests with REST Assured</a></li>
</ul>
</li>
<li><a href="#features.testing.spring-boot-applications.autoconfigured-webservices">26.3.26. Auto-configured Spring Web Services Tests</a></li>
<li><a href="#features.testing.spring-boot-applications.additional-autoconfiguration-and-slicing">26.3.27. Additional Auto-configuration and Slicing</a></li>
<li><a href="#features.testing.spring-boot-applications.user-configuration-and-slicing">26.3.28. User Configuration and Slicing</a></li>
<li><a href="#features.testing.spring-boot-applications.spock">26.3.29. Using Spock to Test Spring Boot Applications</a></li>
</ul>
</li>
<li><a href="#features.testing.utilities">26.4. Test Utilities</a>
<ul class="sectlevel3">
<li><a href="#features.testing.utilities.config-data-application-context-initializer">26.4.1. ConfigDataApplicationContextInitializer</a></li>
<li><a href="#features.testing.utilities.test-property-values">26.4.2. TestPropertyValues</a></li>
<li><a href="#features.testing.utilities.output-capture">26.4.3. OutputCapture</a></li>
<li><a href="#features.testing.utilities.test-rest-template">26.4.4. TestRestTemplate</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#features.websockets">27. WebSockets</a></li>
<li><a href="#features.webservices">28. Web Services</a>
<ul class="sectlevel2">
<li><a href="#features.webservices.template">28.1. Calling Web Services with WebServiceTemplate</a></li>
</ul>
</li>
<li><a href="#features.developing-auto-configuration">29. Creating Your Own Auto-configuration</a>
<ul class="sectlevel2">
<li><a href="#features.developing-auto-configuration.understanding-auto-configured-beans">29.1. Understanding Auto-configured Beans</a></li>
<li><a href="#features.developing-auto-configuration.locating-auto-configuration-candidates">29.2. Locating Auto-configuration Candidates</a></li>
<li><a href="#features.developing-auto-configuration.condition-annotations">29.3. Condition Annotations</a>
<ul class="sectlevel3">
<li><a href="#features.developing-auto-configuration.condition-annotations.class-conditions">29.3.1. Class Conditions</a></li>
<li><a href="#features.developing-auto-configuration.condition-annotations.bean-conditions">29.3.2. Bean Conditions</a></li>
<li><a href="#features.developing-auto-configuration.condition-annotations.property-conditions">29.3.3. Property Conditions</a></li>
<li><a href="#features.developing-auto-configuration.condition-annotations.resource-conditions">29.3.4. Resource Conditions</a></li>
<li><a href="#features.developing-auto-configuration.condition-annotations.web-application-conditions">29.3.5. Web Application Conditions</a></li>
<li><a href="#features.developing-auto-configuration.condition-annotations.spel-conditions">29.3.6. SpEL Expression Conditions</a></li>
</ul>
</li>
<li><a href="#features.developing-auto-configuration.testing">29.4. Testing your Auto-configuration</a>
<ul class="sectlevel3">
<li><a href="#features.developing-auto-configuration.testing.simulating-a-web-context">29.4.1. Simulating a Web Context</a></li>
<li><a href="#features.developing-auto-configuration.testing.overriding-classpath">29.4.2. Overriding the Classpath</a></li>
</ul>
</li>
<li><a href="#features.developing-auto-configuration.custom-starter">29.5. Creating Your Own Starter</a>
<ul class="sectlevel3">
<li><a href="#features.developing-auto-configuration.custom-starter.naming">29.5.1. Naming</a></li>
<li><a href="#features.developing-auto-configuration.custom-starter.configuration-keys">29.5.2. Configuration keys</a></li>
<li><a href="#features.developing-auto-configuration.custom-starter.autoconfigure-module">29.5.3. The &#8220;autoconfigure&#8221; Module</a></li>
<li><a href="#features.developing-auto-configuration.custom-starter.starter-module">29.5.4. Starter Module</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#features.kotlin">30. Kotlin support</a>
<ul class="sectlevel2">
<li><a href="#features.kotlin.requirements">30.1. Requirements</a></li>
<li><a href="#features.kotlin.null-safety">30.2. Null-safety</a></li>
<li><a href="#features.kotlin.api">30.3. Kotlin API</a>
<ul class="sectlevel3">
<li><a href="#features.kotlin.api.run-application">30.3.1. runApplication</a></li>
<li><a href="#features.kotlin.api.extensions">30.3.2. Extensions</a></li>
</ul>
</li>
<li><a href="#features.kotlin.dependency-management">30.4. Dependency management</a></li>
<li><a href="#features.kotlin.configuration-properties">30.5. @ConfigurationProperties</a></li>
<li><a href="#features.kotlin.testing">30.6. Testing</a></li>
<li><a href="#features.kotlin.resources">30.7. Resources</a>
<ul class="sectlevel3">
<li><a href="#features.kotlin.resources.further-reading">30.7.1. Further reading</a></li>
<li><a href="#features.kotlin.resources.examples">30.7.2. Examples</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#features.container-images">31. Container Images</a>
<ul class="sectlevel2">
<li><a href="#features.container-images.layering">31.1. Layering Docker Images</a></li>
<li><a href="#features.container-images.building">31.2. Building Container Images</a>
<ul class="sectlevel3">
<li><a href="#features.container-images.building.dockerfiles">31.2.1. Dockerfiles</a></li>
<li><a href="#features.container-images.building.buildpacks">31.2.2. Cloud Native Buildpacks</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#features.whats-next">32. What to Read Next</a></li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This section dives into the details of Spring Boot.
Here you can learn about the key features that you may want to use and customize.
If you have not already done so, you might want to read the "<a href="getting-started.html#getting-started">getting-started.html</a>" and "<a href="using.html#using">using.html</a>" sections, so that you have a good grounding of the basics.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.spring-application"><a class="anchor" href="#features.spring-application"></a>1. SpringApplication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>SpringApplication</code> class provides a convenient way to bootstrap a Spring application that is started from a <code>main()</code> method.
In many situations, you can delegate to the static <code>SpringApplication.run</code> method, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

</span><span class="fold-block">@SpringBootApplication
public class MyApplication {

    public static void main(String[] args) {
        SpringApplication.run(MyApplication.class, args);
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When your application starts, you should see something similar to the following output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::   v2.5.3

2021-02-03 10:33:25.224  INFO 17321 --- [           main] o.s.b.d.s.s.SpringAppplicationExample    : Starting SpringAppplicationExample using Java 1.8.0_232 on mycomputer with PID 17321 (/apps/myjar.jar started by pwebb)
2021-02-03 10:33:25.226  INFO 17900 --- [           main] o.s.b.d.s.s.SpringAppplicationExample    : No active profile set, falling back to default profiles: default
2021-02-03 10:33:26.046  INFO 17321 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 8080 (http)
2021-02-03 10:33:26.054  INFO 17900 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2021-02-03 10:33:26.055  INFO 17900 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.41]
2021-02-03 10:33:26.097  INFO 17900 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2021-02-03 10:33:26.097  INFO 17900 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 821 ms
2021-02-03 10:33:26.144  INFO 17900 --- [           main] s.tomcat.SampleTomcatApplication         : ServletContext initialized
2021-02-03 10:33:26.376  INFO 17900 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8080 (http) with context path ''
2021-02-03 10:33:26.384  INFO 17900 --- [           main] o.s.b.d.s.s.SpringAppplicationExample    : Started SampleTomcatApplication in 1.514 seconds (JVM running for 1.823)</pre>
</div>
</div>
<div class="paragraph">
<p>By default, <code>INFO</code> logging messages are shown, including some relevant startup details, such as the user that launched the application.
If you need a log level other than <code>INFO</code>, you can set it, as described in <a href="#features.logging.log-levels">Log Levels</a>.
The application version is determined using the implementation version from the main application class&#8217;s package.
Startup information logging can be turned off by setting <code>spring.main.log-startup-info</code> to <code>false</code>.
This will also turn off logging of the application&#8217;s active profiles.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
To add additional logging during startup, you can override <code>logStartupInfo(boolean)</code> in a subclass of <code>SpringApplication</code>.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="features.spring-application.startup-failure"><a class="anchor" href="#features.spring-application.startup-failure"></a>1.1. Startup Failure</h3>
<div class="paragraph">
<p>If your application fails to start, registered <code>FailureAnalyzers</code> get a chance to provide a dedicated error message and a concrete action to fix the problem.
For instance, if you start a web application on port <code>8080</code> and that port is already in use, you should see something similar to the following message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>***************************
APPLICATION FAILED TO START
***************************

Description:

Embedded servlet container failed to start. Port 8080 was already in use.

Action:

Identify and stop the process that's listening on port 8080 or configure this application to listen on another port.</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Spring Boot provides numerous <code>FailureAnalyzer</code> implementations, and you can <a href="howto.html#howto.application.failure-analyzer">add your own</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If no failure analyzers are able to handle the exception, you can still display the full conditions report to better understand what went wrong.
To do so, you need to <a href="#features.external-config">enable the <code>debug</code> property</a> or <a href="#features.logging.log-levels">enable <code>DEBUG</code> logging</a> for <code>org.springframework.boot.autoconfigure.logging.ConditionEvaluationReportLoggingListener</code>.</p>
</div>
<div class="paragraph">
<p>For instance, if you are running your application by using <code>java -jar</code>, you can enable the <code>debug</code> property as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ java -jar myproject-0.0.1-SNAPSHOT.jar --debug</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.spring-application.lazy-initialization"><a class="anchor" href="#features.spring-application.lazy-initialization"></a>1.2. Lazy Initialization</h3>
<div class="paragraph">
<p><code>SpringApplication</code> allows an application to be initialized lazily.
When lazy initialization is enabled, beans are created as they are needed rather than during application startup.
As a result, enabling lazy initialization can reduce the time that it takes your application to start.
In a web application, enabling lazy initialization will result in many web-related beans not being initialized until an HTTP request is received.</p>
</div>
<div class="paragraph">
<p>A downside of lazy initialization is that it can delay the discovery of a problem with the application.
If a misconfigured bean is initialized lazily, a failure will no longer occur during startup and the problem will only become apparent when the bean is initialized.
Care must also be taken to ensure that the JVM has sufficient memory to accommodate all of the application&#8217;s beans and not just those that are initialized during startup.
For these reasons, lazy initialization is not enabled by default and it is recommended that fine-tuning of the JVM&#8217;s heap size is done before enabling lazy initialization.</p>
</div>
<div class="paragraph">
<p>Lazy initialization can be enabled programmatically using the <code>lazyInitialization</code> method on <code>SpringApplicationBuilder</code> or the <code>setLazyInitialization</code> method on <code>SpringApplication</code>.
Alternatively, it can be enabled using the <code>spring.main.lazy-initialization</code> property as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.main.lazy-initialization=true</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  main:
    lazy-initialization: true</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you want to disable lazy initialization for certain beans while using lazy initialization for the rest of the application, you can explicitly set their lazy attribute to false using the <code>@Lazy(false)</code> annotation.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features.spring-application.banner"><a class="anchor" href="#features.spring-application.banner"></a>1.3. Customizing the Banner</h3>
<div class="paragraph">
<p>The banner that is printed on start up can be changed by adding a <code>banner.txt</code> file to your classpath or by setting the <code>spring.banner.location</code> property to the location of such a file.
If the file has an encoding other than UTF-8, you can set <code>spring.banner.charset</code>.
In addition to a text file, you can also add a <code>banner.gif</code>, <code>banner.jpg</code>, or <code>banner.png</code> image file to your classpath or set the <code>spring.banner.image.location</code> property.
Images are converted into an ASCII art representation and printed above any text banner.</p>
</div>
<div class="paragraph">
<p>Inside your <code>banner.txt</code> file, you can use any of the following placeholders:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Banner variables</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variable</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${application.version}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The version number of your application, as declared in <code>MANIFEST.MF</code>.
For example, <code>Implementation-Version: 1.0</code> is printed as <code>1.0</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${application.formatted-version}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The version number of your application, as declared in <code>MANIFEST.MF</code> and formatted for display (surrounded with brackets and prefixed with <code>v</code>).
For example <code>(v1.0)</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${spring-boot.version}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Spring Boot version that you are using.
For example <code>2.5.3</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${spring-boot.formatted-version}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Spring Boot version that you are using, formatted for display (surrounded with brackets and prefixed with <code>v</code>).
For example <code>(v2.5.3)</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${Ansi.NAME}</code> (or <code>${AnsiColor.NAME}</code>, <code>${AnsiBackground.NAME}</code>, <code>${AnsiStyle.NAME}</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Where <code>NAME</code> is the name of an ANSI escape code.
See <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/ansi/AnsiPropertySource.java"><code>AnsiPropertySource</code></a> for details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>${application.title}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The title of your application, as declared in <code>MANIFEST.MF</code>.
For example <code>Implementation-Title: MyApp</code> is printed as <code>MyApp</code>.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The <code>SpringApplication.setBanner(&#8230;&#8203;)</code> method can be used if you want to generate a banner programmatically.
Use the <code>org.springframework.boot.Banner</code> interface and implement your own <code>printBanner()</code> method.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also use the <code>spring.main.banner-mode</code> property to determine if the banner has to be printed on <code>System.out</code> (<code>console</code>), sent to the configured logger (<code>log</code>), or not produced at all (<code>off</code>).</p>
</div>
<div class="paragraph">
<p>The printed banner is registered as a singleton bean under the following name: <code>springBootBanner</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>${application.version}</code> and <code>${application.formatted-version}</code> properties are only available if you are using Spring Boot launchers.
The values won&#8217;t be resolved if you are running an unpacked jar and starting it with <code>java -cp &lt;classpath&gt; &lt;mainclass&gt;</code>.</p>
</div>
<div class="paragraph">
<p>This is why we recommend that you always launch unpacked jars using <code>java org.springframework.boot.loader.JarLauncher</code>.
This will initialize the <code>application.*</code> banner variables before building the classpath and launching your app.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features.spring-application.customizing-spring-application"><a class="anchor" href="#features.spring-application.customizing-spring-application"></a>1.4. Customizing SpringApplication</h3>
<div class="paragraph">
<p>If the <code>SpringApplication</code> defaults are not to your taste, you can instead create a local instance and customize it.
For example, to turn off the banner, you could write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.Banner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

</span><span class="fold-block">@SpringBootApplication
public class MyApplication {

    public static void main(String[] args) {
        SpringApplication application = new SpringApplication(MyApplication.class);
        application.setBannerMode(Banner.Mode.OFF);
        application.run(args);
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The constructor arguments passed to <code>SpringApplication</code> are configuration sources for Spring beans.
In most cases, these are references to <code>@Configuration</code> classes, but they could also be direct references <code>@Component</code> classes.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is also possible to configure the <code>SpringApplication</code> by using an <code>application.properties</code> file.
See <em><a href="#features.external-config">Externalized Configuration</a></em> for details.</p>
</div>
<div class="paragraph">
<p>For a complete list of the configuration options, see the <a href="https://docs.spring.io/spring-boot/docs/2.5.3/api/org/springframework/boot/SpringApplication.html"><code>SpringApplication</code> Javadoc</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.spring-application.fluent-builder-api"><a class="anchor" href="#features.spring-application.fluent-builder-api"></a>1.5. Fluent Builder API</h3>
<div class="paragraph">
<p>If you need to build an <code>ApplicationContext</code> hierarchy (multiple contexts with a parent/child relationship) or if you prefer using a &#8220;fluent&#8221; builder API, you can use the <code>SpringApplicationBuilder</code>.</p>
</div>
<div class="paragraph">
<p>The <code>SpringApplicationBuilder</code> lets you chain together multiple method calls and includes <code>parent</code> and <code>child</code> methods that let you create a hierarchy, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">new SpringApplicationBuilder()
        .sources(Parent.class)
        .child(Application.class)
        .bannerMode(Banner.Mode.OFF)
        .run(args);
</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
There are some restrictions when creating an <code>ApplicationContext</code> hierarchy.
For example, Web components <strong>must</strong> be contained within the child context, and the same <code>Environment</code> is used for both parent and child contexts.
See the <a href="https://docs.spring.io/spring-boot/docs/2.5.3/api/org/springframework/boot/builder/SpringApplicationBuilder.html"><code>SpringApplicationBuilder</code> Javadoc</a> for full details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features.spring-application.application-availability"><a class="anchor" href="#features.spring-application.application-availability"></a>1.6. Application Availability</h3>
<div class="paragraph">
<p>When deployed on platforms, applications can provide information about their availability to the platform using infrastructure such as <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/">Kubernetes Probes</a>.
Spring Boot includes out-of-the box support for the commonly used &#8220;liveness&#8221; and &#8220;readiness&#8221; availability states.
If you are using Spring Boot&#8217;s &#8220;actuator&#8221; support then these states are exposed as health endpoint groups.</p>
</div>
<div class="paragraph">
<p>In addition, you can also obtain availability states by injecting the <code>ApplicationAvailability</code> interface into your own beans.</p>
</div>
<div class="sect3">
<h4 id="features.spring-application.application-availability.liveness"><a class="anchor" href="#features.spring-application.application-availability.liveness"></a>1.6.1. Liveness State</h4>
<div class="paragraph">
<p>The &#8220;Liveness&#8221; state of an application tells whether its internal state allows it to work correctly, or recover by itself if it&#8217;s currently failing.
A broken &#8220;Liveness&#8221; state means that the application is in a state that it cannot recover from, and the infrastructure should restart the application.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In general, the "Liveness" state should not be based on external checks, such as <a href="actuator.html#actuator.endpoints.health">Health checks</a>.
If it did, a failing external system (a database, a Web API, an external cache) would trigger massive restarts and cascading failures across the platform.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The internal state of Spring Boot applications is mostly represented by the Spring <code>ApplicationContext</code>.
If the application context has started successfully, Spring Boot assumes that the application is in a valid state.
An application is considered live as soon as the context has been refreshed, see <a href="#features.spring-application.application-events-and-listeners">Spring Boot application lifecycle and related Application Events</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.spring-application.application-availability.readiness"><a class="anchor" href="#features.spring-application.application-availability.readiness"></a>1.6.2. Readiness State</h4>
<div class="paragraph">
<p>The &#8220;Readiness&#8221; state of an application tells whether the application is ready to handle traffic.
A failing &#8220;Readiness&#8221; state tells the platform that it should not route traffic to the application for now.
This typically happens during startup, while <code>CommandLineRunner</code> and <code>ApplicationRunner</code> components are being processed, or at any time if the application decides that it&#8217;s too busy for additional traffic.</p>
</div>
<div class="paragraph">
<p>An application is considered ready as soon as application and command-line runners have been called, see <a href="#features.spring-application.application-events-and-listeners">Spring Boot application lifecycle and related Application Events</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Tasks expected to run during startup should be executed by <code>CommandLineRunner</code> and <code>ApplicationRunner</code> components instead of using Spring component lifecycle callbacks such as <code>@PostConstruct</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.spring-application.application-availability.managing"><a class="anchor" href="#features.spring-application.application-availability.managing"></a>1.6.3. Managing the Application Availability State</h4>
<div class="paragraph">
<p>Application components can retrieve the current availability state at any time, by injecting the <code>ApplicationAvailability</code> interface and calling methods on it.
More often, applications will want to listen to state updates or update the state of the application.</p>
</div>
<div class="paragraph">
<p>For example, we can export the "Readiness" state of the application to a file so that a Kubernetes "exec Probe" can look at this file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.availability.AvailabilityChangeEvent;
import org.springframework.boot.availability.ReadinessState;
import org.springframework.context.event.EventListener;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyReadinessStateExporter {

    @EventListener
    public void onStateChange(AvailabilityChangeEvent&lt;ReadinessState&gt; event) {
        switch (event.getState()) {
        case ACCEPTING_TRAFFIC:
            // create file /tmp/healthy
            break;
        case REFUSING_TRAFFIC:
            // remove file /tmp/healthy
            break;
        }
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We can also update the state of the application, when the application breaks and cannot recover:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.availability.AvailabilityChangeEvent;
import org.springframework.boot.availability.LivenessState;
import org.springframework.context.ApplicationEventPublisher;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyLocalCacheVerifier {

    private final ApplicationEventPublisher eventPublisher;

    public MyLocalCacheVerifier(ApplicationEventPublisher eventPublisher) {
        this.eventPublisher = eventPublisher;
    }

    public void checkLocalCache() {
        try {
            // ...
        }
        catch (CacheCompletelyBrokenException ex) {
            AvailabilityChangeEvent.publish(this.eventPublisher, ex, LivenessState.BROKEN);
        }
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Spring Boot provides <a href="actuator.html#actuator.endpoints.kubernetes-probes">Kubernetes HTTP probes for "Liveness" and "Readiness" with Actuator Health Endpoints</a>.
You can get more guidance about <a href="deployment.html#deployment.cloud.kubernetes">deploying Spring Boot applications on Kubernetes in the dedicated section</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.spring-application.application-events-and-listeners"><a class="anchor" href="#features.spring-application.application-events-and-listeners"></a>1.7. Application Events and Listeners</h3>
<div class="paragraph">
<p>In addition to the usual Spring Framework events, such as <a href="https://docs.spring.io/spring-framework/docs/5.3.9/javadoc-api/org/springframework/context/event/ContextRefreshedEvent.html"><code>ContextRefreshedEvent</code></a>, a <code>SpringApplication</code> sends some additional application events.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Some events are actually triggered before the <code>ApplicationContext</code> is created, so you cannot register a listener on those as a <code>@Bean</code>.
You can register them with the <code>SpringApplication.addListeners(&#8230;&#8203;)</code> method or the <code>SpringApplicationBuilder.listeners(&#8230;&#8203;)</code> method.</p>
</div>
<div class="paragraph">
<p>If you want those listeners to be registered automatically, regardless of the way the application is created, you can add a <code>META-INF/spring.factories</code> file to your project and reference your listener(s) by using the <code>org.springframework.context.ApplicationListener</code> key, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>org.springframework.context.ApplicationListener=com.example.project.MyListener</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Application events are sent in the following order, as your application runs:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>An <code>ApplicationStartingEvent</code> is sent at the start of a run but before any processing, except for the registration of listeners and initializers.</p>
</li>
<li>
<p>An <code>ApplicationEnvironmentPreparedEvent</code> is sent when the <code>Environment</code> to be used in the context is known but before the context is created.</p>
</li>
<li>
<p>An <code>ApplicationContextInitializedEvent</code> is sent when the <code>ApplicationContext</code> is prepared and ApplicationContextInitializers have been called but before any bean definitions are loaded.</p>
</li>
<li>
<p>An <code>ApplicationPreparedEvent</code> is sent just before the refresh is started but after bean definitions have been loaded.</p>
</li>
<li>
<p>An <code>ApplicationStartedEvent</code> is sent after the context has been refreshed but before any application and command-line runners have been called.</p>
</li>
<li>
<p>An <code>AvailabilityChangeEvent</code> is sent right after with <code>LivenessState.CORRECT</code> to indicate that the application is considered as live.</p>
</li>
<li>
<p>An <code>ApplicationReadyEvent</code> is sent after any <a href="#features.spring-application.command-line-runner">application and command-line runners</a> have been called.</p>
</li>
<li>
<p>An <code>AvailabilityChangeEvent</code> is sent right after with <code>ReadinessState.ACCEPTING_TRAFFIC</code> to indicate that the application is ready to service requests.</p>
</li>
<li>
<p>An <code>ApplicationFailedEvent</code> is sent if there is an exception on startup.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The above list only includes <code>SpringApplicationEvent</code>s that are tied to a <code>SpringApplication</code>.
In addition to these, the following events are also published after <code>ApplicationPreparedEvent</code> and before <code>ApplicationStartedEvent</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>WebServerInitializedEvent</code> is sent after the <code>WebServer</code> is ready.
<code>ServletWebServerInitializedEvent</code> and <code>ReactiveWebServerInitializedEvent</code> are the servlet and reactive variants respectively.</p>
</li>
<li>
<p>A <code>ContextRefreshedEvent</code> is sent when an <code>ApplicationContext</code> is refreshed.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You often need not use application events, but it can be handy to know that they exist.
Internally, Spring Boot uses events to handle a variety of tasks.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Event listeners should not run potentially lengthy tasks as they execute in the same thread by default.
Consider using <a href="#features.spring-application.command-line-runner">application and command-line runners</a> instead.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Application events are sent by using Spring Framework&#8217;s event publishing mechanism.
Part of this mechanism ensures that an event published to the listeners in a child context is also published to the listeners in any ancestor contexts.
As a result of this, if your application uses a hierarchy of <code>SpringApplication</code> instances, a listener may receive multiple instances of the same type of application event.</p>
</div>
<div class="paragraph">
<p>To allow your listener to distinguish between an event for its context and an event for a descendant context, it should request that its application context is injected and then compare the injected context with the context of the event.
The context can be injected by implementing <code>ApplicationContextAware</code> or, if the listener is a bean, by using <code>@Autowired</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.spring-application.web-environment"><a class="anchor" href="#features.spring-application.web-environment"></a>1.8. Web Environment</h3>
<div class="paragraph">
<p>A <code>SpringApplication</code> attempts to create the right type of <code>ApplicationContext</code> on your behalf.
The algorithm used to determine a <code>WebApplicationType</code> is the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If Spring MVC is present, an <code>AnnotationConfigServletWebServerApplicationContext</code> is used</p>
</li>
<li>
<p>If Spring MVC is not present and Spring WebFlux is present, an <code>AnnotationConfigReactiveWebServerApplicationContext</code> is used</p>
</li>
<li>
<p>Otherwise, <code>AnnotationConfigApplicationContext</code> is used</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This means that if you are using Spring MVC and the new <code>WebClient</code> from Spring WebFlux in the same application, Spring MVC will be used by default.
You can override that easily by calling <code>setWebApplicationType(WebApplicationType)</code>.</p>
</div>
<div class="paragraph">
<p>It is also possible to take complete control of the <code>ApplicationContext</code> type that is used by calling <code>setApplicationContextClass(&#8230;&#8203;)</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
It is often desirable to call <code>setWebApplicationType(WebApplicationType.NONE)</code> when using <code>SpringApplication</code> within a JUnit test.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features.spring-application.application-arguments"><a class="anchor" href="#features.spring-application.application-arguments"></a>1.9. Accessing Application Arguments</h3>
<div class="paragraph">
<p>If you need to access the application arguments that were passed to <code>SpringApplication.run(&#8230;&#8203;)</code>, you can inject a <code>org.springframework.boot.ApplicationArguments</code> bean.
The <code>ApplicationArguments</code> interface provides access to both the raw <code>String[]</code> arguments as well as parsed <code>option</code> and <code>non-option</code> arguments, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.util.List;

import org.springframework.boot.ApplicationArguments;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    public MyBean(ApplicationArguments args) {
        boolean debug = args.containsOption("debug");
        List&lt;String&gt; files = args.getNonOptionArgs();
        if (debug) {
            System.out.println(files);
        }
        // if run with "--debug logfile.txt" prints ["logfile.txt"]
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Spring Boot also registers a <code>CommandLinePropertySource</code> with the Spring <code>Environment</code>.
This lets you also inject single application arguments by using the <code>@Value</code> annotation.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features.spring-application.command-line-runner"><a class="anchor" href="#features.spring-application.command-line-runner"></a>1.10. Using the ApplicationRunner or CommandLineRunner</h3>
<div class="paragraph">
<p>If you need to run some specific code once the <code>SpringApplication</code> has started, you can implement the <code>ApplicationRunner</code> or <code>CommandLineRunner</code> interfaces.
Both interfaces work in the same way and offer a single <code>run</code> method, which is called just before <code>SpringApplication.run(&#8230;&#8203;)</code> completes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This contract is well suited for tasks that should run after application startup but before it starts accepting traffic.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>CommandLineRunner</code> interfaces provides access to application arguments as a string array, whereas the <code>ApplicationRunner</code> uses the <code>ApplicationArguments</code> interface discussed earlier.
The following example shows a <code>CommandLineRunner</code> with a <code>run</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.CommandLineRunner;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyCommandLineRunner implements CommandLineRunner {

    @Override
    public void run(String... args) {
        // Do something...
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If several <code>CommandLineRunner</code> or <code>ApplicationRunner</code> beans are defined that must be called in a specific order, you can additionally implement the <code>org.springframework.core.Ordered</code> interface or use the <code>org.springframework.core.annotation.Order</code> annotation.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.spring-application.application-exit"><a class="anchor" href="#features.spring-application.application-exit"></a>1.11. Application Exit</h3>
<div class="paragraph">
<p>Each <code>SpringApplication</code> registers a shutdown hook with the JVM to ensure that the <code>ApplicationContext</code> closes gracefully on exit.
All the standard Spring lifecycle callbacks (such as the <code>DisposableBean</code> interface or the <code>@PreDestroy</code> annotation) can be used.</p>
</div>
<div class="paragraph">
<p>In addition, beans may implement the <code>org.springframework.boot.ExitCodeGenerator</code> interface if they wish to return a specific exit code when <code>SpringApplication.exit()</code> is called.
This exit code can then be passed to <code>System.exit()</code> to return it as a status code, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.ExitCodeGenerator;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.annotation.Bean;

</span><span class="fold-block">@SpringBootApplication
public class MyApplication {

    @Bean
    public ExitCodeGenerator exitCodeGenerator() {
        return () -&gt; 42;
    }

    public static void main(String[] args) {
        System.exit(SpringApplication.exit(SpringApplication.run(MyApplication.class, args)));
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Also, the <code>ExitCodeGenerator</code> interface may be implemented by exceptions.
When such an exception is encountered, Spring Boot returns the exit code provided by the implemented <code>getExitCode()</code> method.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.spring-application.admin"><a class="anchor" href="#features.spring-application.admin"></a>1.12. Admin Features</h3>
<div class="paragraph">
<p>It is possible to enable admin-related features for the application by specifying the <code>spring.application.admin.enabled</code> property.
This exposes the <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/admin/SpringApplicationAdminMXBean.java"><code>SpringApplicationAdminMXBean</code></a> on the platform <code>MBeanServer</code>.
You could use this feature to administer your Spring Boot application remotely.
This feature could also be useful for any service wrapper implementation.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you want to know on which HTTP port the application is running, get the property with a key of <code>local.server.port</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features.spring-application.startup-tracking"><a class="anchor" href="#features.spring-application.startup-tracking"></a>1.13. Application Startup tracking</h3>
<div class="paragraph">
<p>During the application startup, the <code>SpringApplication</code> and the <code>ApplicationContext</code> perform many tasks related to the application lifecycle,
the beans lifecycle or even processing application events.
With <a href="https://docs.spring.io/spring-framework/docs/5.3.9/javadoc-api/org/springframework/core/metrics/ApplicationStartup.html"><code>ApplicationStartup</code></a>, Spring Framework <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/core.html#context-functionality-startup">allows you to track the application startup sequence with <code>StartupStep</code> objects</a>.
This data can be collected for profiling purposes, or just to have a better understanding of an application startup process.</p>
</div>
<div class="paragraph">
<p>You can choose an <code>ApplicationStartup</code> implementation when setting up the <code>SpringApplication</code> instance.
For example, to use the <code>BufferingApplicationStartup</code>, you could write:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.context.metrics.buffering.BufferingApplicationStartup;

</span><span class="fold-block">@SpringBootApplication
public class MyApplication {

    public static void main(String[] args) {
        SpringApplication application = new SpringApplication(MyApplication.class);
        application.setApplicationStartup(new BufferingApplicationStartup(2048));
        application.run(args);
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The first available implementation, <code>FlightRecorderApplicationStartup</code> is provided by Spring Framework.
It adds Spring-specific startup events to a Java Flight Recorder session and is meant for profiling applications and correlating their Spring context lifecycle with JVM events (such as allocations, GCs, class loading&#8230;&#8203;).
Once configured, you can record data by running the application with the Flight Recorder enabled:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ java -XX:StartFlightRecording:filename=recording.jfr,duration=10s -jar demo.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>Spring Boot ships with the <code>BufferingApplicationStartup</code> variant; this implementation is meant for buffering the startup steps and draining them into an external metrics system.
Applications can ask for the bean of type <code>BufferingApplicationStartup</code> in any component.</p>
</div>
<div class="paragraph">
<p>Spring Boot can also be configured to expose a <a href="https://docs.spring.io/spring-boot/docs/2.5.3/actuator-api/htmlsingle/#startup"><code>startup</code> endpoint</a> that provides this information as a JSON document.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.external-config"><a class="anchor" href="#features.external-config"></a>2. Externalized Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot lets you externalize your configuration so that you can work with the same application code in different environments.
You can use a variety of external configuration sources, include Java properties files, YAML files, environment variables, and command-line arguments.</p>
</div>
<div class="paragraph">
<p>Property values can be injected directly into your beans by using the <code>@Value</code> annotation, accessed through Spring&#8217;s <code>Environment</code> abstraction, or be <a href="#features.external-config.typesafe-configuration-properties">bound to structured objects</a> through <code>@ConfigurationProperties</code>.</p>
</div>
<div class="paragraph">
<p>Spring Boot uses a very particular <code>PropertySource</code> order that is designed to allow sensible overriding of values.
Properties are considered in the following order (with values from lower items overriding earlier ones):</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Default properties (specified by setting <code>SpringApplication.setDefaultProperties</code>).</p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-framework/docs/5.3.9/javadoc-api/org/springframework/context/annotation/PropertySource.html"><code>@PropertySource</code></a> annotations on your <code>@Configuration</code> classes.
Please note that such property sources are not added to the <code>Environment</code> until the application context is being refreshed.
This is too late to configure certain properties such as <code>logging.*</code> and <code>spring.main.*</code> which are read before refresh begins.</p>
</li>
<li>
<p>Config data (such as <code>application.properties</code> files)</p>
</li>
<li>
<p>A <code>RandomValuePropertySource</code> that has properties only in <code>random.*</code>.</p>
</li>
<li>
<p>OS environment variables.</p>
</li>
<li>
<p>Java System properties (<code>System.getProperties()</code>).</p>
</li>
<li>
<p>JNDI attributes from <code>java:comp/env</code>.</p>
</li>
<li>
<p><code>ServletContext</code> init parameters.</p>
</li>
<li>
<p><code>ServletConfig</code> init parameters.</p>
</li>
<li>
<p>Properties from <code>SPRING_APPLICATION_JSON</code> (inline JSON embedded in an environment variable or system property).</p>
</li>
<li>
<p>Command line arguments.</p>
</li>
<li>
<p><code>properties</code> attribute on your tests.
Available on <a href="https://docs.spring.io/spring-boot/docs/2.5.3/api/org/springframework/boot/test/context/SpringBootTest.html"><code>@SpringBootTest</code></a> and the <a href="#features.testing.spring-boot-applications.autoconfigured-tests">test annotations for testing a particular slice of your application</a>.</p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-framework/docs/5.3.9/javadoc-api/org/springframework/test/context/TestPropertySource.html"><code>@TestPropertySource</code></a> annotations on your tests.</p>
</li>
<li>
<p><a href="using.html#using.devtools.globalsettings">Devtools global settings properties</a> in the <code>$HOME/.config/spring-boot</code> directory when devtools is active.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Config data files are considered in the following order:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#features.external-config.files">Application properties</a> packaged inside your jar (<code>application.properties</code> and YAML variants).</p>
</li>
<li>
<p><a href="#features.external-config.files.profile-specific">Profile-specific application properties</a> packaged inside your jar (<code>application-{profile}.properties</code> and YAML variants).</p>
</li>
<li>
<p><a href="#features.external-config.files">Application properties</a> outside of your packaged jar (<code>application.properties</code> and YAML variants).</p>
</li>
<li>
<p><a href="#features.external-config.files.profile-specific">Profile-specific application properties</a> outside of your packaged jar (<code>application-{profile}.properties</code> and YAML variants).</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
It is recommended to stick with one format for your entire application.
If you have configuration files with both <code>.properties</code> and <code>.yml</code> format in the same location, <code>.properties</code> takes precedence.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To provide a concrete example, suppose you develop a <code>@Component</code> that uses a <code>name</code> property, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.beans.factory.annotation.Value;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    @Value("${name}")
    private String name;

    // ...

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>On your application classpath (for example, inside your jar) you can have an <code>application.properties</code> file that provides a sensible default property value for <code>name</code>.
When running in a new environment, an <code>application.properties</code> file can be provided outside of your jar that overrides the <code>name</code>.
For one-off testing, you can launch with a specific command line switch (for example, <code>java -jar app.jar --name="Spring"</code>).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The <code>env</code> and <code>configprops</code> endpoints can be useful in determining why a property has a particular value.
You can use these two endpoints to diagnose unexpected property values.
See the "<a href="actuator.html#actuator.endpoints">Production ready features</a>" section for details.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="features.external-config.command-line-args"><a class="anchor" href="#features.external-config.command-line-args"></a>2.1. Accessing Command Line Properties</h3>
<div class="paragraph">
<p>By default, <code>SpringApplication</code> converts any command line option arguments (that is, arguments starting with <code>--</code>, such as <code>--server.port=9000</code>) to a <code>property</code> and adds them to the Spring <code>Environment</code>.
As mentioned previously, command line properties always take precedence over file based property sources.</p>
</div>
<div class="paragraph">
<p>If you do not want command line properties to be added to the <code>Environment</code>, you can disable them by using <code>SpringApplication.setAddCommandLineProperties(false)</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.external-config.application-json"><a class="anchor" href="#features.external-config.application-json"></a>2.2. JSON Application Properties</h3>
<div class="paragraph">
<p>Environment variables and system properties often have restrictions that mean some property names cannot be used.
To help with this, Spring Boot allows you to encode a block of properties into a single JSON structure.</p>
</div>
<div class="paragraph">
<p>When your application starts, any <code>spring.application.json</code> or <code>SPRING_APPLICATION_JSON</code> properties will be parsed and added to the <code>Environment</code>.</p>
</div>
<div class="paragraph">
<p>For example, the <code>SPRING_APPLICATION_JSON</code> property can be supplied on the command line in a UN*X shell as an environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ SPRING_APPLICATION_JSON='{"my":{"name":"test"}}' java -jar myapp.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the preceding example, you end up with <code>my.name=test</code> in the Spring <code>Environment</code>.</p>
</div>
<div class="paragraph">
<p>The same JSON can also be provided as a system property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ java -Dspring.application.json='{"my":{"name":"test"}}' -jar myapp.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or you could supply the JSON by using a command line argument:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ java -jar myapp.jar --spring.application.json='{"my":{"name":"test"}}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you are deploying to a classic Application Server, you could also use a JNDI variable named <code>java:comp/env/spring.application.json</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Although <code>null</code> values from the JSON will be added to the resulting property source, the <code>PropertySourcesPropertyResolver</code> treats <code>null</code> properties as missing values.
This means that the JSON cannot override properties from lower order property sources with a <code>null</code> value.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features.external-config.files"><a class="anchor" href="#features.external-config.files"></a>2.3. External Application Properties <a id="features.external-config.files"></a></h3>
<div class="paragraph">
<p>Spring Boot will automatically find and load <code>application.properties</code> and <code>application.yaml</code> files from the following locations when your application starts:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>From the classpath</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The classpath root</p>
</li>
<li>
<p>The classpath <code>/config</code> package</p>
</li>
</ol>
</div>
</li>
<li>
<p>From the current directory</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>The current directory</p>
</li>
<li>
<p>The <code>/config</code> subdirectory in the current directory</p>
</li>
<li>
<p>Immediate child directories of the <code>/config</code> subdirectory</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The list is ordered by precedence (with values from lower items overriding earlier ones).
Documents from the loaded files are added as <code>PropertySources</code> to the Spring <code>Environment</code>.</p>
</div>
<div class="paragraph">
<p>If you do not like <code>application</code> as the configuration file name, you can switch to another file name by specifying a <code>spring.config.name</code> environment property.
For example, to look for <code>myproject.properties</code> and <code>myproject.yaml</code> files you can run your application as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ java -jar myproject.jar --spring.config.name=myproject</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also refer to an explicit location by using the <code>spring.config.location</code> environment property.
This properties accepts a comma-separated list of one or more locations to check.</p>
</div>
<div class="paragraph">
<p>The following example shows how to specify two distinct files:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ java -jar myproject.jar --spring.config.location=\
    optional:classpath:/default.properties,\
    optional:classpath:/override.properties</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Use the prefix <code>optional:</code> if the <a href="#features.external-config.files.optional-prefix">locations are optional</a> and you don&#8217;t mind if they don&#8217;t exist.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<code>spring.config.name</code>, <code>spring.config.location</code>, and <code>spring.config.additional-location</code> are used very early to determine which files have to be loaded.
They must be defined as an environment property (typically an OS environment variable, a system property, or a command-line argument).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code>spring.config.location</code> contains directories (as opposed to files), they should end in <code>/</code>.
At runtime they will be appended with the names generated from <code>spring.config.name</code> before being loaded.
Files specified in <code>spring.config.location</code> are imported directly.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Both directory and file location values are also expanded to check for <a href="#features.external-config.files.profile-specific">profile-specific files</a>.
For example, if you have a <code>spring.config.location</code> of <code>classpath:myconfig.properties</code>, you will also find appropriate <code>classpath:myconfig-&lt;profile&gt;.properties</code> files are loaded.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In most situations, each <code>spring.config.location</code> item you add will reference a single file or directory.
Locations are processed in the order that they are defined and later ones can override the values of earlier ones.</p>
</div>
<div id="features.external-config.files.location-groups" class="paragraph">
<p>If you have a complex location setup, and you use profile-specific configuration files, you may need to provide further hints so that Spring Boot knows how they should be grouped.
A location group is a collection of locations that are all considered at the same level.
For example, you might want to group all classpath locations, then all external locations.
Items within a location group should be separated with <code>;</code>.
See the example in the &#8220;<a href="#features.external-config.files.profile-specific">Profile Specific Files</a>&#8221; section for more details.</p>
</div>
<div class="paragraph">
<p>Locations configured by using <code>spring.config.location</code> replace the default locations.
For example, if <code>spring.config.location</code> is configured with the value <code>optional:classpath:/custom-config/,optional:file:./custom-config/</code>, the complete set of locations considered is:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>optional:classpath:custom-config/</code></p>
</li>
<li>
<p><code>optional:file:./custom-config/</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you prefer to add additional locations, rather than replacing them, you can use <code>spring.config.additional-location</code>.
Properties loaded from additional locations can override those in the default locations.
For example, if <code>spring.config.additional-location</code> is configured with the value <code>optional:classpath:/custom-config/,optional:file:./custom-config/</code>, the complete set of locations considered is:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>optional:classpath:/;optional:classpath:/config/</code></p>
</li>
<li>
<p><code>optional:file:./;optional:file:./config/;optional:file:./config/*/</code></p>
</li>
<li>
<p><code>optional:classpath:custom-config/</code></p>
</li>
<li>
<p><code>optional:file:./custom-config/</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This search ordering lets you specify default values in one configuration file and then selectively override those values in another.
You can provide default values for your application in <code>application.properties</code> (or whatever other basename you choose with <code>spring.config.name</code>) in one of the default locations.
These default values can then be overridden at runtime with a different file located in one of the custom locations.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you use environment variables rather than system properties, most operating systems disallow period-separated key names, but you can use underscores instead (for example, <code>SPRING_CONFIG_NAME</code> instead of <code>spring.config.name</code>).
See <a href="#features.external-config.typesafe-configuration-properties.relaxed-binding.environment-variables">Binding from Environment Variables</a> for details.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If your application runs in a servlet container or application server, then JNDI properties (in <code>java:comp/env</code>) or servlet context initialization parameters can be used instead of, or as well as, environment variables or system properties.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="features.external-config.files.optional-prefix"><a class="anchor" href="#features.external-config.files.optional-prefix"></a>2.3.1. Optional Locations</h4>
<div class="paragraph">
<p>By default, when a specified config data location does not exist, Spring Boot will throw a <code>ConfigDataLocationNotFoundException</code> and your application will not start.</p>
</div>
<div class="paragraph">
<p>If you want to specify a location, but you don&#8217;t mind if it doesn&#8217;t always exist, you can use the <code>optional:</code> prefix.
You can use this prefix with the <code>spring.config.location</code> and <code>spring.config.additional-location</code> properties, as well as with <a href="#features.external-config.files.importing"><code>spring.config.import</code></a> declarations.</p>
</div>
<div class="paragraph">
<p>For example, a <code>spring.config.import</code> value of <code>optional:file:./myconfig.properties</code> allows your application to start, even if the <code>myconfig.properties</code> file is missing.</p>
</div>
<div class="paragraph">
<p>If you want to ignore all <code>ConfigDataLocationNotFoundExceptions</code> and always continue to start your application, you can use the <code>spring.config.on-not-found</code> property.
Set the value to <code>ignore</code> using <code>SpringApplication.setDefaultProperties(&#8230;&#8203;)</code> or with a system/environment variable.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.external-config.files.wildcard-locations"><a class="anchor" href="#features.external-config.files.wildcard-locations"></a>2.3.2. Wildcard Locations</h4>
<div class="paragraph">
<p>If a config file location includes the <code>*</code> character for the last path segment, it is considered a wildcard location.
Wildcards are expanded when the config is loaded so that immediate subdirectories are also checked.
Wildcard locations are particularly useful in an environment such as Kubernetes when there are multiple sources of config properties.</p>
</div>
<div class="paragraph">
<p>For example, if you have some Redis configuration and some MySQL configuration, you might want to keep those two pieces of configuration separate, while requiring that both those are present in an <code>application.properties</code> file.
This might result in two separate <code>application.properties</code> files mounted at different locations such as <code>/config/redis/application.properties</code> and <code>/config/mysql/application.properties</code>.
In such a case, having a wildcard location of <code>config/*/</code>, will result in both files being processed.</p>
</div>
<div class="paragraph">
<p>By default, Spring Boot includes <code>config/*/</code> in the default search locations.
It means that all subdirectories of the <code>/config</code> directory outside of your jar will be searched.</p>
</div>
<div class="paragraph">
<p>You can use wildcard locations yourself with the <code>spring.config.location</code> and <code>spring.config.additional-location</code> properties.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
A wildcard location must contain only one <code>*</code> and end with <code>*/</code> for search locations that are directories or <code>*/&lt;filename&gt;</code> for search locations that are files.
Locations with wildcards are sorted alphabetically based on the absolute path of the file names.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Wildcard locations only work with external directories.
You cannot use a wildcard in a <code>classpath:</code> location.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.external-config.files.profile-specific"><a class="anchor" href="#features.external-config.files.profile-specific"></a>2.3.3. Profile Specific Files</h4>
<div class="paragraph">
<p>As well as <code>application</code> property files, Spring Boot will also attempt to load profile-specific files using the naming convention <code>application-{profile}</code>.
For example, if your application activates a profile named <code>prod</code> and uses YAML files, then both <code>application.yml</code> and <code>application-prod.yml</code> will be considered.</p>
</div>
<div class="paragraph">
<p>Profile-specific properties are loaded from the same locations as standard <code>application.properties</code>, with profile-specific files always overriding the non-specific ones.
If several profiles are specified, a last-wins strategy applies.
For example, if profiles <code>prod,live</code> are specified by the <code>spring.profiles.active</code> property, values in <code>application-prod.properties</code> can be overridden by those in <code>application-live.properties</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The last-wins strategy applies at the <a href="#features.external-config.files.location-groups">location group</a> level.
A <code>spring.config.location</code> of <code>classpath:/cfg/,classpath:/ext/</code> will not have the same override rules as <code>classpath:/cfg/;classpath:/ext/</code>.</p>
</div>
<div class="paragraph">
<p>For example, continuing our <code>prod,live</code> example above, we might have the following files:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/cfg
  application-live.properties
/ext
  application-live.properties
  application-prod.properties</pre>
</div>
</div>
<div class="paragraph">
<p>When we have a <code>spring.config.location</code> of <code>classpath:/cfg/,classpath:/ext/</code> we process all <code>/cfg</code> files before all <code>/ext</code> files:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>/cfg/application-live.properties</code></p>
</li>
<li>
<p><code>/ext/application-prod.properties</code></p>
</li>
<li>
<p><code>/ext/application-live.properties</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When we have <code>classpath:/cfg/;classpath:/ext/</code> instead (with a <code>;</code> delimiter) we process <code>/cfg</code> and <code>/ext</code> at the same level:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>/ext/application-prod.properties</code></p>
</li>
<li>
<p><code>/cfg/application-live.properties</code></p>
</li>
<li>
<p><code>/ext/application-live.properties</code></p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>Environment</code> has a set of default profiles (by default, <code>[default]</code>) that are used if no active profiles are set.
In other words, if no profiles are explicitly activated, then properties from <code>application-default</code> are considered.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Properties files are only ever loaded once.
If you&#8217;ve already directly <a href="#features.external-config.files.importing">imported</a> a profile specific property files then it won&#8217;t be imported a second time.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.external-config.files.importing"><a class="anchor" href="#features.external-config.files.importing"></a>2.3.4. Importing Additional Data</h4>
<div class="paragraph">
<p>Application properties may import further config data from other locations using the <code>spring.config.import</code> property.
Imports are processed as they are discovered, and are treated as additional documents inserted immediately below the one that declares the import.</p>
</div>
<div class="paragraph">
<p>For example, you might have the following in your classpath <code>application.properties</code> file:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.application.name=myapp
spring.config.import=optional:file:./dev.properties</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  application:
    name: "myapp"
  config:
    import: "optional:file:./dev.properties"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will trigger the import of a <code>dev.properties</code> file in current directory (if such a file exists).
Values from the imported <code>dev.properties</code> will take precedence over the file that triggered the import.
In the above example, the <code>dev.properties</code> could redefine <code>spring.application.name</code> to a different value.</p>
</div>
<div class="paragraph">
<p>An import will only be imported once no matter how many times it is declared.
The order an import is defined inside a single document within the properties/yaml file doesn&#8217;t matter.
For instance, the two examples below produce the same result:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.config.import=my.properties
my.property=value</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  config:
    import: my.properties
my:
  property: value</code></pre>
</div>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">my.property=value
spring.config.import=my.properties</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">my:
  property: value
spring:
  config:
    import: my.properties</code></pre>
</div>
</div>
<div class="paragraph">
<p>In both of the above examples, the values from the <code>my.properties</code> file will take precedence over the file that triggered its import.</p>
</div>
<div class="paragraph">
<p>Several locations can be specified under a single <code>spring.config.import</code> key.
Locations will be processed in the order that they are defined, with later imports taking precedence.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When appropriate, <a href="#features.external-config.files.profile-specific">Profile-specific variants</a> are also considered for import.
The example above would import both <code>my.properties</code> as well as any <code>my-&lt;profile&gt;.properties</code> variants.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Spring Boot includes pluggable API that allows various different location addresses to be supported.
By default you can import Java Properties, YAML and &#8220;<a href="#features.external-config.files.configtree">configuration trees</a>&#8221;.</p>
</div>
<div class="paragraph">
<p>Third-party jars can offer support for additional technologies (there&#8217;s no requirement for files to be local).
For example, you can imagine config data being from external stores such as Consul, Apache ZooKeeper or Netflix Archaius.</p>
</div>
<div class="paragraph">
<p>If you want to support your own locations, see the <code>ConfigDataLocationResolver</code> and <code>ConfigDataLoader</code> classes in the <code>org.springframework.boot.context.config</code> package.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.external-config.files.importing-extensionless"><a class="anchor" href="#features.external-config.files.importing-extensionless"></a>2.3.5. Importing Extensionless Files</h4>
<div class="paragraph">
<p>Some cloud platforms cannot add a file extension to volume mounted files.
To import these extensionless files, you need to give Spring Boot a hint so that it knows how to load them.
You can do this by putting an extension hint in square brackets.</p>
</div>
<div class="paragraph">
<p>For example, suppose you have a <code>/etc/config/myconfig</code> file that you wish to import as yaml.
You can import it from your <code>application.properties</code> using the following:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.config.import=file:/etc/config/myconfig[.yaml]</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  config:
    import: "file:/etc/config/myconfig[.yaml]"</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.external-config.files.configtree"><a class="anchor" href="#features.external-config.files.configtree"></a>2.3.6. Using Configuration Trees</h4>
<div class="paragraph">
<p>When running applications on a cloud platform (such as Kubernetes) you often need to read config values that the platform supplies.
It&#8217;s not uncommon to use environment variables for such purposes, but this can have drawbacks, especially if the value is supposed to be kept secret.</p>
</div>
<div class="paragraph">
<p>As an alternative to environment variables, many cloud platforms now allow you to map configuration into mounted data volumes.
For example, Kubernetes can volume mount both <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/#populate-a-volume-with-data-stored-in-a-configmap"><code>ConfigMaps</code></a> and <a href="https://kubernetes.io/docs/concepts/configuration/secret/#using-secrets-as-files-from-a-pod"><code>Secrets</code></a>.</p>
</div>
<div class="paragraph">
<p>There are two common volume mount patterns that can be use:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A single file contains a complete set of properties (usually written as YAML).</p>
</li>
<li>
<p>Multiple files are written to a directory tree, with the filename becoming the &#8216;key&#8217; and the contents becoming the &#8216;value&#8217;.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For the first case, you can import the YAML or Properties file directly using <code>spring.config.import</code> as described <a href="#features.external-config.files.importing">above</a>.
For the second case, you need to use the <code>configtree:</code> prefix so that Spring Boot knows it needs to expose all the files as properties.</p>
</div>
<div class="paragraph">
<p>As an example, let&#8217;s imagine that Kubernetes has mounted the following volume:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>etc/
  config/
    myapp/
      username
      password</pre>
</div>
</div>
<div class="paragraph">
<p>The contents of the <code>username</code> file would be a config value, and the contents of <code>password</code> would be a secret.</p>
</div>
<div class="paragraph">
<p>To import these properties, you can add the following to your <code>application.properties</code> or <code>application.yaml</code> file:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.config.import=optional:configtree:/etc/config/</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  config:
    import: "optional:configtree:/etc/config/"</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can then access or inject <code>myapp.username</code> and <code>myapp.password</code> properties from the <code>Environment</code> in the usual way.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Configuration tree values can be bound to both string <code>String</code> and <code>byte[]</code> types depending on the contents expected.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you have multiple config trees to import from the same parent folder you can use a wildcard shortcut.
Any <code>configtree:</code> location that ends with <code>/*/</code> will import all immediate children as config trees.</p>
</div>
<div class="paragraph">
<p>For example, given the following volume:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>etc/
  config/
    dbconfig/
      db/
        username
        password
    mqconfig/
      mq/
        username
        password</pre>
</div>
</div>
<div class="paragraph">
<p>You can use <code>configtree:/etc/config/*/</code> as the import location:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.config.import=optional:configtree:/etc/config/*/</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  config:
    import: "optional:configtree:/etc/config/*/"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will add <code>db.username</code>, <code>db.password</code>, <code>mq.username</code> and <code>mq.password</code> properties.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Directories loaded using a wildcard are sorted alphabetically.
If you need a different order, then you should list each location as a separate import
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Configuration trees can also be used for Docker secrets.
When a Docker swarm service is granted access to a secret, the secret gets mounted into the container.
For example, if a secret named <code>db.password</code> is mounted at location <code>/run/secrets/</code>, you can make <code>db.password</code> available to the Spring environment using the following:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.config.import=optional:configtree:/run/secrets/</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  config:
    import: "optional:configtree:/run/secrets/"</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.external-config.files.property-placeholders"><a class="anchor" href="#features.external-config.files.property-placeholders"></a>2.3.7. Property Placeholders</h4>
<div class="paragraph">
<p>The values in <code>application.properties</code> and <code>application.yml</code> are filtered through the existing <code>Environment</code> when they are used, so you can refer back to previously defined values (for example, from System properties).
The standard <code>${name}</code> property-placeholder syntax can be used anywhere within a value.</p>
</div>
<div class="paragraph">
<p>For example, the following file will set <code>app.description</code> to &#8220;MyApp is a Spring Boot application&#8221;:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">app.name=MyApp
app.description=${app.name} is a Spring Boot application</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">app:
  name: "MyApp"
  description: "${app.name} is a Spring Boot application"</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can also use this technique to create &#8220;short&#8221; variants of existing Spring Boot properties.
See the <em><a href="howto.html#howto.properties-and-configuration.short-command-line-arguments">howto.html</a></em> how-to for details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.external-config.files.multi-document"><a class="anchor" href="#features.external-config.files.multi-document"></a>2.3.8. Working with Multi-Document Files</h4>
<div class="paragraph">
<p>Spring Boot allows you to split a single physical file into multiple logical documents which are each added independently.
Documents are processed in order, from top to bottom.
Later documents can override the properties defined in earlier ones.</p>
</div>
<div class="paragraph">
<p>For <code>application.yml</code> files, the standard YAML multi-document syntax is used.
Three consecutive hyphens represent the end of one document, and the start of the next.</p>
</div>
<div class="paragraph">
<p>For example, the following file has two logical documents:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring.application.name: MyApp
---
spring.config.activate.on-cloud-platform: kubernetes
spring.application.name: MyCloudApp</code></pre>
</div>
</div>
<div class="paragraph">
<p>For <code>application.properties</code> files a special <code>#---</code> comment is used to mark the document splits:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.application.name=MyApp
#---
spring.config.activate.on-cloud-platform=kubernetes
spring.application.name=MyCloudApp</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Property file separators must not have any leading whitespace and must have exactly three hyphen characters.
The lines immediately before and after the separator must not be comments.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Multi-document property files are often used in conjunction with activation properties such as <code>spring.config.activate.on-profile</code>.
See the <a href="#features.external-config.files.activation-properties">next section</a> for details.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Multi-document property files cannot be loaded by using the <code>@PropertySource</code> or <code>@TestPropertySource</code> annotations.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.external-config.files.activation-properties"><a class="anchor" href="#features.external-config.files.activation-properties"></a>2.3.9. Activation Properties</h4>
<div class="paragraph">
<p>It&#8217;s sometimes useful to only activate a given get of properties when certain conditions are met.
For example, you might have properties that are only relevant when a specific profile is active.</p>
</div>
<div class="paragraph">
<p>You can conditionally activate a properties document using <code>spring.config.activate.*</code>.</p>
</div>
<div class="paragraph">
<p>The following activation properties are available:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. activation properties</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Note</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>on-profile</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A profile expression that must match for the document to be active.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>on-cloud-platform</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <code>CloudPlatform</code> that must be detected for the document to be active.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>For example, the following specifies that the second document is only active when running on Kubernetes, and only when either the &#8220;prod&#8221; or &#8220;staging&#8221; profiles are active:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">myprop=always-set
#---
spring.config.activate.on-cloud-platform=kubernetes
spring.config.activate.on-profile=prod | staging
myotherprop=sometimes-set</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">myprop:
  always-set
---
spring:
  config:
    activate:
      on-cloud-platform: "kubernetes"
      on-profile: "prod | staging"
myotherprop: sometimes-set</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.external-config.encrypting"><a class="anchor" href="#features.external-config.encrypting"></a>2.4. Encrypting Properties</h3>
<div class="paragraph">
<p>Spring Boot does not provide any built in support for encrypting property values, however, it does provide the hook points necessary to modify values contained in the Spring <code>Environment</code>.
The <code>EnvironmentPostProcessor</code> interface allows you to manipulate the <code>Environment</code> before the application starts.
See <a href="howto.html#howto.application.customize-the-environment-or-application-context">howto.html</a> for details.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re looking for a secure way to store credentials and passwords, the <a href="https://cloud.spring.io/spring-cloud-vault/">Spring Cloud Vault</a> project provides support for storing externalized configuration in <a href="https://www.vaultproject.io/">HashiCorp Vault</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.external-config.yaml"><a class="anchor" href="#features.external-config.yaml"></a>2.5. Working with YAML</h3>
<div class="paragraph">
<p><a href="https://yaml.org">YAML</a> is a superset of JSON and, as such, is a convenient format for specifying hierarchical configuration data.
The <code>SpringApplication</code> class automatically supports YAML as an alternative to properties whenever you have the <a href="https://bitbucket.org/asomov/snakeyaml">SnakeYAML</a> library on your classpath.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you use &#8220;Starters&#8221;, SnakeYAML is automatically provided by <code>spring-boot-starter</code>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="features.external-config.yaml.mapping-to-properties"><a class="anchor" href="#features.external-config.yaml.mapping-to-properties"></a>2.5.1. Mapping YAML to Properties</h4>
<div class="paragraph">
<p>YAML documents need to be converted from their hierarchical format to a flat structure that can be used with the Spring <code>Environment</code>.
For example, consider the following YAML document:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">environments:
  dev:
    url: https://dev.example.com
    name: Developer Setup
  prod:
    url: https://another.example.com
    name: My Cool App</code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to access these properties from the <code>Environment</code>, they would be flattened as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">environments.dev.url=https://dev.example.com
environments.dev.name=Developer Setup
environments.prod.url=https://another.example.com
environments.prod.name=My Cool App</code></pre>
</div>
</div>
<div class="paragraph">
<p>Likewise, YAML lists also need to be flattened.
They are represented as property keys with <code>[index]</code> dereferencers.
For example, consider the following YAML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">my:
 servers:
 - dev.example.com
 - another.example.com</code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding example would be transformed into these properties:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">my.servers[0]=dev.example.com
my.servers[1]=another.example.com</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Properties that use the <code>[index]</code> notation can be bound to Java <code>List</code> or <code>Set</code> objects using Spring Boot&#8217;s <code>Binder</code> class.
For more details see the &#8220;<a href="#features.external-config.typesafe-configuration-properties">Type-safe Configuration Properties</a>&#8221; section below.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
YAML files cannot be loaded by using the <code>@PropertySource</code> or <code>@TestPropertySource</code> annotations.
So, in the case that you need to load values that way, you need to use a properties file.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.external-config.yaml.directly-loading"><a class="anchor" href="#features.external-config.yaml.directly-loading"></a>2.5.2. Directly Loading YAML</h4>
<div class="paragraph">
<p>Spring Framework provides two convenient classes that can be used to load YAML documents.
The <code>YamlPropertiesFactoryBean</code> loads YAML as <code>Properties</code> and the <code>YamlMapFactoryBean</code> loads YAML as a <code>Map</code>.</p>
</div>
<div class="paragraph">
<p>You can also use the <code>YamlPropertySourceLoader</code> class if you want to load YAML as a Spring <code>PropertySource</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.external-config.random-values"><a class="anchor" href="#features.external-config.random-values"></a>2.6. Configuring Random Values</h3>
<div class="paragraph">
<p>The <code>RandomValuePropertySource</code> is useful for injecting random values (for example, into secrets or test cases).
It can produce integers, longs, uuids, or strings, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">my.secret=${random.value}
my.number=${random.int}
my.bignumber=${random.long}
my.uuid=${random.uuid}
my.number-less-than-ten=${random.int(10)}
my.number-in-range=${random.int[1024,65536]}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">my:
  secret: "${random.value}"
  number: "${random.int}"
  bignumber: "${random.long}"
  uuid: "${random.uuid}"
  number-less-than-ten: "${random.int(10)}"
  number-in-range: "${random.int[1024,65536]}"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>random.int*</code> syntax is <code>OPEN value (,max) CLOSE</code> where the <code>OPEN,CLOSE</code> are any character and <code>value,max</code> are integers.
If <code>max</code> is provided, then <code>value</code> is the minimum value and <code>max</code> is the maximum value (exclusive).</p>
</div>
</div>
<div class="sect2">
<h3 id="features.external-config.system-environment"><a class="anchor" href="#features.external-config.system-environment"></a>2.7. Configuring System Environment Properties</h3>
<div class="paragraph">
<p>Spring Boot supports setting a prefix for environment properties.
This is useful if the system environment is shared by multiple Spring Boot applications with different configuration requirements.
The prefix for system environment properties can be set directly on <code>SpringApplication</code>.</p>
</div>
<div class="paragraph">
<p>For example, if you set the prefix to <code>input</code>, a property such as <code>remote.timeout</code> will also be resolved as <code>input.remote.timeout</code> in the system environment.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.external-config.typesafe-configuration-properties"><a class="anchor" href="#features.external-config.typesafe-configuration-properties"></a>2.8. Type-safe Configuration Properties</h3>
<div class="paragraph">
<p>Using the <code>@Value("${property}")</code> annotation to inject configuration properties can sometimes be cumbersome, especially if you are working with multiple properties or your data is hierarchical in nature.
Spring Boot provides an alternative method of working with properties that lets strongly typed beans govern and validate the configuration of your application.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See also the <a href="#features.external-config.typesafe-configuration-properties.vs-value-annotation">differences between <code>@Value</code> and type-safe configuration properties</a>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="features.external-config.typesafe-configuration-properties.java-bean-binding"><a class="anchor" href="#features.external-config.typesafe-configuration-properties.java-bean-binding"></a>2.8.1. JavaBean properties binding</h4>
<div class="paragraph">
<p>It is possible to bind a bean declaring standard JavaBean properties as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.net.InetAddress;
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

import org.springframework.boot.context.properties.ConfigurationProperties;

</span><span class="fold-block">@ConfigurationProperties("my.service")
public class MyProperties {

    private boolean enabled;

    private InetAddress remoteAddress;

    private final Security security = new Security();

</span><span class="fold-block hide-when-unfolded">    // getters / setters...

</span><span class="fold-block hide-when-folded">    public boolean isEnabled() {
        return this.enabled;
    }

    public void setEnabled(boolean enabled) {
        this.enabled = enabled;
    }

    public InetAddress getRemoteAddress() {
        return this.remoteAddress;
    }

    public void setRemoteAddress(InetAddress remoteAddress) {
        this.remoteAddress = remoteAddress;
    }

    public Security getSecurity() {
        return this.security;
    }

</span><span class="fold-block">    public static class Security {

        private String username;

        private String password;

        private List&lt;String&gt; roles = new ArrayList&lt;&gt;(Collections.singleton("USER"));

</span><span class="fold-block hide-when-unfolded">        // getters / setters...

</span><span class="fold-block hide-when-folded">        public String getUsername() {
            return this.username;
        }

        public void setUsername(String username) {
            this.username = username;
        }

        public String getPassword() {
            return this.password;
        }

        public void setPassword(String password) {
            this.password = password;
        }

        public List&lt;String&gt; getRoles() {
            return this.roles;
        }

        public void setRoles(List&lt;String&gt; roles) {
            this.roles = roles;
        }

</span><span class="fold-block">    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The preceding POJO defines the following properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>my.service.enabled</code>, with a value of <code>false</code> by default.</p>
</li>
<li>
<p><code>my.service.remote-address</code>, with a type that can be coerced from <code>String</code>.</p>
</li>
<li>
<p><code>my.service.security.username</code>, with a nested "security" object whose name is determined by the name of the property.
In particular, the return type is not used at all there and could have been <code>SecurityProperties</code>.</p>
</li>
<li>
<p><code>my.service.security.password</code>.</p>
</li>
<li>
<p><code>my.service.security.roles</code>, with a collection of <code>String</code> that defaults to <code>USER</code>.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The properties that map to <code>@ConfigurationProperties</code> classes available in Spring Boot, which are configured via properties files, YAML files, environment variables etc., are public API but the accessors (getters/setters) of the class itself are not meant to be used directly.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Such arrangement relies on a default empty constructor and getters and setters are usually mandatory, since binding is through standard Java Beans property descriptors, just like in Spring MVC.
A setter may be omitted in the following cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Maps, as long as they are initialized, need a getter but not necessarily a setter, since they can be mutated by the binder.</p>
</li>
<li>
<p>Collections and arrays can be accessed either through an index (typically with YAML) or by using a single comma-separated value (properties).
In the latter case, a setter is mandatory.
We recommend to always add a setter for such types.
If you initialize a collection, make sure it is not immutable (as in the preceding example).</p>
</li>
<li>
<p>If nested POJO properties are initialized (like the <code>Security</code> field in the preceding example), a setter is not required.
If you want the binder to create the instance on the fly by using its default constructor, you need a setter.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Some people use Project Lombok to add getters and setters automatically.
Make sure that Lombok does not generate any particular constructor for such a type, as it is used automatically by the container to instantiate the object.</p>
</div>
<div class="paragraph">
<p>Finally, only standard Java Bean properties are considered and binding on static properties is not supported.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.external-config.typesafe-configuration-properties.constructor-binding"><a class="anchor" href="#features.external-config.typesafe-configuration-properties.constructor-binding"></a>2.8.2. Constructor binding</h4>
<div class="paragraph">
<p>The example in the previous section can be rewritten in an immutable fashion as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.net.InetAddress;
import java.util.List;

import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.context.properties.ConstructorBinding;
import org.springframework.boot.context.properties.bind.DefaultValue;

</span><span class="fold-block">@ConstructorBinding
@ConfigurationProperties("my.service")
public class MyProperties {

</span><span class="fold-block hide-when-unfolded">    // fields...

</span><span class="fold-block hide-when-folded">    private final boolean enabled;

    private final InetAddress remoteAddress;

    private final Security security;

</span><span class="fold-block">    public MyProperties(boolean enabled, InetAddress remoteAddress, Security security) {
        this.enabled = enabled;
        this.remoteAddress = remoteAddress;
        this.security = security;
    }

</span><span class="fold-block hide-when-unfolded">    // getters...

</span><span class="fold-block hide-when-folded">    public boolean isEnabled() {
        return this.enabled;
    }

    public InetAddress getRemoteAddress() {
        return this.remoteAddress;
    }

    public Security getSecurity() {
        return this.security;
    }

</span><span class="fold-block">    public static class Security {

</span><span class="fold-block hide-when-unfolded">        // fields...

</span><span class="fold-block hide-when-folded">        private final String username;

        private final String password;

        private final List&lt;String&gt; roles;

</span><span class="fold-block">        public Security(String username, String password, @DefaultValue("USER") List&lt;String&gt; roles) {
            this.username = username;
            this.password = password;
            this.roles = roles;
        }

</span><span class="fold-block hide-when-unfolded">        // getters...

</span><span class="fold-block hide-when-folded">        public String getUsername() {
            return this.username;
        }

        public String getPassword() {
            return this.password;
        }

        public List&lt;String&gt; getRoles() {
            return this.roles;
        }

</span><span class="fold-block">    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this setup, the <code>@ConstructorBinding</code> annotation is used to indicate that constructor binding should be used.
This means that the binder will expect to find a constructor with the parameters that you wish to have bound.</p>
</div>
<div class="paragraph">
<p>Nested members of a <code>@ConstructorBinding</code> class (such as <code>Security</code> in the example above) will also be bound via their constructor.</p>
</div>
<div class="paragraph">
<p>Default values can be specified using <code>@DefaultValue</code> and the same conversion service will be applied to coerce the <code>String</code> value to the target type of a missing property.
By default, if no properties are bound to <code>Security</code>, the <code>MyProperties</code> instance will contain a <code>null</code> value for <code>security</code>.
If you wish you return a non-null instance of <code>Security</code> even when no properties are bound to it, you can use an empty <code>@DefaultValue</code> annotation to do so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public MyProperties(boolean enabled, InetAddress remoteAddress, @DefaultValue Security security) {
    this.enabled = enabled;
    this.remoteAddress = remoteAddress;
    this.security = security;
}
</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To use constructor binding the class must be enabled using <code>@EnableConfigurationProperties</code> or configuration property scanning.
You cannot use constructor binding with beans that are created by the regular Spring mechanisms (e.g. <code>@Component</code> beans, beans created via <code>@Bean</code> methods or beans loaded using <code>@Import</code>)
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you have more than one constructor for your class you can also use <code>@ConstructorBinding</code> directly on the constructor that should be bound.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The use of <code>java.util.Optional</code> with <code>@ConfigurationProperties</code> is not recommended as it is primarily intended for use as a return type.
As such, it is not well-suited to configuration property injection.
For consistency with properties of other types, if you do declare an <code>Optional</code> property and it has no value, <code>null</code> rather than an empty <code>Optional</code> will be bound.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.external-config.typesafe-configuration-properties.enabling-annotated-types"><a class="anchor" href="#features.external-config.typesafe-configuration-properties.enabling-annotated-types"></a>2.8.3. Enabling @ConfigurationProperties-annotated types</h4>
<div class="paragraph">
<p>Spring Boot provides infrastructure to bind <code>@ConfigurationProperties</code> types and register them as beans.
You can either enable configuration properties on a class-by-class basis or enable configuration property scanning that works in a similar manner to component scanning.</p>
</div>
<div class="paragraph">
<p>Sometimes, classes annotated with <code>@ConfigurationProperties</code> might not be suitable for scanning, for example, if you&#8217;re developing your own auto-configuration or you want to enable them conditionally.
In these cases, specify the list of types to process using the <code>@EnableConfigurationProperties</code> annotation.
This can be done on any <code>@Configuration</code> class, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.context.properties.EnableConfigurationProperties;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
@EnableConfigurationProperties(SomeProperties.class)
public class MyConfiguration {

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To use configuration property scanning, add the <code>@ConfigurationPropertiesScan</code> annotation to your application.
Typically, it is added to the main application class that is annotated with <code>@SpringBootApplication</code> but it can be added to any <code>@Configuration</code> class.
By default, scanning will occur from the package of the class that declares the annotation.
If you want to define specific packages to scan, you can do so as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.boot.context.properties.ConfigurationPropertiesScan;

</span><span class="fold-block">@SpringBootApplication
@ConfigurationPropertiesScan({ "com.example.app", "com.example.another" })
public class MyApplication {

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When the <code>@ConfigurationProperties</code> bean is registered using configuration property scanning or via <code>@EnableConfigurationProperties</code>, the bean has a conventional name: <code>&lt;prefix&gt;-&lt;fqn&gt;</code>, where <code>&lt;prefix&gt;</code> is the environment key prefix specified in the <code>@ConfigurationProperties</code> annotation and <code>&lt;fqn&gt;</code> is the fully qualified name of the bean.
If the annotation does not provide any prefix, only the fully qualified name of the bean is used.</p>
</div>
<div class="paragraph">
<p>The bean name in the example above is <code>com.example.app-com.example.app.SomeProperties</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We recommend that <code>@ConfigurationProperties</code> only deal with the environment and, in particular, does not inject other beans from the context.
For corner cases, setter injection can be used or any of the <code>*Aware</code> interfaces provided by the framework (such as <code>EnvironmentAware</code> if you need access to the <code>Environment</code>).
If you still want to inject other beans using the constructor, the configuration properties bean must be annotated with <code>@Component</code> and use JavaBean-based property binding.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.external-config.typesafe-configuration-properties.using-annotated-types"><a class="anchor" href="#features.external-config.typesafe-configuration-properties.using-annotated-types"></a>2.8.4. Using @ConfigurationProperties-annotated types</h4>
<div class="paragraph">
<p>This style of configuration works particularly well with the <code>SpringApplication</code> external YAML configuration, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">my:
    service:
        remote-address: 192.168.1.1
        security:
            username: admin
            roles:
              - USER
              - ADMIN</code></pre>
</div>
</div>
<div class="paragraph">
<p>To work with <code>@ConfigurationProperties</code> beans, you can inject them in the same way as any other bean, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.stereotype.Service;

</span><span class="fold-block">@Service
public class MyService {

    private final SomeProperties properties;

    public MyService(SomeProperties properties) {
        this.properties = properties;
    }

    public void openConnection() {
        Server server = new Server(this.properties.getRemoteAddress());
        server.start();
        // ...
    }

    // ...

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Using <code>@ConfigurationProperties</code> also lets you generate metadata files that can be used by IDEs to offer auto-completion for your own keys.
See the <a href="configuration-metadata.html#configuration-metadata">appendix</a> for details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.external-config.typesafe-configuration-properties.third-party-configuration"><a class="anchor" href="#features.external-config.typesafe-configuration-properties.third-party-configuration"></a>2.8.5. Third-party Configuration</h4>
<div class="paragraph">
<p>As well as using <code>@ConfigurationProperties</code> to annotate a class, you can also use it on public <code>@Bean</code> methods.
Doing so can be particularly useful when you want to bind properties to third-party components that are outside of your control.</p>
</div>
<div class="paragraph">
<p>To configure a bean from the <code>Environment</code> properties, add <code>@ConfigurationProperties</code> to its bean registration, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class ThirdPartyConfiguration {

    @Bean
    @ConfigurationProperties(prefix = "another")
    public AnotherComponent anotherComponent() {
        return new AnotherComponent();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Any JavaBean property defined with the <code>another</code> prefix is mapped onto that <code>AnotherComponent</code> bean in manner similar to the preceding <code>SomeProperties</code> example.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.external-config.typesafe-configuration-properties.relaxed-binding"><a class="anchor" href="#features.external-config.typesafe-configuration-properties.relaxed-binding"></a>2.8.6. Relaxed Binding</h4>
<div class="paragraph">
<p>Spring Boot uses some relaxed rules for binding <code>Environment</code> properties to <code>@ConfigurationProperties</code> beans, so there does not need to be an exact match between the <code>Environment</code> property name and the bean property name.
Common examples where this is useful include dash-separated environment properties (for example, <code>context-path</code> binds to <code>contextPath</code>), and capitalized environment properties (for example, <code>PORT</code> binds to <code>port</code>).</p>
</div>
<div class="paragraph">
<p>As an example, consider the following <code>@ConfigurationProperties</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.context.properties.ConfigurationProperties;

</span><span class="fold-block">@ConfigurationProperties(prefix = "my.main-project.person")
public class MyPersonProperties {

    private String firstName;

    public String getFirstName() {
        return this.firstName;
    }

    public void setFirstName(String firstName) {
        this.firstName = firstName;
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>With the preceding code, the following properties names can all be used:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. relaxed binding</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Note</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>my.main-project.person.first-name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kebab case, which is recommended for use in <code>.properties</code> and <code>.yml</code> files.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>my.main-project.person.firstName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard camel case syntax.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>my.main-project.person.first_name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Underscore notation, which is an alternative format for use in <code>.properties</code> and <code>.yml</code> files.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MY_MAINPROJECT_PERSON_FIRSTNAME</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Upper case format, which is recommended when using system environment variables.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>prefix</code> value for the annotation <em>must</em> be in kebab case (lowercase and separated by <code>-</code>, such as <code>my.main-project.person</code>).
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. relaxed binding rules per property source</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Source</th>
<th class="tableblock halign-left valign-top">Simple</th>
<th class="tableblock halign-left valign-top">List</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Properties Files</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Camel case, kebab case, or underscore notation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard list syntax using <code>[ ]</code> or comma-separated values</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">YAML Files</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Camel case, kebab case, or underscore notation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard YAML list syntax or comma-separated values</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Environment Variables</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Upper case format with underscore as the delimiter (see <a href="#features.external-config.typesafe-configuration-properties.relaxed-binding.environment-variables">Binding from Environment Variables</a>).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Numeric values surrounded by underscores (see <a href="#features.external-config.typesafe-configuration-properties.relaxed-binding.environment-variables">Binding from Environment Variables</a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">System properties</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Camel case, kebab case, or underscore notation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard list syntax using <code>[ ]</code> or comma-separated values</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
We recommend that, when possible, properties are stored in lower-case kebab format, such as <code>my.person.first-name=Rod</code>.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="features.external-config.typesafe-configuration-properties.relaxed-binding.maps"><a class="anchor" href="#features.external-config.typesafe-configuration-properties.relaxed-binding.maps"></a>Binding Maps</h5>
<div class="paragraph">
<p>When binding to <code>Map</code> properties you may need to use a special bracket notation so that the original <code>key</code> value is preserved.
If the key is not surrounded by <code>[]</code>, any characters that are not alpha-numeric, <code>-</code> or <code>.</code> are removed.</p>
</div>
<div class="paragraph">
<p>For example, consider binding the following properties to a <code>Map&lt;String,String&gt;</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">my.map.[/key1]=value1
my.map.[/key2]=value2
my.map./key3=value3</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">my:
  map:
    "[/key1]": "value1"
    "[/key2]": "value2"
    "/key3": "value3"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For YAML files, the brackets need to be surrounded by quotes for the keys to be parsed properly.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The properties above will bind to a <code>Map</code> with <code>/key1</code>, <code>/key2</code> and <code>key3</code> as the keys in the map.
The slash has been removed from <code>key3</code> because it wasn&#8217;t surrounded by square brackets.</p>
</div>
<div class="paragraph">
<p>You may also occasionally need to use the bracket notation if your <code>key</code> contains a <code>.</code> and you are binding to non-scalar value.
For example, binding <code>a.b=c</code> to <code>Map&lt;String, Object&gt;</code> will return a Map with the entry <code>{"a"={"b"="c"}}</code> whereas <code>[a.b]=c</code> will return a Map with the entry <code>{"a.b"="c"}</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="features.external-config.typesafe-configuration-properties.relaxed-binding.environment-variables"><a class="anchor" href="#features.external-config.typesafe-configuration-properties.relaxed-binding.environment-variables"></a>Binding from Environment Variables</h5>
<div class="paragraph">
<p>Most operating systems impose strict rules around the names that can be used for environment variables.
For example, Linux shell variables can contain only letters (<code>a</code> to <code>z</code> or <code>A</code> to <code>Z</code>), numbers (<code>0</code> to <code>9</code>) or the underscore character (<code>_</code>).
By convention, Unix shell variables will also have their names in UPPERCASE.</p>
</div>
<div class="paragraph">
<p>Spring Boot&#8217;s relaxed binding rules are, as much as possible, designed to be compatible with these naming restrictions.</p>
</div>
<div class="paragraph">
<p>To convert a property name in the canonical-form to an environment variable name you can follow these rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Replace dots (<code>.</code>) with underscores (<code>_</code>).</p>
</li>
<li>
<p>Remove any dashes (<code>-</code>).</p>
</li>
<li>
<p>Convert to uppercase.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example, the configuration property <code>spring.main.log-startup-info</code> would be an environment variable named <code>SPRING_MAIN_LOGSTARTUPINFO</code>.</p>
</div>
<div class="paragraph">
<p>Environment variables can also be used when binding to object lists.
To bind to a <code>List</code>, the element number should be surrounded with underscores in the variable name.</p>
</div>
<div class="paragraph">
<p>For example, the configuration property <code>my.service[0].other</code> would use an environment variable named <code>MY_SERVICE_0_OTHER</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.external-config.typesafe-configuration-properties.merging-complex-types"><a class="anchor" href="#features.external-config.typesafe-configuration-properties.merging-complex-types"></a>2.8.7. Merging Complex Types</h4>
<div class="paragraph">
<p>When lists are configured in more than one place, overriding works by replacing the entire list.</p>
</div>
<div class="paragraph">
<p>For example, assume a <code>MyPojo</code> object with <code>name</code> and <code>description</code> attributes that are <code>null</code> by default.
The following example exposes a list of <code>MyPojo</code> objects from <code>MyProperties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.util.ArrayList;
import java.util.List;

import org.springframework.boot.context.properties.ConfigurationProperties;

</span><span class="fold-block">@ConfigurationProperties("my")
public class MyProperties {

    private final List&lt;MyPojo&gt; list = new ArrayList&lt;&gt;();

    public List&lt;MyPojo&gt; getList() {
        return this.list;
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Consider the following configuration:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">my.list[0].name=my name
my.list[0].description=my description
#---
spring.config.activate.on-profile=dev
my.list[0].name=my another name</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">my:
  list:
  - name: "my name"
    description: "my description"
---
spring:
  config:
    activate:
      on-profile: "dev"
my:
  list:
  - name: "my another name"</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>dev</code> profile is not active, <code>MyProperties.list</code> contains one <code>MyPojo</code> entry, as previously defined.
If the <code>dev</code> profile is enabled, however, the <code>list</code> <em>still</em> contains only one entry (with a name of <code>my another name</code> and a description of <code>null</code>).
This configuration <em>does not</em> add a second <code>MyPojo</code> instance to the list, and it does not merge the items.</p>
</div>
<div class="paragraph">
<p>When a <code>List</code> is specified in multiple profiles, the one with the highest priority (and only that one) is used.
Consider the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">my.list[0].name=my name
my.list[0].description=my description
my.list[1].name=another name
my.list[1].description=another description
#---
spring.config.activate.on-profile=dev
my.list[0].name=my another name</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">my:
  list:
  - name: "my name"
    description: "my description"
  - name: "another name"
    description: "another description"
---
spring:
  config:
    activate:
      on-profile: "dev"
my:
  list:
  - name: "my another name"</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the preceding example, if the <code>dev</code> profile is active, <code>MyProperties.list</code> contains <em>one</em> <code>MyPojo</code> entry (with a name of <code>my another name</code> and a description of <code>null</code>).
For YAML, both comma-separated lists and YAML lists can be used for completely overriding the contents of the list.</p>
</div>
<div class="paragraph">
<p>For <code>Map</code> properties, you can bind with property values drawn from multiple sources.
However, for the same property in multiple sources, the one with the highest priority is used.
The following example exposes a <code>Map&lt;String, MyPojo&gt;</code> from <code>MyProperties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.util.LinkedHashMap;
import java.util.Map;

import org.springframework.boot.context.properties.ConfigurationProperties;

</span><span class="fold-block">@ConfigurationProperties("my")
public class MyProperties {

    private final Map&lt;String, MyPojo&gt; map = new LinkedHashMap&lt;&gt;();

    public Map&lt;String, MyPojo&gt; getMap() {
        return this.map;
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Consider the following configuration:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">my.map.key1.name=my name 1
my.map.key1.description=my description 1
#---
spring.config.activate.on-profile=dev
my.map.key1.name=dev name 1
my.map.key2.name=dev name 2
my.map.key2.description=dev description 2</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">my:
  map:
    key1:
      name: "my name 1"
      description: "my description 1"
---
spring:
  config:
    activate:
      on-profile: "dev"
my:
  map:
    key1:
      name: "dev name 1"
    key2:
      name: "dev name 2"
      description: "dev description 2"</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>dev</code> profile is not active, <code>MyProperties.map</code> contains one entry with key <code>key1</code> (with a name of <code>my name 1</code> and a description of <code>my description 1</code>).
If the <code>dev</code> profile is enabled, however, <code>map</code> contains two entries with keys <code>key1</code> (with a name of <code>dev name 1</code> and a description of <code>my description 1</code>) and <code>key2</code> (with a name of <code>dev name 2</code> and a description of <code>dev description 2</code>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The preceding merging rules apply to properties from all property sources, and not just files.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.external-config.typesafe-configuration-properties.conversion"><a class="anchor" href="#features.external-config.typesafe-configuration-properties.conversion"></a>2.8.8. Properties Conversion</h4>
<div class="paragraph">
<p>Spring Boot attempts to coerce the external application properties to the right type when it binds to the <code>@ConfigurationProperties</code> beans.
If you need custom type conversion, you can provide a <code>ConversionService</code> bean (with a bean named <code>conversionService</code>) or custom property editors (through a <code>CustomEditorConfigurer</code> bean) or custom <code>Converters</code> (with bean definitions annotated as <code>@ConfigurationPropertiesBinding</code>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
As this bean is requested very early during the application lifecycle, make sure to limit the dependencies that your <code>ConversionService</code> is using.
Typically, any dependency that you require may not be fully initialized at creation time.
You may want to rename your custom <code>ConversionService</code> if it is not required for configuration keys coercion and only rely on custom converters qualified with <code>@ConfigurationPropertiesBinding</code>.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="features.external-config.typesafe-configuration-properties.conversion.durations"><a class="anchor" href="#features.external-config.typesafe-configuration-properties.conversion.durations"></a>Converting Durations</h5>
<div class="paragraph">
<p>Spring Boot has dedicated support for expressing durations.
If you expose a <code>java.time.Duration</code> property, the following formats in application properties are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A regular <code>long</code> representation (using milliseconds as the default unit unless a <code>@DurationUnit</code> has been specified)</p>
</li>
<li>
<p>The standard ISO-8601 format <a href="https://docs.oracle.com/javase/8/docs/api/java/time/Duration.html#parse-java.lang.CharSequence-">used by <code>java.time.Duration</code></a></p>
</li>
<li>
<p>A more readable format where the value and the unit are coupled (e.g. <code>10s</code> means 10 seconds)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Consider the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.time.Duration;
import java.time.temporal.ChronoUnit;

import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.convert.DurationUnit;

</span><span class="fold-block">@ConfigurationProperties("my")
public class MyProperties {

    @DurationUnit(ChronoUnit.SECONDS)
    private Duration sessionTimeout = Duration.ofSeconds(30);

    private Duration readTimeout = Duration.ofMillis(1000);

</span><span class="fold-block hide-when-unfolded">    // getters / setters...

</span><span class="fold-block hide-when-folded">    public Duration getSessionTimeout() {
        return this.sessionTimeout;
    }

    public void setSessionTimeout(Duration sessionTimeout) {
        this.sessionTimeout = sessionTimeout;
    }

    public Duration getReadTimeout() {
        return this.readTimeout;
    }

    public void setReadTimeout(Duration readTimeout) {
        this.readTimeout = readTimeout;
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To specify a session timeout of 30 seconds, <code>30</code>, <code>PT30S</code> and <code>30s</code> are all equivalent.
A read timeout of 500ms can be specified in any of the following form: <code>500</code>, <code>PT0.5S</code> and <code>500ms</code>.</p>
</div>
<div class="paragraph">
<p>You can also use any of the supported units.
These are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ns</code> for nanoseconds</p>
</li>
<li>
<p><code>us</code> for microseconds</p>
</li>
<li>
<p><code>ms</code> for milliseconds</p>
</li>
<li>
<p><code>s</code> for seconds</p>
</li>
<li>
<p><code>m</code> for minutes</p>
</li>
<li>
<p><code>h</code> for hours</p>
</li>
<li>
<p><code>d</code> for days</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The default unit is milliseconds and can be overridden using <code>@DurationUnit</code> as illustrated in the sample above.</p>
</div>
<div class="paragraph">
<p>If you prefer to use constructor binding, the same properties can be exposed, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.time.Duration;
import java.time.temporal.ChronoUnit;

import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.context.properties.ConstructorBinding;
import org.springframework.boot.context.properties.bind.DefaultValue;
import org.springframework.boot.convert.DurationUnit;

</span><span class="fold-block">@ConfigurationProperties("my")
@ConstructorBinding
public class MyProperties {

</span><span class="fold-block hide-when-unfolded">    // fields...

</span><span class="fold-block hide-when-folded">    private final Duration sessionTimeout;

    private final Duration readTimeout;

</span><span class="fold-block">    public MyProperties(@DurationUnit(ChronoUnit.SECONDS) @DefaultValue("30s") Duration sessionTimeout,
            @DefaultValue("1000ms") Duration readTimeout) {
        this.sessionTimeout = sessionTimeout;
        this.readTimeout = readTimeout;
    }

</span><span class="fold-block hide-when-unfolded">    // getters...

</span><span class="fold-block hide-when-folded">    public Duration getSessionTimeout() {
        return this.sessionTimeout;
    }

    public Duration getReadTimeout() {
        return this.readTimeout;
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you are upgrading a <code>Long</code> property, make sure to define the unit (using <code>@DurationUnit</code>) if it isn&#8217;t milliseconds.
Doing so gives a transparent upgrade path while supporting a much richer format.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="features.external-config.typesafe-configuration-properties.conversion.periods"><a class="anchor" href="#features.external-config.typesafe-configuration-properties.conversion.periods"></a>Converting periods</h5>
<div class="paragraph">
<p>In addition to durations, Spring Boot can also work with <code>java.time.Period</code> type.
The following formats can be used in application properties:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>An regular <code>int</code> representation (using days as the default unit unless a <code>@PeriodUnit</code> has been specified)</p>
</li>
<li>
<p>The standard ISO-8601 format <a href="https://docs.oracle.com/javase/8/docs/api/java/time/Period.html#parse-java.lang.CharSequence-">used by <code>java.time.Period</code></a></p>
</li>
<li>
<p>A simpler format where the value and the unit pairs are coupled (e.g. <code>1y3d</code> means 1 year and 3 days)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following units are supported with the simple format:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>y</code> for years</p>
</li>
<li>
<p><code>m</code> for months</p>
</li>
<li>
<p><code>w</code> for weeks</p>
</li>
<li>
<p><code>d</code> for days</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>java.time.Period</code> type never actually stores the number of weeks, it is a shortcut that means &#8220;7 days&#8221;.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="features.external-config.typesafe-configuration-properties.conversion.data-sizes"><a class="anchor" href="#features.external-config.typesafe-configuration-properties.conversion.data-sizes"></a>Converting Data Sizes</h5>
<div class="paragraph">
<p>Spring Framework has a <code>DataSize</code> value type that expresses a size in bytes.
If you expose a <code>DataSize</code> property, the following formats in application properties are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A regular <code>long</code> representation (using bytes as the default unit unless a <code>@DataSizeUnit</code> has been specified)</p>
</li>
<li>
<p>A more readable format where the value and the unit are coupled (e.g. <code>10MB</code> means 10 megabytes)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Consider the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.convert.DataSizeUnit;
import org.springframework.util.unit.DataSize;
import org.springframework.util.unit.DataUnit;

</span><span class="fold-block">@ConfigurationProperties("my")
public class MyProperties {

    @DataSizeUnit(DataUnit.MEGABYTES)
    private DataSize bufferSize = DataSize.ofMegabytes(2);

    private DataSize sizeThreshold = DataSize.ofBytes(512);

</span><span class="fold-block hide-when-unfolded">    // getters/setters...

</span><span class="fold-block hide-when-folded">    public DataSize getBufferSize() {
        return this.bufferSize;
    }

    public void setBufferSize(DataSize bufferSize) {
        this.bufferSize = bufferSize;
    }

    public DataSize getSizeThreshold() {
        return this.sizeThreshold;
    }

    public void setSizeThreshold(DataSize sizeThreshold) {
        this.sizeThreshold = sizeThreshold;
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>To specify a buffer size of 10 megabytes, <code>10</code> and <code>10MB</code> are equivalent.
A size threshold of 256 bytes can be specified as <code>256</code> or <code>256B</code>.</p>
</div>
<div class="paragraph">
<p>You can also use any of the supported units.
These are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>B</code> for bytes</p>
</li>
<li>
<p><code>KB</code> for kilobytes</p>
</li>
<li>
<p><code>MB</code> for megabytes</p>
</li>
<li>
<p><code>GB</code> for gigabytes</p>
</li>
<li>
<p><code>TB</code> for terabytes</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The default unit is bytes and can be overridden using <code>@DataSizeUnit</code> as illustrated in the sample above.</p>
</div>
<div class="paragraph">
<p>If you prefer to use constructor binding, the same properties can be exposed, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.boot.context.properties.ConstructorBinding;
import org.springframework.boot.context.properties.bind.DefaultValue;
import org.springframework.boot.convert.DataSizeUnit;
import org.springframework.util.unit.DataSize;
import org.springframework.util.unit.DataUnit;

</span><span class="fold-block">@ConfigurationProperties("my")
@ConstructorBinding
public class MyProperties {

</span><span class="fold-block hide-when-unfolded">    // fields...

</span><span class="fold-block hide-when-folded">    private final DataSize bufferSize;

    private final DataSize sizeThreshold;

</span><span class="fold-block">    public MyProperties(@DataSizeUnit(DataUnit.MEGABYTES) @DefaultValue("2MB") DataSize bufferSize,
            @DefaultValue("512B") DataSize sizeThreshold) {
        this.bufferSize = bufferSize;
        this.sizeThreshold = sizeThreshold;
    }

</span><span class="fold-block hide-when-unfolded">    // getters...

</span><span class="fold-block hide-when-folded">    public DataSize getBufferSize() {
        return this.bufferSize;
    }

    public DataSize getSizeThreshold() {
        return this.sizeThreshold;
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you are upgrading a <code>Long</code> property, make sure to define the unit (using <code>@DataSizeUnit</code>) if it isn&#8217;t bytes.
Doing so gives a transparent upgrade path while supporting a much richer format.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.external-config.typesafe-configuration-properties.validation"><a class="anchor" href="#features.external-config.typesafe-configuration-properties.validation"></a>2.8.9. @ConfigurationProperties Validation</h4>
<div class="paragraph">
<p>Spring Boot attempts to validate <code>@ConfigurationProperties</code> classes whenever they are annotated with Spring&#8217;s <code>@Validated</code> annotation.
You can use JSR-303 <code>javax.validation</code> constraint annotations directly on your configuration class.
To do so, ensure that a compliant JSR-303 implementation is on your classpath and then add constraint annotations to your fields, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.net.InetAddress;

import javax.validation.constraints.NotNull;

import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.validation.annotation.Validated;

</span><span class="fold-block">@ConfigurationProperties("my.service")
@Validated
public class MyProperties {

    @NotNull
    private InetAddress remoteAddress;

</span><span class="fold-block hide-when-unfolded">    // getters/setters...

</span><span class="fold-block hide-when-folded">    public InetAddress getRemoteAddress() {
        return this.remoteAddress;
    }

    public void setRemoteAddress(InetAddress remoteAddress) {
        this.remoteAddress = remoteAddress;
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can also trigger validation by annotating the <code>@Bean</code> method that creates the configuration properties with <code>@Validated</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To ensure that validation is always triggered for nested properties, even when no properties are found, the associated field must be annotated with <code>@Valid</code>.
The following example builds on the preceding <code>MyProperties</code> example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.net.InetAddress;

import javax.validation.Valid;
import javax.validation.constraints.NotEmpty;
import javax.validation.constraints.NotNull;

import org.springframework.boot.context.properties.ConfigurationProperties;
import org.springframework.validation.annotation.Validated;

</span><span class="fold-block">@ConfigurationProperties("my.service")
@Validated
public class MyProperties {

    @NotNull
    private InetAddress remoteAddress;

    @Valid
    private final Security security = new Security();

</span><span class="fold-block hide-when-unfolded">    // getters/setters...

</span><span class="fold-block hide-when-folded">    public InetAddress getRemoteAddress() {
        return this.remoteAddress;
    }

    public void setRemoteAddress(InetAddress remoteAddress) {
        this.remoteAddress = remoteAddress;
    }

    public Security getSecurity() {
        return this.security;
    }

</span><span class="fold-block">    public static class Security {

        @NotEmpty
        private String username;

</span><span class="fold-block hide-when-unfolded">        // getters/setters...

</span><span class="fold-block hide-when-folded">        public String getUsername() {
            return this.username;
        }

        public void setUsername(String username) {
            this.username = username;
        }

</span><span class="fold-block">    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also add a custom Spring <code>Validator</code> by creating a bean definition called <code>configurationPropertiesValidator</code>.
The <code>@Bean</code> method should be declared <code>static</code>.
The configuration properties validator is created very early in the application&#8217;s lifecycle, and declaring the <code>@Bean</code> method as static lets the bean be created without having to instantiate the <code>@Configuration</code> class.
Doing so avoids any problems that may be caused by early instantiation.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The <code>spring-boot-actuator</code> module includes an endpoint that exposes all <code>@ConfigurationProperties</code> beans.
Point your web browser to <code>/actuator/configprops</code> or use the equivalent JMX endpoint.
See the "<a href="actuator.html#actuator.endpoints">Production ready features</a>" section for details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.external-config.typesafe-configuration-properties.vs-value-annotation"><a class="anchor" href="#features.external-config.typesafe-configuration-properties.vs-value-annotation"></a>2.8.10. @ConfigurationProperties vs. @Value</h4>
<div class="paragraph">
<p>The <code>@Value</code> annotation is a core container feature, and it does not provide the same features as type-safe configuration properties.
The following table summarizes the features that are supported by <code>@ConfigurationProperties</code> and <code>@Value</code>:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Feature</th>
<th class="tableblock halign-left valign-top"><code>@ConfigurationProperties</code></th>
<th class="tableblock halign-left valign-top"><code>@Value</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#features.external-config.typesafe-configuration-properties.relaxed-binding">Relaxed binding</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Limited (see <a href="#features.external-config.typesafe-configuration-properties.vs-value-annotation.note">note below</a>)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="configuration-metadata.html#configuration-metadata">Meta-data support</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SpEL</code> evaluation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
</tbody>
</table>
<div id="features.external-config.typesafe-configuration-properties.vs-value-annotation.note" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you do want to use <code>@Value</code>, we recommend that you refer to property names using their canonical form (kebab-case using only lowercase letters).
This will allow Spring Boot to use the same logic as it does when relaxed binding <code>@ConfigurationProperties</code>.
For example, <code>@Value("{demo.item-price}")</code> will pick up <code>demo.item-price</code> and <code>demo.itemPrice</code> forms from the <code>application.properties</code> file, as well as <code>DEMO_ITEMPRICE</code> from the system environment.
If you used <code>@Value("{demo.itemPrice}")</code> instead, <code>demo.item-price</code> and <code>DEMO_ITEMPRICE</code> would not be considered.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you define a set of configuration keys for your own components, we recommend you group them in a POJO annotated with <code>@ConfigurationProperties</code>.
Doing so will provide you with structured, type-safe object that you can inject into your own beans.</p>
</div>
<div class="paragraph">
<p><code>SpEL</code> expressions from <a href="#features.external-config.files">application property files</a> are not processed at time of parsing these files and populating the environment.
However, it is possible to write a <code>SpEL</code> expression in <code>@Value</code>.
If the value of a property from an application property file is a <code>SpEL</code> expression, it will be evaluated when consumed via <code>@Value</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.profiles"><a class="anchor" href="#features.profiles"></a>3. Profiles</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Profiles provide a way to segregate parts of your application configuration and make it be available only in certain environments.
Any <code>@Component</code>, <code>@Configuration</code> or <code>@ConfigurationProperties</code> can be marked with <code>@Profile</code> to limit when it is loaded, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Profile;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
@Profile("production")
public class ProductionConfiguration {

    // ...

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If <code>@ConfigurationProperties</code> beans are registered via <code>@EnableConfigurationProperties</code> instead of automatic scanning, the <code>@Profile</code> annotation needs to be specified on the <code>@Configuration</code> class that has the <code>@EnableConfigurationProperties</code> annotation.
In the case where <code>@ConfigurationProperties</code> are scanned, <code>@Profile</code> can be specified on the <code>@ConfigurationProperties</code> class itself.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can use a <code>spring.profiles.active</code> <code>Environment</code> property to specify which profiles are active.
You can specify the property in any of the ways described earlier in this chapter.
For example, you could include it in your <code>application.properties</code>, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.profiles.active=dev,hsqldb</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  profiles:
    active: "dev,hsqldb"</code></pre>
</div>
</div>
<div class="paragraph">
<p>You could also specify it on the command line by using the following switch: <code>--spring.profiles.active=dev,hsqldb</code>.</p>
</div>
<div class="paragraph">
<p>If no profile is active, a default profile is enabled.
The name of the default profile is <code>default</code> and it can be tuned using the <code>spring.profiles.default</code> <code>Environment</code> property, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.profiles.default=none</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  profiles:
    default: "none"</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="features.profiles.adding-active-profiles"><a class="anchor" href="#features.profiles.adding-active-profiles"></a>3.1. Adding Active Profiles</h3>
<div class="paragraph">
<p>The <code>spring.profiles.active</code> property follows the same ordering rules as other properties: The highest <code>PropertySource</code> wins.
This means that you can specify active profiles in <code>application.properties</code> and then <strong>replace</strong> them by using the command line switch.</p>
</div>
<div class="paragraph">
<p>Sometimes, it is useful to have properties that <strong>add</strong> to the active profiles rather than replace them.
The <code>SpringApplication</code> entry point has a Java API for setting additional profiles (that is, on top of those activated by the <code>spring.profiles.active</code> property).
See the <code>setAdditionalProfiles()</code> method in <a href="https://docs.spring.io/spring-boot/docs/2.5.3/api/org/springframework/boot/SpringApplication.html">SpringApplication</a>.
Profile groups, which are described in the <a href="#features.profiles.groups">next section</a> can also be used to add active profiles if a given profile is active.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.profiles.groups"><a class="anchor" href="#features.profiles.groups"></a>3.2. Profile Groups</h3>
<div class="paragraph">
<p>Occasionally the profiles that you define and use in your application are too fine-grained and become cumbersome to use.
For example, you might have <code>proddb</code> and <code>prodmq</code> profiles that you use to enable database and messaging features independently.</p>
</div>
<div class="paragraph">
<p>To help with this, Spring Boot lets you define profile groups.
A profile group allows you to define a logical name for a related group of profiles.</p>
</div>
<div class="paragraph">
<p>For example, we can create a <code>production</code> group that consists of our <code>proddb</code> and <code>prodmq</code> profiles.</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.profiles.group.production[0]=proddb
spring.profiles.group.production[1]=prodmq</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  profiles:
    group:
      production:
      - "proddb"
      - "prodmq"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Our application can now be started using <code>--spring.profiles.active=production</code> to active the <code>production</code>, <code>proddb</code> and <code>prodmq</code> profiles in one hit.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.profiles.programmatically-setting-profiles"><a class="anchor" href="#features.profiles.programmatically-setting-profiles"></a>3.3. Programmatically Setting Profiles</h3>
<div class="paragraph">
<p>You can programmatically set active profiles by calling <code>SpringApplication.setAdditionalProfiles(&#8230;&#8203;)</code> before your application runs.
It is also possible to activate profiles by using Spring&#8217;s <code>ConfigurableEnvironment</code> interface.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.profiles.profile-specific-configuration-files"><a class="anchor" href="#features.profiles.profile-specific-configuration-files"></a>3.4. Profile-specific Configuration Files</h3>
<div class="paragraph">
<p>Profile-specific variants of both <code>application.properties</code> (or <code>application.yml</code>) and files referenced through <code>@ConfigurationProperties</code> are considered as files and loaded.
See "<a href="#features.external-config.files.profile-specific">Profile Specific Files</a>" for details.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.logging"><a class="anchor" href="#features.logging"></a>4. Logging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot uses <a href="https://commons.apache.org/logging">Commons Logging</a> for all internal logging but leaves the underlying log implementation open.
Default configurations are provided for <a href="https://docs.oracle.com/javase/8/docs/api/java/util/logging/package-summary.html">Java Util Logging</a>, <a href="https://logging.apache.org/log4j/2.x/">Log4J2</a>, and <a href="https://logback.qos.ch/">Logback</a>.
In each case, loggers are pre-configured to use console output with optional file output also available.</p>
</div>
<div class="paragraph">
<p>By default, if you use the &#8220;Starters&#8221;, Logback is used for logging.
Appropriate Logback routing is also included to ensure that dependent libraries that use Java Util Logging, Commons Logging, Log4J, or SLF4J all work correctly.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
There are a lot of logging frameworks available for Java.
Do not worry if the above list seems confusing.
Generally, you do not need to change your logging dependencies and the Spring Boot defaults work just fine.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
When you deploy your application to a servlet container or application server, logging performed via the Java Util Logging API is not routed into your application&#8217;s logs.
This prevents logging performed by the container or other applications that have been deployed to it from appearing in your application&#8217;s logs.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="features.logging.log-format"><a class="anchor" href="#features.logging.log-format"></a>4.1. Log Format</h3>
<div class="paragraph">
<p>The default log output from Spring Boot resembles the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>2019-03-05 10:57:51.112  INFO 45469 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet Engine: Apache Tomcat/7.0.52
2019-03-05 10:57:51.253  INFO 45469 --- [ost-startStop-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2019-03-05 10:57:51.253  INFO 45469 --- [ost-startStop-1] o.s.web.context.ContextLoader            : Root WebApplicationContext: initialization completed in 1358 ms
2019-03-05 10:57:51.698  INFO 45469 --- [ost-startStop-1] o.s.b.c.e.ServletRegistrationBean        : Mapping servlet: 'dispatcherServlet' to [/]
2019-03-05 10:57:51.702  INFO 45469 --- [ost-startStop-1] o.s.b.c.embedded.FilterRegistrationBean  : Mapping filter: 'hiddenHttpMethodFilter' to: [/*]</pre>
</div>
</div>
<div class="paragraph">
<p>The following items are output:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Date and Time: Millisecond precision and easily sortable.</p>
</li>
<li>
<p>Log Level: <code>ERROR</code>, <code>WARN</code>, <code>INFO</code>, <code>DEBUG</code>, or <code>TRACE</code>.</p>
</li>
<li>
<p>Process ID.</p>
</li>
<li>
<p>A <code>---</code> separator to distinguish the start of actual log messages.</p>
</li>
<li>
<p>Thread name: Enclosed in square brackets (may be truncated for console output).</p>
</li>
<li>
<p>Logger name: This is usually the source class name (often abbreviated).</p>
</li>
<li>
<p>The log message.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Logback does not have a <code>FATAL</code> level.
It is mapped to <code>ERROR</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features.logging.console-output"><a class="anchor" href="#features.logging.console-output"></a>4.2. Console Output</h3>
<div class="paragraph">
<p>The default log configuration echoes messages to the console as they are written.
By default, <code>ERROR</code>-level, <code>WARN</code>-level, and <code>INFO</code>-level messages are logged.
You can also enable a &#8220;debug&#8221; mode by starting your application with a <code>--debug</code> flag.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ java -jar myapp.jar --debug</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You can also specify <code>debug=true</code> in your <code>application.properties</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When the debug mode is enabled, a selection of core loggers (embedded container, Hibernate, and Spring Boot) are configured to output more information.
Enabling the debug mode does <em>not</em> configure your application to log all messages with <code>DEBUG</code> level.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can enable a &#8220;trace&#8221; mode by starting your application with a <code>--trace</code> flag (or <code>trace=true</code> in your <code>application.properties</code>).
Doing so enables trace logging for a selection of core loggers (embedded container, Hibernate schema generation, and the whole Spring portfolio).</p>
</div>
<div class="sect3">
<h4 id="features.logging.console-output.color-coded"><a class="anchor" href="#features.logging.console-output.color-coded"></a>4.2.1. Color-coded Output</h4>
<div class="paragraph">
<p>If your terminal supports ANSI, color output is used to aid readability.
You can set <code>spring.output.ansi.enabled</code> to a <a href="https://docs.spring.io/spring-boot/docs/2.5.3/api/org/springframework/boot/ansi/AnsiOutput.Enabled.html">supported value</a> to override the auto-detection.</p>
</div>
<div class="paragraph">
<p>Color coding is configured by using the <code>%clr</code> conversion word.
In its simplest form, the converter colors the output according to the log level, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>%clr(%5p)</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following table describes the mapping of log levels to colors:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Level</th>
<th class="tableblock halign-left valign-top">Color</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FATAL</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Red</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ERROR</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Red</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WARN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yellow</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>INFO</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Green</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DEBUG</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Green</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TRACE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Green</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Alternatively, you can specify the color or style that should be used by providing it as an option to the conversion.
For example, to make the text yellow, use the following setting:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>%clr(%d{yyyy-MM-dd HH:mm:ss.SSS}){yellow}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following colors and styles are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>blue</code></p>
</li>
<li>
<p><code>cyan</code></p>
</li>
<li>
<p><code>faint</code></p>
</li>
<li>
<p><code>green</code></p>
</li>
<li>
<p><code>magenta</code></p>
</li>
<li>
<p><code>red</code></p>
</li>
<li>
<p><code>yellow</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.logging.file-output"><a class="anchor" href="#features.logging.file-output"></a>4.3. File Output</h3>
<div class="paragraph">
<p>By default, Spring Boot logs only to the console and does not write log files.
If you want to write log files in addition to the console output, you need to set a <code>logging.file.name</code> or <code>logging.file.path</code> property (for example, in your <code>application.properties</code>).</p>
</div>
<div class="paragraph">
<p>The following table shows how the <code>logging.*</code> properties can be used together:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Logging properties</caption>
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 57.1429%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><code>logging.file.name</code></th>
<th class="tableblock halign-left valign-top"><code>logging.file.path</code></th>
<th class="tableblock halign-left valign-top">Example</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>(none)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>(none)</em></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Console only logging.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specific file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>(none)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>my.log</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Writes to the specified log file.
Names can be an exact location or relative to the current directory.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>(none)</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specific directory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/var/log</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Writes <code>spring.log</code> to the specified directory.
Names can be an exact location or relative to the current directory.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Log files rotate when they reach 10 MB and, as with console output, <code>ERROR</code>-level, <code>WARN</code>-level, and <code>INFO</code>-level messages are logged by default.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Logging properties are independent of the actual logging infrastructure.
As a result, specific configuration keys (such as <code>logback.configurationFile</code> for Logback) are not managed by spring Boot.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features.logging.file-rotation"><a class="anchor" href="#features.logging.file-rotation"></a>4.4. File Rotation</h3>
<div class="paragraph">
<p>If you are using the Logback, it&#8217;s possible to fine-tune log rotation settings using your <code>application.properties</code> or <code>application.yaml</code> file.
For all other logging system, you&#8217;ll need to configure rotation settings directly yourself (for example, if you use Log4J2 then you could add a <code>log4j.xml</code> file).</p>
</div>
<div class="paragraph">
<p>The following rotation policy properties are supported:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.logback.rollingpolicy.file-name-pattern</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The filename pattern used to create log archives.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.logback.rollingpolicy.clean-history-on-start</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If log archive cleanup should occur when the application starts.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.logback.rollingpolicy.max-file-size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum size of log file before it&#8217;s archived.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.logback.rollingpolicy.total-size-cap</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum amount of size log archives can take before being deleted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.logback.rollingpolicy.max-history</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of days to keep log archives (defaults to 7)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="features.logging.log-levels"><a class="anchor" href="#features.logging.log-levels"></a>4.5. Log Levels</h3>
<div class="paragraph">
<p>All the supported logging systems can have the logger levels set in the Spring <code>Environment</code> (for example, in <code>application.properties</code>) by using <code>logging.level.&lt;logger-name&gt;=&lt;level&gt;</code> where <code>level</code> is one of TRACE, DEBUG, INFO, WARN, ERROR, FATAL, or OFF.
The <code>root</code> logger can be configured by using <code>logging.level.root</code>.</p>
</div>
<div class="paragraph">
<p>The following example shows potential logging settings in <code>application.properties</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">logging.level.root=warn
logging.level.org.springframework.web=debug
logging.level.org.hibernate=error</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">logging:
  level:
    root: "warn"
    org.springframework.web: "debug"
    org.hibernate: "error"</code></pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s also possible to set logging levels using environment variables.
For example, <code>LOGGING_LEVEL_ORG_SPRINGFRAMEWORK_WEB=DEBUG</code> will set <code>org.springframework.web</code> to <code>DEBUG</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The above approach will only work for package level logging.
Since relaxed binding always converts environment variables to lowercase, it&#8217;s not possible to configure logging for an individual class in this way.
If you need to configure logging for a class, you can use <a href="#features.external-config.application-json">the <code>SPRING_APPLICATION_JSON</code></a> variable.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features.logging.log-groups"><a class="anchor" href="#features.logging.log-groups"></a>4.6. Log Groups</h3>
<div class="paragraph">
<p>It&#8217;s often useful to be able to group related loggers together so that they can all be configured at the same time.
For example, you might commonly change the logging levels for <em>all</em> Tomcat related loggers, but you can&#8217;t easily remember top level packages.</p>
</div>
<div class="paragraph">
<p>To help with this, Spring Boot allows you to define logging groups in your Spring <code>Environment</code>.
For example, here&#8217;s how you could define a &#8220;tomcat&#8221; group by adding it to your <code>application.properties</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">logging.group.tomcat=org.apache.catalina,org.apache.coyote,org.apache.tomcat</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">logging:
  group:
    tomcat: "org.apache.catalina,org.apache.coyote,org.apache.tomcat"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once defined, you can change the level for all the loggers in the group with a single line:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">logging.level.tomcat=trace</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">logging:
  level:
    tomcat: "trace"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Spring Boot includes the following pre-defined logging groups that can be used out-of-the-box:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Loggers</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">web</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.springframework.core.codec</code>, <code>org.springframework.http</code>, <code>org.springframework.web</code>, <code>org.springframework.boot.actuate.endpoint.web</code>, <code>org.springframework.boot.web.servlet.ServletContextInitializerBeans</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sql</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.springframework.jdbc.core</code>, <code>org.hibernate.SQL</code>, <code>org.jooq.tools.LoggerListener</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="features.logging.shutdown-hook"><a class="anchor" href="#features.logging.shutdown-hook"></a>4.7. Using a Log Shutdown Hook</h3>
<div class="paragraph">
<p>In order to release logging resources when your application terminates, a shutdown hook that will trigger log system cleanup when the JVM exits is provided.
This shutdown hook is registered automatically unless your application is deployed as a war file.
If your application has complex context hierarchies the shutdown hook may not meet your needs.
If it does not, disable the shutdown hook and investigate the options provided directly by the underlying logging system.
For example, Logback offers <a href="http://logback.qos.ch/manual/loggingSeparation.html">context selectors</a> which allow each Logger to be created in its own context.
You can use the <code>logging.register-shutdown-hook</code> property to disable the shutdown hook.
Setting it to <code>false</code> will disable the registration.
You can set the property in your <code>application.properties</code> or <code>application.yaml</code> file:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">logging.register-shutdown-hook=false</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">logging:
  register-shutdown-hook: false</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.logging.custom-log-configuration"><a class="anchor" href="#features.logging.custom-log-configuration"></a>4.8. Custom Log Configuration</h3>
<div class="paragraph">
<p>The various logging systems can be activated by including the appropriate libraries on the classpath and can be further customized by providing a suitable configuration file in the root of the classpath or in a location specified by the following Spring <code>Environment</code> property: <code>logging.config</code>.</p>
</div>
<div class="paragraph">
<p>You can force Spring Boot to use a particular logging system by using the <code>org.springframework.boot.logging.LoggingSystem</code> system property.
The value should be the fully qualified class name of a <code>LoggingSystem</code> implementation.
You can also disable Spring Boot&#8217;s logging configuration entirely by using a value of <code>none</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Since logging is initialized <strong>before</strong> the <code>ApplicationContext</code> is created, it is not possible to control logging from <code>@PropertySources</code> in Spring <code>@Configuration</code> files.
The only way to change the logging system or disable it entirely is via System properties.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Depending on your logging system, the following files are loaded:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Logging System</th>
<th class="tableblock halign-left valign-top">Customization</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logback</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logback-spring.xml</code>, <code>logback-spring.groovy</code>, <code>logback.xml</code>, or <code>logback.groovy</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Log4j2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>log4j2-spring.xml</code> or <code>log4j2.xml</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JDK (Java Util Logging)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.properties</code></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When possible, we recommend that you use the <code>-spring</code> variants for your logging configuration (for example, <code>logback-spring.xml</code> rather than <code>logback.xml</code>).
If you use standard configuration locations, Spring cannot completely control log initialization.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
There are known classloading issues with Java Util Logging that cause problems when running from an 'executable jar'.
We recommend that you avoid it when running from an 'executable jar' if at all possible.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To help with the customization, some other properties are transferred from the Spring <code>Environment</code> to System properties, as described in the following table:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Spring Environment</th>
<th class="tableblock halign-left valign-top">System Property</th>
<th class="tableblock halign-left valign-top">Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.exception-conversion-word</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOG_EXCEPTION_CONVERSION_WORD</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The conversion word used when logging exceptions.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.file.name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOG_FILE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If defined, it is used in the default log configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.file.path</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOG_PATH</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If defined, it is used in the default log configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.pattern.console</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CONSOLE_LOG_PATTERN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The log pattern to use on the console (stdout).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.pattern.dateformat</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOG_DATEFORMAT_PATTERN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Appender pattern for log date format.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.charset.console</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CONSOLE_LOG_CHARSET</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The charset to use for console logging.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.pattern.file</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FILE_LOG_PATTERN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The log pattern to use in a file (if <code>LOG_FILE</code> is enabled).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.charset.file</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FILE_LOG_CHARSET</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The charset to use for file logging (if <code>LOG_FILE</code> is enabled).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.pattern.level</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOG_LEVEL_PATTERN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The format to use when rendering the log level (default <code>%5p</code>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PID</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PID</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The current process ID (discovered if possible and when not already defined as an OS environment variable).</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If you&#8217;re using Logback, the following properties are also transferred:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Spring Environment</th>
<th class="tableblock halign-left valign-top">System Property</th>
<th class="tableblock halign-left valign-top">Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.logback.rollingpolicy.file-name-pattern</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOGBACK_ROLLINGPOLICY_FILE_NAME_PATTERN</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Pattern for rolled-over log file names (default <code>${LOG_FILE}.%d{yyyy-MM-dd}.%i.gz</code>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.logback.rollingpolicy.clean-history-on-start</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOGBACK_ROLLINGPOLICY_CLEAN_HISTORY_ON_START</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to clean the archive log files on startup.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.logback.rollingpolicy.max-file-size</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOGBACK_ROLLINGPOLICY_MAX_FILE_SIZE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum log file size.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.logback.rollingpolicy.total-size-cap</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOGBACK_ROLLINGPOLICY_TOTAL_SIZE_CAP</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Total size of log backups to be kept.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.logback.rollingpolicy.max-history</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LOGBACK_ROLLINGPOLICY_MAX_HISTORY</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of archive log files to keep.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>All the supported logging systems can consult System properties when parsing their configuration files.
See the default configurations in <code>spring-boot.jar</code> for examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot/src/main/resources/org/springframework/boot/logging/logback/defaults.xml">Logback</a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot/src/main/resources/org/springframework/boot/logging/log4j2/log4j2.xml">Log4j 2</a></p>
</li>
<li>
<p><a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot/src/main/resources/org/springframework/boot/logging/java/logging-file.properties">Java Util logging</a></p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you want to use a placeholder in a logging property, you should use <a href="#features.external-config.files.property-placeholders">Spring Boot&#8217;s syntax</a> and not the syntax of the underlying framework.
Notably, if you use Logback, you should use <code>:</code> as the delimiter between a property name and its default value and not use <code>:-</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can add MDC and other ad-hoc content to log lines by overriding only the <code>LOG_LEVEL_PATTERN</code> (or <code>logging.pattern.level</code> with Logback).
For example, if you use <code>logging.pattern.level=user:%X{user} %5p</code>, then the default log format contains an MDC entry for "user", if it exists, as shown in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>2019-08-30 12:30:04.031 user:someone INFO 22174 --- [  nio-8080-exec-0] demo.Controller
Handling authenticated request</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features.logging.logback-extensions"><a class="anchor" href="#features.logging.logback-extensions"></a>4.9. Logback Extensions</h3>
<div class="paragraph">
<p>Spring Boot includes a number of extensions to Logback that can help with advanced configuration.
You can use these extensions in your <code>logback-spring.xml</code> configuration file.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Because the standard <code>logback.xml</code> configuration file is loaded too early, you cannot use extensions in it.
You need to either use <code>logback-spring.xml</code> or define a <code>logging.config</code> property.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The extensions cannot be used with Logback&#8217;s <a href="https://logback.qos.ch/manual/configuration.html#autoScan">configuration scanning</a>.
If you attempt to do so, making changes to the configuration file results in an error similar to one of the following being logged:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>ERROR in <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="14777c3a657b673a787b737675777f3a777b66713a7e7b66757a3a67647d3a5d7a6071666466716071665420">[email&#160;protected]</a>:71 - no applicable action for [springProperty], current ElementPath is [[configuration][springProperty]]
ERROR in <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2043480e514f530e4c4f474241434b0e434f52450e4a4f52414e0e5350490e694e5445525052455445526014">[email&#160;protected]</a>:71 - no applicable action for [springProfile], current ElementPath is [[configuration][springProfile]]</pre>
</div>
</div>
<div class="sect3">
<h4 id="features.logging.logback-extensions.profile-specific"><a class="anchor" href="#features.logging.logback-extensions.profile-specific"></a>4.9.1. Profile-specific Configuration</h4>
<div class="paragraph">
<p>The <code>&lt;springProfile&gt;</code> tag lets you optionally include or exclude sections of configuration based on the active Spring profiles.
Profile sections are supported anywhere within the <code>&lt;configuration&gt;</code> element.
Use the <code>name</code> attribute to specify which profile accepts the configuration.
The <code>&lt;springProfile&gt;</code> tag can contain a profile name (for example <code>staging</code>) or a profile expression.
A profile expression allows for more complicated profile logic to be expressed, for example <code>production &amp; (eu-central | eu-west)</code>.
Check the <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/core.html#beans-definition-profiles-java">reference guide</a> for more details.
The following listing shows three sample profiles:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;springProfile name="staging"&gt;
    &lt;!-- configuration to be enabled when the "staging" profile is active --&gt;
&lt;/springProfile&gt;

&lt;springProfile name="dev | staging"&gt;
    &lt;!-- configuration to be enabled when the "dev" or "staging" profiles are active --&gt;
&lt;/springProfile&gt;

&lt;springProfile name="!production"&gt;
    &lt;!-- configuration to be enabled when the "production" profile is not active --&gt;
&lt;/springProfile&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.logging.logback-extensions.environment-properties"><a class="anchor" href="#features.logging.logback-extensions.environment-properties"></a>4.9.2. Environment Properties</h4>
<div class="paragraph">
<p>The <code>&lt;springProperty&gt;</code> tag lets you expose properties from the Spring <code>Environment</code> for use within Logback.
Doing so can be useful if you want to access values from your <code>application.properties</code> file in your Logback configuration.
The tag works in a similar way to Logback&#8217;s standard <code>&lt;property&gt;</code> tag.
However, rather than specifying a direct <code>value</code>, you specify the <code>source</code> of the property (from the <code>Environment</code>).
If you need to store the property somewhere other than in <code>local</code> scope, you can use the <code>scope</code> attribute.
If you need a fallback value (in case the property is not set in the <code>Environment</code>), you can use the <code>defaultValue</code> attribute.
The following example shows how to expose properties for use within Logback:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;springProperty scope="context" name="fluentHost" source="myapp.fluentd.host"
        defaultValue="localhost"/&gt;
&lt;appender name="FLUENT" class="ch.qos.logback.more.appenders.DataFluentAppender"&gt;
    &lt;remoteHost&gt;${fluentHost}&lt;/remoteHost&gt;
    ...
&lt;/appender&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>source</code> must be specified in kebab case (such as <code>my.property-name</code>).
However, properties can be added to the <code>Environment</code> by using the relaxed rules.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.internationalization"><a class="anchor" href="#features.internationalization"></a>5. Internationalization</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot supports localized messages so that your application can cater to users of different language preferences.
By default, Spring Boot looks for the presence of a <code>messages</code> resource bundle at the root of the classpath.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The auto-configuration applies when the default properties file for the configured resource bundle is available (i.e. <code>messages.properties</code> by default).
If your resource bundle contains only language-specific properties files, you are required to add the default.
If no properties file is found that matches any of the configured base names, there will be no auto-configured <code>MessageSource</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The basename of the resource bundle as well as several other attributes can be configured using the <code>spring.messages</code> namespace, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.messages.basename=messages,config.i18n.messages
spring.messages.fallback-to-system-locale=false</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  messages:
    basename: "messages,config.i18n.messages"
    fallback-to-system-locale: false</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>spring.messages.basename</code> supports comma-separated list of locations, either a package qualifier or a resource resolved from the classpath root.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/context/MessageSourceProperties.java"><code>MessageSourceProperties</code></a> for more supported options.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.json"><a class="anchor" href="#features.json"></a>6. JSON</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot provides integration with three JSON mapping libraries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Gson</p>
</li>
<li>
<p>Jackson</p>
</li>
<li>
<p>JSON-B</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Jackson is the preferred and default library.</p>
</div>
<div class="sect2">
<h3 id="features.json.jackson"><a class="anchor" href="#features.json.jackson"></a>6.1. Jackson</h3>
<div class="paragraph">
<p>Auto-configuration for Jackson is provided and Jackson is part of <code>spring-boot-starter-json</code>.
When Jackson is on the classpath an <code>ObjectMapper</code> bean is automatically configured.
Several configuration properties are provided for <a href="howto.html#howto.spring-mvc.customize-jackson-objectmapper">customizing the configuration of the <code>ObjectMapper</code></a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.json.gson"><a class="anchor" href="#features.json.gson"></a>6.2. Gson</h3>
<div class="paragraph">
<p>Auto-configuration for Gson is provided.
When Gson is on the classpath a <code>Gson</code> bean is automatically configured.
Several <code>spring.gson.*</code> configuration properties are provided for customizing the configuration.
To take more control, one or more <code>GsonBuilderCustomizer</code> beans can be used.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.json.json-b"><a class="anchor" href="#features.json.json-b"></a>6.3. JSON-B</h3>
<div class="paragraph">
<p>Auto-configuration for JSON-B is provided.
When the JSON-B API and an implementation are on the classpath a <code>Jsonb</code> bean will be automatically configured.
The preferred JSON-B implementation is Apache Johnzon for which dependency management is provided.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.developing-web-applications"><a class="anchor" href="#features.developing-web-applications"></a>7. Developing Web Applications</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot is well suited for web application development.
You can create a self-contained HTTP server by using embedded Tomcat, Jetty, Undertow, or Netty.
Most web applications use the <code>spring-boot-starter-web</code> module to get up and running quickly.
You can also choose to build reactive web applications by using the <code>spring-boot-starter-webflux</code> module.</p>
</div>
<div class="paragraph">
<p>If you have not yet developed a Spring Boot web application, you can follow the "Hello World!" example in the <em><a href="getting-started.html#getting-started.first-application">Getting started</a></em> section.</p>
</div>
<div class="sect2">
<h3 id="features.developing-web-applications.spring-mvc"><a class="anchor" href="#features.developing-web-applications.spring-mvc"></a>7.1. The &#8220;Spring Web MVC Framework&#8221;</h3>
<div class="paragraph">
<p>The <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/web.html#mvc">Spring Web MVC framework</a> (often referred to as &#8220;Spring MVC&#8221;) is a rich &#8220;model view controller&#8221; web framework.
Spring MVC lets you create special <code>@Controller</code> or <code>@RestController</code> beans to handle incoming HTTP requests.
Methods in your controller are mapped to HTTP by using <code>@RequestMapping</code> annotations.</p>
</div>
<div class="paragraph">
<p>The following code shows a typical <code>@RestController</code> that serves JSON data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.util.List;

import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

</span><span class="fold-block">@RestController
@RequestMapping("/users")
public class MyRestController {

    private final UserRepository userRepository;

    private final CustomerRepository customerRepository;

    public MyRestController(UserRepository userRepository, CustomerRepository customerRepository) {
        this.userRepository = userRepository;
        this.customerRepository = customerRepository;
    }

    @GetMapping("/{user}")
    public User getUser(@PathVariable Long userId) {
        return this.userRepository.findById(userId).get();
    }

    @GetMapping("/{user}/customers")
    public List&lt;Customer&gt; getUserCustomers(@PathVariable Long userId) {
        return this.userRepository.findById(userId).map(this.customerRepository::findByUser).get();
    }

    @DeleteMapping("/{user}")
    public void deleteUser(@PathVariable Long userId) {
        this.userRepository.deleteById(userId);
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Spring MVC is part of the core Spring Framework, and detailed information is available in the <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/web.html#mvc">reference documentation</a>.
There are also several guides that cover Spring MVC available at <a href="https://spring.io/guides" class="bare">spring.io/guides</a>.</p>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.spring-mvc.auto-configuration"><a class="anchor" href="#features.developing-web-applications.spring-mvc.auto-configuration"></a>7.1.1. Spring MVC Auto-configuration</h4>
<div class="paragraph">
<p>Spring Boot provides auto-configuration for Spring MVC that works well with most applications.</p>
</div>
<div class="paragraph">
<p>The auto-configuration adds the following features on top of Spring&#8217;s defaults:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Inclusion of <code>ContentNegotiatingViewResolver</code> and <code>BeanNameViewResolver</code> beans.</p>
</li>
<li>
<p>Support for serving static resources, including support for WebJars (covered <a href="#features.developing-web-applications.spring-mvc.static-content">later in this document</a>).</p>
</li>
<li>
<p>Automatic registration of <code>Converter</code>, <code>GenericConverter</code>, and <code>Formatter</code> beans.</p>
</li>
<li>
<p>Support for <code>HttpMessageConverters</code> (covered <a href="#features.developing-web-applications.spring-mvc.message-converters">later in this document</a>).</p>
</li>
<li>
<p>Automatic registration of <code>MessageCodesResolver</code> (covered <a href="#features.developing-web-applications.spring-mvc.message-codes">later in this document</a>).</p>
</li>
<li>
<p>Static <code>index.html</code> support.</p>
</li>
<li>
<p>Automatic use of a <code>ConfigurableWebBindingInitializer</code> bean (covered <a href="#features.developing-web-applications.spring-mvc.binding-initializer">later in this document</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you want to keep those Spring Boot MVC customizations and make more <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/web.html#mvc">MVC customizations</a> (interceptors, formatters, view controllers, and other features), you can add your own <code>@Configuration</code> class of type <code>WebMvcConfigurer</code> but <strong>without</strong> <code>@EnableWebMvc</code>.</p>
</div>
<div class="paragraph">
<p>If you want to provide custom instances of <code>RequestMappingHandlerMapping</code>, <code>RequestMappingHandlerAdapter</code>, or <code>ExceptionHandlerExceptionResolver</code>, and still keep the Spring Boot MVC customizations, you can declare a bean of type <code>WebMvcRegistrations</code> and use it to provide custom instances of those components.</p>
</div>
<div class="paragraph">
<p>If you want to take complete control of Spring MVC, you can add your own <code>@Configuration</code> annotated with <code>@EnableWebMvc</code>, or alternatively add your own <code>@Configuration</code>-annotated <code>DelegatingWebMvcConfiguration</code> as described in the Javadoc of <code>@EnableWebMvc</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Spring MVC uses a different <code>ConversionService</code> to the one used to convert values from your <code>application.properties</code> or <code>application.yaml</code> file.
It means that <code>Period</code>, <code>Duration</code> and <code>DataSize</code> converters are not available and that <code>@DurationUnit</code> and <code>@DataSizeUnit</code> annotations will be ignored.</p>
</div>
<div class="paragraph">
<p>If you want to customize the <code>ConversionService</code> used by Spring MVC, you can provide a <code>WebMvcConfigurer</code> bean with an <code>addFormatters</code> method.
From this method you can register any converter that you like, or you can delegate to the static methods available on <code>ApplicationConversionService</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.spring-mvc.message-converters"><a class="anchor" href="#features.developing-web-applications.spring-mvc.message-converters"></a>7.1.2. HttpMessageConverters</h4>
<div class="paragraph">
<p>Spring MVC uses the <code>HttpMessageConverter</code> interface to convert HTTP requests and responses.
Sensible defaults are included out of the box.
For example, objects can be automatically converted to JSON (by using the Jackson library) or XML (by using the Jackson XML extension, if available, or by using JAXB if the Jackson XML extension is not available).
By default, strings are encoded in <code>UTF-8</code>.</p>
</div>
<div class="paragraph">
<p>If you need to add or customize converters, you can use Spring Boot&#8217;s <code>HttpMessageConverters</code> class, as shown in the following listing:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.autoconfigure.http.HttpMessageConverters;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.http.converter.HttpMessageConverter;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyHttpMessageConvertersConfiguration {

    @Bean
    public HttpMessageConverters customConverters() {
        HttpMessageConverter&lt;?&gt; additional = new AdditionalHttpMessageConverter();
        HttpMessageConverter&lt;?&gt; another = new AnotherHttpMessageConverter();
        return new HttpMessageConverters(additional, another);
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Any <code>HttpMessageConverter</code> bean that is present in the context is added to the list of converters.
You can also override default converters in the same way.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.spring-mvc.json"><a class="anchor" href="#features.developing-web-applications.spring-mvc.json"></a>7.1.3. Custom JSON Serializers and Deserializers</h4>
<div class="paragraph">
<p>If you use Jackson to serialize and deserialize JSON data, you might want to write your own <code>JsonSerializer</code> and <code>JsonDeserializer</code> classes.
Custom serializers are usually <a href="https://github.com/FasterXML/jackson-docs/wiki/JacksonHowToCustomSerializers">registered with Jackson through a module</a>, but Spring Boot provides an alternative <code>@JsonComponent</code> annotation that makes it easier to directly register Spring Beans.</p>
</div>
<div class="paragraph">
<p>You can use the <code>@JsonComponent</code> annotation directly on <code>JsonSerializer</code>, <code>JsonDeserializer</code> or <code>KeyDeserializer</code> implementations.
You can also use it on classes that contain serializers/deserializers as inner classes, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.io.IOException;

import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.core.JsonParser;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.core.ObjectCodec;
import com.fasterxml.jackson.databind.DeserializationContext;
import com.fasterxml.jackson.databind.JsonDeserializer;
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.JsonSerializer;
import com.fasterxml.jackson.databind.SerializerProvider;

import org.springframework.boot.jackson.JsonComponent;

</span><span class="fold-block">@JsonComponent
public class MyJsonComponent {

    public static class Serializer extends JsonSerializer&lt;MyObject&gt; {

        @Override
        public void serialize(MyObject value, JsonGenerator jgen, SerializerProvider serializers) throws IOException {
            jgen.writeStringField("name", value.getName());
            jgen.writeNumberField("age", value.getAge());
        }

    }

    public static class Deserializer extends JsonDeserializer&lt;MyObject&gt; {

        @Override
        public MyObject deserialize(JsonParser jsonParser, DeserializationContext ctxt)
                throws IOException, JsonProcessingException {
            ObjectCodec codec = jsonParser.getCodec();
            JsonNode tree = codec.readTree(jsonParser);
            String name = tree.get("name").textValue();
            int age = tree.get("age").intValue();
            return new MyObject(name, age);
        }

    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>All <code>@JsonComponent</code> beans in the <code>ApplicationContext</code> are automatically registered with Jackson.
Because <code>@JsonComponent</code> is meta-annotated with <code>@Component</code>, the usual component-scanning rules apply.</p>
</div>
<div class="paragraph">
<p>Spring Boot also provides <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/jackson/JsonObjectSerializer.java"><code>JsonObjectSerializer</code></a> and <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/jackson/JsonObjectDeserializer.java"><code>JsonObjectDeserializer</code></a> base classes that provide useful alternatives to the standard Jackson versions when serializing objects.
See <a href="https://docs.spring.io/spring-boot/docs/2.5.3/api/org/springframework/boot/jackson/JsonObjectSerializer.html"><code>JsonObjectSerializer</code></a> and <a href="https://docs.spring.io/spring-boot/docs/2.5.3/api/org/springframework/boot/jackson/JsonObjectDeserializer.html"><code>JsonObjectDeserializer</code></a> in the Javadoc for details.</p>
</div>
<div class="paragraph">
<p>The example above can be rewritten to use <code>JsonObjectSerializer</code>/<code>JsonObjectDeserializer</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.io.IOException;

import com.fasterxml.jackson.core.JsonGenerator;
import com.fasterxml.jackson.core.JsonParser;
import com.fasterxml.jackson.core.ObjectCodec;
import com.fasterxml.jackson.databind.DeserializationContext;
import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.SerializerProvider;

import org.springframework.boot.jackson.JsonComponent;
import org.springframework.boot.jackson.JsonObjectDeserializer;
import org.springframework.boot.jackson.JsonObjectSerializer;

</span><span class="fold-block">@JsonComponent
public class MyJsonComponent {

    public static class Serializer extends JsonObjectSerializer&lt;MyObject&gt; {

        @Override
        protected void serializeObject(MyObject value, JsonGenerator jgen, SerializerProvider provider)
                throws IOException {
            jgen.writeStringField("name", value.getName());
            jgen.writeNumberField("age", value.getAge());
        }

    }

    public static class Deserializer extends JsonObjectDeserializer&lt;MyObject&gt; {

        @Override
        protected MyObject deserializeObject(JsonParser jsonParser, DeserializationContext context, ObjectCodec codec,
                JsonNode tree) throws IOException {
            String name = nullSafeValue(tree.get("name"), String.class);
            int age = nullSafeValue(tree.get("age"), Integer.class);
            return new MyObject(name, age);
        }

    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.spring-mvc.message-codes"><a class="anchor" href="#features.developing-web-applications.spring-mvc.message-codes"></a>7.1.4. MessageCodesResolver</h4>
<div class="paragraph">
<p>Spring MVC has a strategy for generating error codes for rendering error messages from binding errors: <code>MessageCodesResolver</code>.
If you set the <code>spring.mvc.message-codes-resolver-format</code> property <code>PREFIX_ERROR_CODE</code> or <code>POSTFIX_ERROR_CODE</code>, Spring Boot creates one for you (see the enumeration in <a href="https://docs.spring.io/spring-framework/docs/5.3.9/javadoc-api/org/springframework/validation/DefaultMessageCodesResolver.Format.html"><code>DefaultMessageCodesResolver.Format</code></a>).</p>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.spring-mvc.static-content"><a class="anchor" href="#features.developing-web-applications.spring-mvc.static-content"></a>7.1.5. Static Content</h4>
<div class="paragraph">
<p>By default, Spring Boot serves static content from a directory called <code>/static</code> (or <code>/public</code> or <code>/resources</code> or <code>/META-INF/resources</code>) in the classpath or from the root of the <code>ServletContext</code>.
It uses the <code>ResourceHttpRequestHandler</code> from Spring MVC so that you can modify that behavior by adding your own <code>WebMvcConfigurer</code> and overriding the <code>addResourceHandlers</code> method.</p>
</div>
<div class="paragraph">
<p>In a stand-alone web application, the default servlet from the container is also enabled and acts as a fallback, serving content from the root of the <code>ServletContext</code> if Spring decides not to handle it.
Most of the time, this does not happen (unless you modify the default MVC configuration), because Spring can always handle requests through the <code>DispatcherServlet</code>.</p>
</div>
<div class="paragraph">
<p>By default, resources are mapped on <code>/**</code>, but you can tune that with the <code>spring.mvc.static-path-pattern</code> property.
For instance, relocating all resources to <code>/resources/**</code> can be achieved as follows:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.mvc.static-path-pattern=/resources/**</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  mvc:
    static-path-pattern: "/resources/**"</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also customize the static resource locations by using the <code>spring.web.resources.static-locations</code> property (replacing the default values with a list of directory locations).
The root Servlet context path, <code>"/"</code>, is automatically added as a location as well.</p>
</div>
<div class="paragraph">
<p>In addition to the &#8220;standard&#8221; static resource locations mentioned earlier, a special case is made for <a href="https://www.webjars.org/">Webjars content</a>.
Any resources with a path in <code>/webjars/**</code> are served from jar files if they are packaged in the Webjars format.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Do not use the <code>src/main/webapp</code> directory if your application is packaged as a jar.
Although this directory is a common standard, it works <strong>only</strong> with war packaging, and it is silently ignored by most build tools if you generate a jar.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Spring Boot also supports the advanced resource handling features provided by Spring MVC, allowing use cases such as cache-busting static resources or using version agnostic URLs for Webjars.</p>
</div>
<div class="paragraph">
<p>To use version agnostic URLs for Webjars, add the <code>webjars-locator-core</code> dependency.
Then declare your Webjar.
Using jQuery as an example, adding <code>"/webjars/jquery/jquery.min.js"</code> results in <code>"/webjars/jquery/x.y.z/jquery.min.js"</code> where <code>x.y.z</code> is the Webjar version.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you use JBoss, you need to declare the <code>webjars-locator-jboss-vfs</code> dependency instead of the <code>webjars-locator-core</code>.
Otherwise, all Webjars resolve as a <code>404</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To use cache busting, the following configuration configures a cache busting solution for all static resources, effectively adding a content hash, such as <code>&lt;link href="/css/spring-2a2d595e6ed9a0b24f027f2b63b134d6.css"/&gt;</code>, in URLs:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.web.resources.chain.strategy.content.enabled=true
spring.web.resources.chain.strategy.content.paths=/**</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  web:
    resources:
      chain:
        strategy:
          content:
            enabled: true
            paths: "/**"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Links to resources are rewritten in templates at runtime, thanks to a <code>ResourceUrlEncodingFilter</code> that is auto-configured for Thymeleaf and FreeMarker.
You should manually declare this filter when using JSPs.
Other template engines are currently not automatically supported but can be with custom template macros/helpers and the use of the <a href="https://docs.spring.io/spring-framework/docs/5.3.9/javadoc-api/org/springframework/web/servlet/resource/ResourceUrlProvider.html"><code>ResourceUrlProvider</code></a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When loading resources dynamically with, for example, a JavaScript module loader, renaming files is not an option.
That is why other strategies are also supported and can be combined.
A "fixed" strategy adds a static version string in the URL without changing the file name, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.web.resources.chain.strategy.content.enabled=true
spring.web.resources.chain.strategy.content.paths=/**
spring.web.resources.chain.strategy.fixed.enabled=true
spring.web.resources.chain.strategy.fixed.paths=/js/lib/
spring.web.resources.chain.strategy.fixed.version=v12</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  web:
    resources:
      chain:
        strategy:
          content:
            enabled: true
            paths: "/**"
          fixed:
            enabled: true
            paths: "/js/lib/"
            version: "v12"</code></pre>
</div>
</div>
<div class="paragraph">
<p>With this configuration, JavaScript modules located under <code>"/js/lib/"</code> use a fixed versioning strategy (<code>"/v12/js/lib/mymodule.js"</code>), while other resources still use the content one (<code>&lt;link href="/css/spring-2a2d595e6ed9a0b24f027f2b63b134d6.css"/&gt;</code>).</p>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/ResourceProperties.java"><code>ResourceProperties</code></a> for more supported options.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This feature has been thoroughly described in a dedicated <a href="https://spring.io/blog/2014/07/24/spring-framework-4-1-handling-static-web-resources">blog post</a> and in Spring Framework&#8217;s <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/web.html#mvc-config-static-resources">reference documentation</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.spring-mvc.welcome-page"><a class="anchor" href="#features.developing-web-applications.spring-mvc.welcome-page"></a>7.1.6. Welcome Page</h4>
<div class="paragraph">
<p>Spring Boot supports both static and templated welcome pages.
It first looks for an <code>index.html</code> file in the configured static content locations.
If one is not found, it then looks for an <code>index</code> template.
If either is found, it is automatically used as the welcome page of the application.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.spring-mvc.content-negotiation"><a class="anchor" href="#features.developing-web-applications.spring-mvc.content-negotiation"></a>7.1.7. Path Matching and Content Negotiation</h4>
<div class="paragraph">
<p>Spring MVC can map incoming HTTP requests to handlers by looking at the request path and matching it to the mappings defined in your application (for example, <code>@GetMapping</code> annotations on Controller methods).</p>
</div>
<div class="paragraph">
<p>Spring Boot chooses to disable suffix pattern matching by default, which means that requests like <code>"GET /projects/spring-boot.json"</code> won&#8217;t be matched to <code>@GetMapping("/projects/spring-boot")</code> mappings.
This is considered as a <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/web.html#mvc-ann-requestmapping-suffix-pattern-match">best practice for Spring MVC applications</a>.
This feature was mainly useful in the past for HTTP clients which did not send proper "Accept" request headers; we needed to make sure to send the correct Content Type to the client.
Nowadays, Content Negotiation is much more reliable.</p>
</div>
<div class="paragraph">
<p>There are other ways to deal with HTTP clients that don&#8217;t consistently send proper "Accept" request headers.
Instead of using suffix matching, we can use a query parameter to ensure that requests like <code>"GET /projects/spring-boot?format=json"</code> will be mapped to <code>@GetMapping("/projects/spring-boot")</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.mvc.contentnegotiation.favor-parameter=true</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  mvc:
    contentnegotiation:
      favor-parameter: true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or if you prefer to use a different parameter name:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.mvc.contentnegotiation.favor-parameter=true
spring.mvc.contentnegotiation.parameter-name=myparam</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  mvc:
    contentnegotiation:
      favor-parameter: true
      parameter-name: "myparam"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Most standard media types are supported out-of-the-box, but you can also define new ones:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.mvc.contentnegotiation.media-types.markdown=text/markdown</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  mvc:
    contentnegotiation:
      media-types:
        markdown: "text/markdown"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Suffix pattern matching is deprecated and will be removed in a future release.
If you understand the caveats and would still like your application to use suffix pattern matching, the following configuration is required:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.mvc.contentnegotiation.favor-path-extension=true
spring.mvc.pathmatch.use-suffix-pattern=true</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  mvc:
    contentnegotiation:
      favor-path-extension: true
    pathmatch:
      use-suffix-pattern: true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, rather than open all suffix patterns, it&#8217;s more secure to only support registered suffix patterns:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.mvc.contentnegotiation.favor-path-extension=true
spring.mvc.pathmatch.use-registered-suffix-pattern=true</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  mvc:
    contentnegotiation:
      favor-path-extension: true
    pathmatch:
      use-registered-suffix-pattern: true</code></pre>
</div>
</div>
<div class="paragraph">
<p>As of Spring Framework 5.3, Spring MVC supports several implementation strategies for matching request paths to Controller handlers.
It was previously only supporting the <code>AntPathMatcher</code> strategy, but it now also offers <code>PathPatternParser</code>.
Spring Boot now provides a configuration property to choose and opt in the new strategy:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.mvc.pathmatch.matching-strategy=path-pattern-parser</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  mvc:
    pathmatch:
      matching-strategy: "path-pattern-parser"</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more details on why you should consider this new implementation, please check out the
<a href="https://spring.io/blog/2020/06/30/url-matching-with-pathpattern-in-spring-mvc">dedicated blog post</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>PathPatternParser</code> is an optimized implementation but restricts usage of
<a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/web.html#mvc-ann-requestmapping-uri-templates">some path patterns variants</a>
and is incompatible with suffix pattern matching (<code>spring.mvc.pathmatch.use-suffix-pattern</code>,
<code>spring.mvc.pathmatch.use-registered-suffix-pattern</code>) or mapping the <code>DispatcherServlet</code>
with a Servlet prefix (<code>spring.mvc.servlet.path</code>).
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.spring-mvc.binding-initializer"><a class="anchor" href="#features.developing-web-applications.spring-mvc.binding-initializer"></a>7.1.8. ConfigurableWebBindingInitializer</h4>
<div class="paragraph">
<p>Spring MVC uses a <code>WebBindingInitializer</code> to initialize a <code>WebDataBinder</code> for a particular request.
If you create your own <code>ConfigurableWebBindingInitializer</code> <code>@Bean</code>, Spring Boot automatically configures Spring MVC to use it.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.spring-mvc.template-engines"><a class="anchor" href="#features.developing-web-applications.spring-mvc.template-engines"></a>7.1.9. Template Engines</h4>
<div class="paragraph">
<p>As well as REST web services, you can also use Spring MVC to serve dynamic HTML content.
Spring MVC supports a variety of templating technologies, including Thymeleaf, FreeMarker, and JSPs.
Also, many other templating engines include their own Spring MVC integrations.</p>
</div>
<div class="paragraph">
<p>Spring Boot includes auto-configuration support for the following templating engines:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://freemarker.apache.org/docs/">FreeMarker</a></p>
</li>
<li>
<p><a href="https://docs.groovy-lang.org/docs/next/html/documentation/template-engines.html#_the_markuptemplateengine">Groovy</a></p>
</li>
<li>
<p><a href="https://www.thymeleaf.org">Thymeleaf</a></p>
</li>
<li>
<p><a href="https://mustache.github.io/">Mustache</a></p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If possible, JSPs should be avoided.
There are several <a href="#features.developing-web-applications.embedded-container.jsp-limitations">known limitations</a> when using them with embedded servlet containers.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you use one of these templating engines with the default configuration, your templates are picked up automatically from <code>src/main/resources/templates</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Depending on how you run your application, your IDE may order the classpath differently.
Running your application in the IDE from its main method results in a different ordering than when you run your application by using Maven or Gradle or from its packaged jar.
This can cause Spring Boot to fail to find the expected template.
If you have this problem, you can reorder the classpath in the IDE to place the module&#8217;s classes and resources first.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.spring-mvc.error-handling"><a class="anchor" href="#features.developing-web-applications.spring-mvc.error-handling"></a>7.1.10. Error Handling</h4>
<div class="paragraph">
<p>By default, Spring Boot provides an <code>/error</code> mapping that handles all errors in a sensible way, and it is registered as a &#8220;global&#8221; error page in the servlet container.
For machine clients, it produces a JSON response with details of the error, the HTTP status, and the exception message.
For browser clients, there is a &#8220;whitelabel&#8221; error view that renders the same data in HTML format (to customize it, add a <code>View</code> that resolves to <code>error</code>).</p>
</div>
<div class="paragraph">
<p>There are a number of <code>server.error</code> properties that can be set if you want to customize the default error handling behavior.
See the <a href="application-properties.html#application-properties.server">&#8220;Server Properties&#8221;</a> section of the Appendix.</p>
</div>
<div class="paragraph">
<p>To replace the default behavior completely, you can implement <code>ErrorController</code> and register a bean definition of that type or add a bean of type <code>ErrorAttributes</code> to use the existing mechanism but replace the contents.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The <code>BasicErrorController</code> can be used as a base class for a custom <code>ErrorController</code>.
This is particularly useful if you want to add a handler for a new content type (the default is to handle <code>text/html</code> specifically and provide a fallback for everything else).
To do so, extend <code>BasicErrorController</code>, add a public method with a <code>@RequestMapping</code> that has a <code>produces</code> attribute, and create a bean of your new type.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can also define a class annotated with <code>@ControllerAdvice</code> to customize the JSON document to return for a particular controller and/or exception type, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import javax.servlet.RequestDispatcher;
import javax.servlet.http.HttpServletRequest;

import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.web.bind.annotation.ControllerAdvice;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.servlet.mvc.method.annotation.ResponseEntityExceptionHandler;

</span><span class="fold-block">@ControllerAdvice(basePackageClasses = SomeController.class)
public class MyControllerAdvice extends ResponseEntityExceptionHandler {

    @ResponseBody
    @ExceptionHandler(MyException.class)
    public ResponseEntity&lt;?&gt; handleControllerException(HttpServletRequest request, Throwable ex) {
        HttpStatus status = getStatus(request);
        return new ResponseEntity&lt;&gt;(new MyErrorBody(status.value(), ex.getMessage()), status);
    }

    private HttpStatus getStatus(HttpServletRequest request) {
        Integer code = (Integer) request.getAttribute(RequestDispatcher.ERROR_STATUS_CODE);
        HttpStatus status = HttpStatus.resolve(code);
        return (status != null) ? status : HttpStatus.INTERNAL_SERVER_ERROR;
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the preceding example, if <code>YourException</code> is thrown by a controller defined in the same package as <code>SomeController</code>, a JSON representation of the <code>CustomErrorType</code> POJO is used instead of the <code>ErrorAttributes</code> representation.</p>
</div>
<div class="paragraph">
<p>In some cases, errors handled at the controller level are not recorded by the <a href="actuator.html#actuator.metrics.supported.spring-mvc">metrics infrastructure</a>.
Applications can ensure that such exceptions are recorded with the request metrics by setting the handled exception as a request attribute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import javax.servlet.http.HttpServletRequest;

import org.springframework.boot.web.servlet.error.ErrorAttributes;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.ExceptionHandler;

</span><span class="fold-block">@Controller
public class MyController {

    @ExceptionHandler(CustomException.class)
    String handleCustomException(HttpServletRequest request, CustomException ex) {
        request.setAttribute(ErrorAttributes.ERROR_ATTRIBUTE, ex);
        return "errorView";
    }

}
</span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="features.developing-web-applications.spring-mvc.error-handling.error-pages"><a class="anchor" href="#features.developing-web-applications.spring-mvc.error-handling.error-pages"></a>Custom Error Pages</h5>
<div class="paragraph">
<p>If you want to display a custom HTML error page for a given status code, you can add a file to an <code>/error</code> directory.
Error pages can either be static HTML (that is, added under any of the static resource directories) or be built by using templates.
The name of the file should be the exact status code or a series mask.</p>
</div>
<div class="paragraph">
<p>For example, to map <code>404</code> to a static HTML file, your directory structure would be as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>src/
 +- main/
     +- java/
     |   + &lt;source code&gt;
     +- resources/
         +- public/
             +- error/
             |   +- 404.html
             +- &lt;other public assets&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>To map all <code>5xx</code> errors by using a FreeMarker template, your directory structure would be as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>src/
 +- main/
     +- java/
     |   + &lt;source code&gt;
     +- resources/
         +- templates/
             +- error/
             |   +- 5xx.ftlh
             +- &lt;other templates&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>For more complex mappings, you can also add beans that implement the <code>ErrorViewResolver</code> interface, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.util.Map;

import javax.servlet.http.HttpServletRequest;

import org.springframework.boot.autoconfigure.web.servlet.error.ErrorViewResolver;
import org.springframework.http.HttpStatus;
import org.springframework.web.servlet.ModelAndView;

</span><span class="fold-block">public class MyErrorViewResolver implements ErrorViewResolver {

    @Override
    public ModelAndView resolveErrorView(HttpServletRequest request, HttpStatus status, Map&lt;String, Object&gt; model) {
        // Use the request or status to optionally return a ModelAndView
        if (status == HttpStatus.INSUFFICIENT_STORAGE) {
            // We could add custom model values here
            new ModelAndView("myview");
        }
        return null;
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also use regular Spring MVC features such as <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/web.html#mvc-exceptionhandlers"><code>@ExceptionHandler</code> methods</a> and <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/web.html#mvc-ann-controller-advice"><code>@ControllerAdvice</code></a>.
The <code>ErrorController</code> then picks up any unhandled exceptions.</p>
</div>
</div>
<div class="sect4">
<h5 id="features.developing-web-applications.spring-mvc.error-handling.error-pages-without-spring-mvc"><a class="anchor" href="#features.developing-web-applications.spring-mvc.error-handling.error-pages-without-spring-mvc"></a>Mapping Error Pages outside of Spring MVC</h5>
<div class="paragraph">
<p>For applications that do not use Spring MVC, you can use the <code>ErrorPageRegistrar</code> interface to directly register <code>ErrorPages</code>.
This abstraction works directly with the underlying embedded servlet container and works even if you do not have a Spring MVC <code>DispatcherServlet</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.web.server.ErrorPage;
import org.springframework.boot.web.server.ErrorPageRegistrar;
import org.springframework.boot.web.server.ErrorPageRegistry;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.http.HttpStatus;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyErrorPagesConfiguration {

    @Bean
    public ErrorPageRegistrar errorPageRegistrar() {
        return this::registerErrorPages;
    }

    private void registerErrorPages(ErrorPageRegistry registry) {
        registry.addErrorPages(new ErrorPage(HttpStatus.BAD_REQUEST, "/400"));
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you register an <code>ErrorPage</code> with a path that ends up being handled by a <code>Filter</code> (as is common with some non-Spring web frameworks, like Jersey and Wicket), then the <code>Filter</code> has to be explicitly registered as an <code>ERROR</code> dispatcher, as shown in the following example:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.util.EnumSet;

import javax.servlet.DispatcherType;

import org.springframework.boot.web.servlet.FilterRegistrationBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyFilterConfiguration {

    @Bean
    public FilterRegistrationBean&lt;MyFilter&gt; myFilter() {
        FilterRegistrationBean&lt;MyFilter&gt; registration = new FilterRegistrationBean&lt;&gt;(new MyFilter());
        // ...
        registration.setDispatcherTypes(EnumSet.allOf(DispatcherType.class));
        return registration;
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the default <code>FilterRegistrationBean</code> does not include the <code>ERROR</code> dispatcher type.</p>
</div>
</div>
<div class="sect4">
<h5 id="features.developing-web-applications.spring-mvc.error-handling.in-a-war-deployment"><a class="anchor" href="#features.developing-web-applications.spring-mvc.error-handling.in-a-war-deployment"></a>Error handling in a war deployment</h5>
<div class="paragraph">
<p>When deployed to a servlet container, Spring Boot uses its error page filter to forward a request with an error status to the appropriate error page.
This is necessary as the Servlet specification does not provide an API for registering error pages.
Depending on the container that you are deploying your war file to and the technologies that your application uses, some additional configuration may be required.</p>
</div>
<div class="paragraph">
<p>The error page filter can only forward the request to the correct error page if the response has not already been committed.
By default, WebSphere Application Server 8.0 and later commits the response upon successful completion of a servlet&#8217;s service method.
You should disable this behavior by setting <code>com.ibm.ws.webcontainer.invokeFlushAfterService</code> to <code>false</code>.</p>
</div>
<div class="paragraph">
<p>If you are using Spring Security and want to access the principal in an error page, you must configure Spring Security&#8217;s filter to be invoked on error dispatches.
To do so, set the <code>spring.security.filter.dispatcher-types</code> property to <code>async, error, forward, request</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.spring-mvc.spring-hateoas"><a class="anchor" href="#features.developing-web-applications.spring-mvc.spring-hateoas"></a>7.1.11. Spring HATEOAS</h4>
<div class="paragraph">
<p>If you develop a RESTful API that makes use of hypermedia, Spring Boot provides auto-configuration for Spring HATEOAS that works well with most applications.
The auto-configuration replaces the need to use <code>@EnableHypermediaSupport</code> and registers a number of beans to ease building hypermedia-based applications, including a <code>LinkDiscoverers</code> (for client side support) and an <code>ObjectMapper</code> configured to correctly marshal responses into the desired representation.
The <code>ObjectMapper</code> is customized by setting the various <code>spring.jackson.*</code> properties or, if one exists, by a <code>Jackson2ObjectMapperBuilder</code> bean.</p>
</div>
<div class="paragraph">
<p>You can take control of Spring HATEOAS&#8217;s configuration by using <code>@EnableHypermediaSupport</code>.
Note that doing so disables the <code>ObjectMapper</code> customization described earlier.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<code>spring-boot-starter-hateoas</code> is specific to Spring MVC and should not be combined with Spring WebFlux.
In order to use Spring HATEOAS with Spring WebFlux, you can add a direct dependency on <code>org.springframework.hateoas:spring-hateoas</code> along with <code>spring-boot-starter-webflux</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.spring-mvc.cors"><a class="anchor" href="#features.developing-web-applications.spring-mvc.cors"></a>7.1.12. CORS Support</h4>
<div class="paragraph">
<p><a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing">Cross-origin resource sharing</a> (CORS) is a <a href="https://www.w3.org/TR/cors/">W3C specification</a> implemented by <a href="https://caniuse.com/#feat=cors">most browsers</a> that lets you specify in a flexible way what kind of cross-domain requests are authorized., instead of using some less secure and less powerful approaches such as IFRAME or JSONP.</p>
</div>
<div class="paragraph">
<p>As of version 4.2, Spring MVC <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/web.html#mvc-cors">supports CORS</a>.
Using <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/web.html#mvc-cors-controller">controller method CORS configuration</a> with <a href="https://docs.spring.io/spring-framework/docs/5.3.9/javadoc-api/org/springframework/web/bind/annotation/CrossOrigin.html"><code>@CrossOrigin</code></a> annotations in your Spring Boot application does not require any specific configuration.
<a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/web.html#mvc-cors-global">Global CORS configuration</a> can be defined by registering a <code>WebMvcConfigurer</code> bean with a customized <code>addCorsMappings(CorsRegistry)</code> method, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.CorsRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyCorsConfiguration {

    @Bean
    public WebMvcConfigurer corsConfigurer() {
        return new WebMvcConfigurer() {

            @Override
            public void addCorsMappings(CorsRegistry registry) {
                registry.addMapping("/api/**");
            }

        };
    }

}
</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.developing-web-applications.spring-webflux"><a class="anchor" href="#features.developing-web-applications.spring-webflux"></a>7.2. The &#8220;Spring WebFlux Framework&#8221;</h3>
<div class="paragraph">
<p>Spring WebFlux is the new reactive web framework introduced in Spring Framework 5.0.
Unlike Spring MVC, it does not require the Servlet API, is fully asynchronous and non-blocking, and implements the <a href="https://www.reactive-streams.org/">Reactive Streams</a> specification through <a href="https://projectreactor.io/">the Reactor project</a>.</p>
</div>
<div class="paragraph">
<p>Spring WebFlux comes in two flavors: functional and annotation-based.
The annotation-based one is quite close to the Spring MVC model, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import reactor.core.publisher.Flux;
import reactor.core.publisher.Mono;

import org.springframework.web.bind.annotation.DeleteMapping;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

</span><span class="fold-block">@RestController
@RequestMapping("/users")
public class MyRestController {

    private final UserRepository userRepository;

    private final CustomerRepository customerRepository;

    public MyRestController(UserRepository userRepository, CustomerRepository customerRepository) {
        this.userRepository = userRepository;
        this.customerRepository = customerRepository;
    }

    @GetMapping("/{user}")
    public Mono&lt;User&gt; getUser(@PathVariable Long userId) {
        return this.userRepository.findById(userId);
    }

    @GetMapping("/{user}/customers")
    public Flux&lt;Customer&gt; getUserCustomers(@PathVariable Long userId) {
        return this.userRepository.findById(userId).flatMapMany(this.customerRepository::findByUser);
    }

    @DeleteMapping("/{user}")
    public void deleteUser(@PathVariable Long userId) {
        this.userRepository.deleteById(userId);
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>&#8220;WebFlux.fn&#8221;, the functional variant, separates the routing configuration from the actual handling of the requests, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.http.MediaType;
import org.springframework.web.reactive.function.server.RequestPredicate;
import org.springframework.web.reactive.function.server.RouterFunction;
import org.springframework.web.reactive.function.server.ServerResponse;

import static org.springframework.web.reactive.function.server.RequestPredicates.DELETE;
import static org.springframework.web.reactive.function.server.RequestPredicates.GET;
import static org.springframework.web.reactive.function.server.RequestPredicates.accept;
import static org.springframework.web.reactive.function.server.RouterFunctions.route;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyRoutingConfiguration {

    private static final RequestPredicate ACCEPT_JSON = accept(MediaType.APPLICATION_JSON);

    @Bean
    public RouterFunction&lt;ServerResponse&gt; monoRouterFunction(MyUserHandler userHandler) {
        return route(
                GET("/{user}").and(ACCEPT_JSON), userHandler::getUser).andRoute(
                GET("/{user}/customers").and(ACCEPT_JSON), userHandler::getUserCustomers).andRoute(
                DELETE("/{user}").and(ACCEPT_JSON), userHandler::deleteUser);
    }

}
</span></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import reactor.core.publisher.Mono;

import org.springframework.stereotype.Component;
import org.springframework.web.reactive.function.server.ServerRequest;
import org.springframework.web.reactive.function.server.ServerResponse;

</span><span class="fold-block">@Component
public class MyUserHandler {

    public Mono&lt;ServerResponse&gt; getUser(ServerRequest request) {
        ...
    }

    public Mono&lt;ServerResponse&gt; getUserCustomers(ServerRequest request) {
        ...
    }

    public Mono&lt;ServerResponse&gt; deleteUser(ServerRequest request) {
        ...
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>WebFlux is part of the Spring Framework and detailed information is available in its <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/web-reactive.html#webflux-fn">reference documentation</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can define as many <code>RouterFunction</code> beans as you like to modularize the definition of the router.
Beans can be ordered if you need to apply a precedence.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To get started, add the <code>spring-boot-starter-webflux</code> module to your application.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Adding both <code>spring-boot-starter-web</code> and <code>spring-boot-starter-webflux</code> modules in your application results in Spring Boot auto-configuring Spring MVC, not WebFlux.
This behavior has been chosen because many Spring developers add <code>spring-boot-starter-webflux</code> to their Spring MVC application to use the reactive <code>WebClient</code>.
You can still enforce your choice by setting the chosen application type to <code>SpringApplication.setWebApplicationType(WebApplicationType.REACTIVE)</code>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.spring-webflux.auto-configuration"><a class="anchor" href="#features.developing-web-applications.spring-webflux.auto-configuration"></a>7.2.1. Spring WebFlux Auto-configuration</h4>
<div class="paragraph">
<p>Spring Boot provides auto-configuration for Spring WebFlux that works well with most applications.</p>
</div>
<div class="paragraph">
<p>The auto-configuration adds the following features on top of Spring&#8217;s defaults:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Configuring codecs for <code>HttpMessageReader</code> and <code>HttpMessageWriter</code> instances (described <a href="#features.developing-web-applications.spring-webflux.httpcodecs">later in this document</a>).</p>
</li>
<li>
<p>Support for serving static resources, including support for WebJars (described <a href="#features.developing-web-applications.spring-mvc.static-content">later in this document</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you want to keep Spring Boot WebFlux features and you want to add additional <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/web-reactive.html#webflux-config">WebFlux configuration</a>, you can add your own <code>@Configuration</code> class of type <code>WebFluxConfigurer</code> but <strong>without</strong> <code>@EnableWebFlux</code>.</p>
</div>
<div class="paragraph">
<p>If you want to take complete control of Spring WebFlux, you can add your own <code>@Configuration</code> annotated with <code>@EnableWebFlux</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.spring-webflux.httpcodecs"><a class="anchor" href="#features.developing-web-applications.spring-webflux.httpcodecs"></a>7.2.2. HTTP Codecs with HttpMessageReaders and HttpMessageWriters</h4>
<div class="paragraph">
<p>Spring WebFlux uses the <code>HttpMessageReader</code> and <code>HttpMessageWriter</code> interfaces to convert HTTP requests and responses.
They are configured with <code>CodecConfigurer</code> to have sensible defaults by looking at the libraries available in your classpath.</p>
</div>
<div class="paragraph">
<p>Spring Boot provides dedicated configuration properties for codecs, <code>spring.codec.*</code>.
It also applies further customization by using <code>CodecCustomizer</code> instances.
For example, <code>spring.jackson.*</code> configuration keys are applied to the Jackson codec.</p>
</div>
<div class="paragraph">
<p>If you need to add or customize codecs, you can create a custom <code>CodecCustomizer</code> component, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.web.codec.CodecCustomizer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.http.codec.ServerSentEventHttpMessageReader;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyCodecsConfiguration {

    @Bean
    public CodecCustomizer myCodecCustomizer() {
        return (configurer) -&gt; {
            configurer.registerDefaults(false);
            configurer.customCodecs().register(new ServerSentEventHttpMessageReader());
            // ...
        };
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also leverage <a href="#features.developing-web-applications.spring-mvc.json">Boot&#8217;s custom JSON serializers and deserializers</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.spring-webflux.static-content"><a class="anchor" href="#features.developing-web-applications.spring-webflux.static-content"></a>7.2.3. Static Content</h4>
<div class="paragraph">
<p>By default, Spring Boot serves static content from a directory called <code>/static</code> (or <code>/public</code> or <code>/resources</code> or <code>/META-INF/resources</code>) in the classpath.
It uses the <code>ResourceWebHandler</code> from Spring WebFlux so that you can modify that behavior by adding your own <code>WebFluxConfigurer</code> and overriding the <code>addResourceHandlers</code> method.</p>
</div>
<div class="paragraph">
<p>By default, resources are mapped on <code>/**</code>, but you can tune that by setting the <code>spring.webflux.static-path-pattern</code> property.
For instance, relocating all resources to <code>/resources/**</code> can be achieved as follows:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.webflux.static-path-pattern=/resources/**</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  webflux:
    static-path-pattern: "/resources/**"</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also customize the static resource locations by using <code>spring.web.resources.static-locations</code>.
Doing so replaces the default values with a list of directory locations.
If you do so, the default welcome page detection switches to your custom locations.
So, if there is an <code>index.html</code> in any of your locations on startup, it is the home page of the application.</p>
</div>
<div class="paragraph">
<p>In addition to the &#8220;standard&#8221; static resource locations listed earlier, a special case is made for <a href="https://www.webjars.org/">Webjars content</a>.
Any resources with a path in <code>/webjars/**</code> are served from jar files if they are packaged in the Webjars format.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Spring WebFlux applications do not strictly depend on the Servlet API, so they cannot be deployed as war files and do not use the <code>src/main/webapp</code> directory.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.spring-webflux.welcome-page"><a class="anchor" href="#features.developing-web-applications.spring-webflux.welcome-page"></a>7.2.4. Welcome Page</h4>
<div class="paragraph">
<p>Spring Boot supports both static and templated welcome pages.
It first looks for an <code>index.html</code> file in the configured static content locations.
If one is not found, it then looks for an <code>index</code> template.
If either is found, it is automatically used as the welcome page of the application.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.spring-webflux.template-engines"><a class="anchor" href="#features.developing-web-applications.spring-webflux.template-engines"></a>7.2.5. Template Engines</h4>
<div class="paragraph">
<p>As well as REST web services, you can also use Spring WebFlux to serve dynamic HTML content.
Spring WebFlux supports a variety of templating technologies, including Thymeleaf, FreeMarker, and Mustache.</p>
</div>
<div class="paragraph">
<p>Spring Boot includes auto-configuration support for the following templating engines:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://freemarker.apache.org/docs/">FreeMarker</a></p>
</li>
<li>
<p><a href="https://www.thymeleaf.org">Thymeleaf</a></p>
</li>
<li>
<p><a href="https://mustache.github.io/">Mustache</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When you use one of these templating engines with the default configuration, your templates are picked up automatically from <code>src/main/resources/templates</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.spring-webflux.error-handling"><a class="anchor" href="#features.developing-web-applications.spring-webflux.error-handling"></a>7.2.6. Error Handling</h4>
<div class="paragraph">
<p>Spring Boot provides a <code>WebExceptionHandler</code> that handles all errors in a sensible way.
Its position in the processing order is immediately before the handlers provided by WebFlux, which are considered last.
For machine clients, it produces a JSON response with details of the error, the HTTP status, and the exception message.
For browser clients, there is a &#8220;whitelabel&#8221; error handler that renders the same data in HTML format.
You can also provide your own HTML templates to display errors (see the <a href="#features.developing-web-applications.spring-webflux.error-handling.error-pages">next section</a>).</p>
</div>
<div class="paragraph">
<p>The first step to customizing this feature often involves using the existing mechanism but replacing or augmenting the error contents.
For that, you can add a bean of type <code>ErrorAttributes</code>.</p>
</div>
<div class="paragraph">
<p>To change the error handling behavior, you can implement <code>ErrorWebExceptionHandler</code> and register a bean definition of that type.
Because a <code>ErrorWebExceptionHandler</code> is quite low-level, Spring Boot also provides a convenient <code>AbstractErrorWebExceptionHandler</code> to let you handle errors in a WebFlux functional way, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import reactor.core.publisher.Mono;

import org.springframework.boot.autoconfigure.web.WebProperties.Resources;
import org.springframework.boot.autoconfigure.web.reactive.error.AbstractErrorWebExceptionHandler;
import org.springframework.boot.web.reactive.error.ErrorAttributes;
import org.springframework.context.ApplicationContext;
import org.springframework.http.HttpStatus;
import org.springframework.http.MediaType;
import org.springframework.stereotype.Component;
import org.springframework.web.reactive.function.server.RouterFunction;
import org.springframework.web.reactive.function.server.RouterFunctions;
import org.springframework.web.reactive.function.server.ServerRequest;
import org.springframework.web.reactive.function.server.ServerResponse;
import org.springframework.web.reactive.function.server.ServerResponse.BodyBuilder;

</span><span class="fold-block">@Component
public class MyErrorWebExceptionHandler extends AbstractErrorWebExceptionHandler {

    public MyErrorWebExceptionHandler(ErrorAttributes errorAttributes, Resources resources,
            ApplicationContext applicationContext) {
        super(errorAttributes, resources, applicationContext);
    }

    @Override
    protected RouterFunction&lt;ServerResponse&gt; getRoutingFunction(ErrorAttributes errorAttributes) {
        return RouterFunctions.route(this::acceptsXml, this::handleErrorAsXml);
    }

    private boolean acceptsXml(ServerRequest request) {
        return request.headers().accept().contains(MediaType.APPLICATION_XML);
    }

    public Mono&lt;ServerResponse&gt; handleErrorAsXml(ServerRequest request) {
        BodyBuilder builder = ServerResponse.status(HttpStatus.INTERNAL_SERVER_ERROR);
        // ... additional builder calls
        return builder.build();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For a more complete picture, you can also subclass <code>DefaultErrorWebExceptionHandler</code> directly and override specific methods.</p>
</div>
<div class="paragraph">
<p>In some cases, errors handled at the controller or handler function level are not recorded by the <a href="actuator.html#actuator.metrics.supported.spring-webflux">metrics infrastructure</a>.
Applications can ensure that such exceptions are recorded with the request metrics by setting the handled exception as a request attribute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.web.reactive.error.ErrorAttributes;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.ExceptionHandler;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.reactive.result.view.Rendering;
import org.springframework.web.server.ServerWebExchange;

</span><span class="fold-block">@Controller
public class MyExceptionHandlingController {

    @GetMapping("/profile")
    public Rendering userProfile() {
        // ...
        throw new IllegalStateException();
    }

    @ExceptionHandler(IllegalStateException.class)
    public Rendering handleIllegalState(ServerWebExchange exchange, IllegalStateException exc) {
        exchange.getAttributes().putIfAbsent(ErrorAttributes.ERROR_ATTRIBUTE, exc);
        return Rendering.view("errorView").modelAttribute("message", exc.getMessage()).build();
    }

}
</span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="features.developing-web-applications.spring-webflux.error-handling.error-pages"><a class="anchor" href="#features.developing-web-applications.spring-webflux.error-handling.error-pages"></a>Custom Error Pages</h5>
<div class="paragraph">
<p>If you want to display a custom HTML error page for a given status code, you can add a file to an <code>/error</code> directory.
Error pages can either be static HTML (that is, added under any of the static resource directories) or built with templates.
The name of the file should be the exact status code or a series mask.</p>
</div>
<div class="paragraph">
<p>For example, to map <code>404</code> to a static HTML file, your directory structure would be as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>src/
 +- main/
     +- java/
     |   + &lt;source code&gt;
     +- resources/
         +- public/
             +- error/
             |   +- 404.html
             +- &lt;other public assets&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To map all <code>5xx</code> errors by using a Mustache template, your directory structure would be as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>src/
 +- main/
     +- java/
     |   + &lt;source code&gt;
     +- resources/
         +- templates/
             +- error/
             |   +- 5xx.mustache
             +- &lt;other templates&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.spring-webflux.web-filters"><a class="anchor" href="#features.developing-web-applications.spring-webflux.web-filters"></a>7.2.7. Web Filters</h4>
<div class="paragraph">
<p>Spring WebFlux provides a <code>WebFilter</code> interface that can be implemented to filter HTTP request-response exchanges.
<code>WebFilter</code> beans found in the application context will be automatically used to filter each exchange.</p>
</div>
<div class="paragraph">
<p>Where the order of the filters is important they can implement <code>Ordered</code> or be annotated with <code>@Order</code>.
Spring Boot auto-configuration may configure web filters for you.
When it does so, the orders shown in the following table will be used:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Web Filter</th>
<th class="tableblock halign-left valign-top">Order</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MetricsWebFilter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Ordered.HIGHEST_PRECEDENCE + 1</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WebFilterChainProxy</code> (Spring Security)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>-100</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HttpTraceWebFilter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Ordered.LOWEST_PRECEDENCE - 10</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features.developing-web-applications.jersey"><a class="anchor" href="#features.developing-web-applications.jersey"></a>7.3. JAX-RS and Jersey</h3>
<div class="paragraph">
<p>If you prefer the JAX-RS programming model for REST endpoints, you can use one of the available implementations instead of Spring MVC.
<a href="https://jersey.github.io/">Jersey</a> and <a href="https://cxf.apache.org/">Apache CXF</a> work quite well out of the box.
CXF requires you to register its <code>Servlet</code> or <code>Filter</code> as a <code>@Bean</code> in your application context.
Jersey has some native Spring support, so we also provide auto-configuration support for it in Spring Boot, together with a starter.</p>
</div>
<div class="paragraph">
<p>To get started with Jersey, include the <code>spring-boot-starter-jersey</code> as a dependency and then you need one <code>@Bean</code> of type <code>ResourceConfig</code> in which you register all the endpoints, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.glassfish.jersey.server.ResourceConfig;

import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyJerseyConfig extends ResourceConfig {

    public MyJerseyConfig() {
        register(MyEndpoint.class);
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Jersey&#8217;s support for scanning executable archives is rather limited.
For example, it cannot scan for endpoints in a package found in a <a href="deployment.html#deployment.installing">fully executable jar file</a> or in <code>WEB-INF/classes</code> when running an executable war file.
To avoid this limitation, the <code>packages</code> method should not be used, and endpoints should be registered individually by using the <code>register</code> method, as shown in the preceding example.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For more advanced customizations, you can also register an arbitrary number of beans that implement <code>ResourceConfigCustomizer</code>.</p>
</div>
<div class="paragraph">
<p>All the registered endpoints should be <code>@Components</code> with HTTP resource annotations (<code>@GET</code> and others), as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import javax.ws.rs.GET;
import javax.ws.rs.Path;

import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
@Path("/hello")
public class MyEndpoint {

    @GET
    public String message() {
        return "Hello";
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the <code>Endpoint</code> is a Spring <code>@Component</code>, its lifecycle is managed by Spring and you can use the <code>@Autowired</code> annotation to inject dependencies and use the <code>@Value</code> annotation to inject external configuration.
By default, the Jersey servlet is registered and mapped to <code>/*</code>.
You can change the mapping by adding <code>@ApplicationPath</code> to your <code>ResourceConfig</code>.</p>
</div>
<div class="paragraph">
<p>By default, Jersey is set up as a Servlet in a <code>@Bean</code> of type <code>ServletRegistrationBean</code> named <code>jerseyServletRegistration</code>.
By default, the servlet is initialized lazily, but you can customize that behavior by setting <code>spring.jersey.servlet.load-on-startup</code>.
You can disable or override that bean by creating one of your own with the same name.
You can also use a filter instead of a servlet by setting <code>spring.jersey.type=filter</code> (in which case, the <code>@Bean</code> to replace or override is <code>jerseyFilterRegistration</code>).
The filter has an <code>@Order</code>, which you can set with <code>spring.jersey.filter.order</code>.
When using Jersey as a filter, a Servlet that will handle any requests that are not intercepted by Jersey must be present.
If your application does not contain such a servlet, you may want to enable the default servlet by setting <code>server.servlet.register-default-servlet</code> to <code>true</code>.
Both the servlet and the filter registrations can be given init parameters by using <code>spring.jersey.init.*</code> to specify a map of properties.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.developing-web-applications.embedded-container"><a class="anchor" href="#features.developing-web-applications.embedded-container"></a>7.4. Embedded Servlet Container Support</h3>
<div class="paragraph">
<p>Spring Boot includes support for embedded <a href="https://tomcat.apache.org/">Tomcat</a>, <a href="https://www.eclipse.org/jetty/">Jetty</a>, and <a href="https://github.com/undertow-io/undertow">Undertow</a> servers.
Most developers use the appropriate &#8220;Starter&#8221; to obtain a fully configured instance.
By default, the embedded server listens for HTTP requests on port <code>8080</code>.</p>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.embedded-container.servlets-filters-listeners"><a class="anchor" href="#features.developing-web-applications.embedded-container.servlets-filters-listeners"></a>7.4.1. Servlets, Filters, and listeners</h4>
<div class="paragraph">
<p>When using an embedded servlet container, you can register servlets, filters, and all the listeners (such as <code>HttpSessionListener</code>) from the Servlet spec, either by using Spring beans or by scanning for Servlet components.</p>
</div>
<div class="sect4">
<h5 id="features.developing-web-applications.embedded-container.servlets-filters-listeners.beans"><a class="anchor" href="#features.developing-web-applications.embedded-container.servlets-filters-listeners.beans"></a>Registering Servlets, Filters, and Listeners as Spring Beans</h5>
<div class="paragraph">
<p>Any <code>Servlet</code>, <code>Filter</code>, or servlet <code>*Listener</code> instance that is a Spring bean is registered with the embedded container.
This can be particularly convenient if you want to refer to a value from your <code>application.properties</code> during configuration.</p>
</div>
<div class="paragraph">
<p>By default, if the context contains only a single Servlet, it is mapped to <code>/</code>.
In the case of multiple servlet beans, the bean name is used as a path prefix.
Filters map to <code>/*</code>.</p>
</div>
<div class="paragraph">
<p>If convention-based mapping is not flexible enough, you can use the <code>ServletRegistrationBean</code>, <code>FilterRegistrationBean</code>, and <code>ServletListenerRegistrationBean</code> classes for complete control.</p>
</div>
<div class="paragraph">
<p>It is usually safe to leave Filter beans unordered.
If a specific order is required, you should annotate the <code>Filter</code> with <code>@Order</code> or make it implement <code>Ordered</code>.
You cannot configure the order of a <code>Filter</code> by annotating its bean method with <code>@Order</code>.
If you cannot change the <code>Filter</code> class to add <code>@Order</code> or implement <code>Ordered</code>, you must define a <code>FilterRegistrationBean</code> for the <code>Filter</code> and set the registration bean&#8217;s order using the <code>setOrder(int)</code> method.
Avoid configuring a Filter that reads the request body at <code>Ordered.HIGHEST_PRECEDENCE</code>, since it might go against the character encoding configuration of your application.
If a Servlet filter wraps the request, it should be configured with an order that is less than or equal to <code>OrderedFilter.REQUEST_WRAPPER_FILTER_MAX_ORDER</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
To see the order of every <code>Filter</code> in your application, enable debug level logging for the <code>web</code> <a href="#features.logging.log-groups">logging group</a> (<code>logging.level.web=debug</code>).
Details of the registered filters, including their order and URL patterns, will then be logged at startup.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Take care when registering <code>Filter</code> beans since they are initialized very early in the application lifecycle.
If you need to register a <code>Filter</code> that interacts with other beans, consider using a <a href="https://docs.spring.io/spring-boot/docs/2.5.3/api/org/springframework/boot/web/servlet/DelegatingFilterProxyRegistrationBean.html"><code>DelegatingFilterProxyRegistrationBean</code></a> instead.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.embedded-container.context-initializer"><a class="anchor" href="#features.developing-web-applications.embedded-container.context-initializer"></a>7.4.2. Servlet Context Initialization</h4>
<div class="paragraph">
<p>Embedded servlet containers do not directly execute the Servlet 3.0+ <code>javax.servlet.ServletContainerInitializer</code> interface or Spring&#8217;s <code>org.springframework.web.WebApplicationInitializer</code> interface.
This is an intentional design decision intended to reduce the risk that third party libraries designed to run inside a war may break Spring Boot applications.</p>
</div>
<div class="paragraph">
<p>If you need to perform servlet context initialization in a Spring Boot application, you should register a bean that implements the <code>org.springframework.boot.web.servlet.ServletContextInitializer</code> interface.
The single <code>onStartup</code> method provides access to the <code>ServletContext</code> and, if necessary, can easily be used as an adapter to an existing <code>WebApplicationInitializer</code>.</p>
</div>
<div class="sect4">
<h5 id="features.developing-web-applications.embedded-container.context-initializer.scanning"><a class="anchor" href="#features.developing-web-applications.embedded-container.context-initializer.scanning"></a>Scanning for Servlets, Filters, and listeners</h5>
<div class="paragraph">
<p>When using an embedded container, automatic registration of classes annotated with <code>@WebServlet</code>, <code>@WebFilter</code>, and <code>@WebListener</code> can be enabled by using <code>@ServletComponentScan</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>@ServletComponentScan</code> has no effect in a standalone container, where the container&#8217;s built-in discovery mechanisms are used instead.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.embedded-container.application-context"><a class="anchor" href="#features.developing-web-applications.embedded-container.application-context"></a>7.4.3. The ServletWebServerApplicationContext</h4>
<div class="paragraph">
<p>Under the hood, Spring Boot uses a different type of <code>ApplicationContext</code> for embedded servlet container support.
The <code>ServletWebServerApplicationContext</code> is a special type of <code>WebApplicationContext</code> that bootstraps itself by searching for a single <code>ServletWebServerFactory</code> bean.
Usually a <code>TomcatServletWebServerFactory</code>, <code>JettyServletWebServerFactory</code>, or <code>UndertowServletWebServerFactory</code> has been auto-configured.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You usually do not need to be aware of these implementation classes.
Most applications are auto-configured, and the appropriate <code>ApplicationContext</code> and <code>ServletWebServerFactory</code> are created on your behalf.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.embedded-container.customizing"><a class="anchor" href="#features.developing-web-applications.embedded-container.customizing"></a>7.4.4. Customizing Embedded Servlet Containers</h4>
<div class="paragraph">
<p>Common servlet container settings can be configured by using Spring <code>Environment</code> properties.
Usually, you would define the properties in your <code>application.properties</code> or <code>application.yaml</code> file.</p>
</div>
<div class="paragraph">
<p>Common server settings include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Network settings: Listen port for incoming HTTP requests (<code>server.port</code>), interface address to bind to <code>server.address</code>, and so on.</p>
</li>
<li>
<p>Session settings: Whether the session is persistent (<code>server.servlet.session.persistent</code>), session timeout (<code>server.servlet.session.timeout</code>), location of session data (<code>server.servlet.session.store-dir</code>), and session-cookie configuration (<code>server.servlet.session.cookie.*</code>).</p>
</li>
<li>
<p>Error management: Location of the error page (<code>server.error.path</code>) and so on.</p>
</li>
<li>
<p><a href="howto.html#howto.webserver.configure-ssl">SSL</a></p>
</li>
<li>
<p><a href="howto.html#howto.webserver.enable-response-compression">HTTP compression</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Spring Boot tries as much as possible to expose common settings, but this is not always possible.
For those cases, dedicated namespaces offer server-specific customizations (see <code>server.tomcat</code> and <code>server.undertow</code>).
For instance, <a href="howto.html#howto.webserver.configure-access-logs">access logs</a> can be configured with specific features of the embedded servlet container.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/web/ServerProperties.java"><code>ServerProperties</code></a> class for a complete list.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="features.developing-web-applications.embedded-container.customizing.programmatic"><a class="anchor" href="#features.developing-web-applications.embedded-container.customizing.programmatic"></a>Programmatic Customization</h5>
<div class="paragraph">
<p>If you need to programmatically configure your embedded servlet container, you can register a Spring bean that implements the <code>WebServerFactoryCustomizer</code> interface.
<code>WebServerFactoryCustomizer</code> provides access to the <code>ConfigurableServletWebServerFactory</code>, which includes numerous customization setter methods.
The following example shows programmatically setting the port:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.web.server.WebServerFactoryCustomizer;
import org.springframework.boot.web.servlet.server.ConfigurableServletWebServerFactory;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyWebServerFactoryCustomizer implements WebServerFactoryCustomizer&lt;ConfigurableServletWebServerFactory&gt; {

    @Override
    public void customize(ConfigurableServletWebServerFactory server) {
        server.setPort(9000);
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><code>TomcatServletWebServerFactory</code>, <code>JettyServletWebServerFactory</code> and <code>UndertowServletWebServerFactory</code> are dedicated variants of <code>ConfigurableServletWebServerFactory</code> that have additional customization setter methods for Tomcat, Jetty and Undertow respectively.
The following example shows how to customize <code>TomcatServletWebServerFactory</code> that provides access to Tomcat-specific configuration options:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.time.Duration;

import org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory;
import org.springframework.boot.web.server.WebServerFactoryCustomizer;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyTomcatWebServerFactoryCustomizer implements WebServerFactoryCustomizer&lt;TomcatServletWebServerFactory&gt; {

    @Override
    public void customize(TomcatServletWebServerFactory server) {
        server.addConnectorCustomizers((connector) -&gt; connector.setAsyncTimeout(Duration.ofSeconds(20).toMillis()));
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="features.developing-web-applications.embedded-container.customizing.direct"><a class="anchor" href="#features.developing-web-applications.embedded-container.customizing.direct"></a>Customizing ConfigurableServletWebServerFactory Directly</h5>
<div class="paragraph">
<p>For more advanced use cases that require you to extend from <code>ServletWebServerFactory</code>, you can expose a bean of such type yourself.</p>
</div>
<div class="paragraph">
<p>Setters are provided for many configuration options.
Several protected method &#8220;hooks&#8221; are also provided should you need to do something more exotic.
See the <a href="https://docs.spring.io/spring-boot/docs/2.5.3/api/org/springframework/boot/web/servlet/server/ConfigurableServletWebServerFactory.html">source code documentation</a> for details.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Auto-configured customizers are still applied on your custom factory, so use that option carefully.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-web-applications.embedded-container.jsp-limitations"><a class="anchor" href="#features.developing-web-applications.embedded-container.jsp-limitations"></a>7.4.5. JSP Limitations</h4>
<div class="paragraph">
<p>When running a Spring Boot application that uses an embedded servlet container (and is packaged as an executable archive), there are some limitations in the JSP support.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>With Jetty and Tomcat, it should work if you use war packaging.
An executable war will work when launched with <code>java -jar</code>, and will also be deployable to any standard container.
JSPs are not supported when using an executable jar.</p>
</li>
<li>
<p>Undertow does not support JSPs.</p>
</li>
<li>
<p>Creating a custom <code>error.jsp</code> page does not override the default view for <a href="#features.developing-web-applications.spring-mvc.error-handling">error handling</a>.
<a href="#features.developing-web-applications.spring-mvc.error-handling.error-pages">Custom error pages</a> should be used instead.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.developing-web-applications.reactive-server"><a class="anchor" href="#features.developing-web-applications.reactive-server"></a>7.5. Embedded Reactive Server Support</h3>
<div class="paragraph">
<p>Spring Boot includes support for the following embedded reactive web servers: Reactor Netty, Tomcat, Jetty, and Undertow.
Most developers use the appropriate “Starter” to obtain a fully configured instance.
By default, the embedded server listens for HTTP requests on port 8080.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.developing-web-applications.reactive-server-resources-configuration"><a class="anchor" href="#features.developing-web-applications.reactive-server-resources-configuration"></a>7.6. Reactive Server Resources Configuration</h3>
<div class="paragraph">
<p>When auto-configuring a Reactor Netty or Jetty server, Spring Boot will create specific beans that will provide HTTP resources to the server instance: <code>ReactorResourceFactory</code> or <code>JettyResourceFactory</code>.</p>
</div>
<div class="paragraph">
<p>By default, those resources will be also shared with the Reactor Netty and Jetty clients for optimal performances, given:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the same technology is used for server and client</p>
</li>
<li>
<p>the client instance is built using the <code>WebClient.Builder</code> bean auto-configured by Spring Boot</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Developers can override the resource configuration for Jetty and Reactor Netty by providing a custom <code>ReactorResourceFactory</code> or <code>JettyResourceFactory</code> bean - this will be applied to both clients and servers.</p>
</div>
<div class="paragraph">
<p>You can learn more about the resource configuration on the client side in the <a href="#features.webclient.runtime">WebClient Runtime section</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.graceful-shutdown"><a class="anchor" href="#features.graceful-shutdown"></a>8. Graceful shutdown</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Graceful shutdown is supported with all four embedded web servers (Jetty, Reactor Netty, Tomcat, and Undertow) and with both reactive and Servlet-based web applications.
It occurs as part of closing the application context and is performed in the earliest phase of stopping <code>SmartLifecycle</code> beans.
This stop processing uses a timeout which provides a grace period during which existing requests will be allowed to complete but no new requests will be permitted.
The exact way in which new requests are not permitted varies depending on the web server that is being used.
Jetty, Reactor Netty, and Tomcat will stop accepting requests at the network layer.
Undertow will accept requests but respond immediately with a service unavailable (503) response.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Graceful shutdown with Tomcat requires Tomcat 9.0.33 or later.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To enable graceful shutdown, configure the <code>server.shutdown</code> property, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">server.shutdown=graceful</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">server:
  shutdown: "graceful"</code></pre>
</div>
</div>
<div class="paragraph">
<p>To configure the timeout period, configure the <code>spring.lifecycle.timeout-per-shutdown-phase</code> property, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.lifecycle.timeout-per-shutdown-phase=20s</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  lifecycle:
    timeout-per-shutdown-phase: "20s"</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Using graceful shutdown with your IDE may not work properly if it does not send a proper <code>SIGTERM</code> signal.
Refer to the documentation of your IDE for more details.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.rsocket"><a class="anchor" href="#features.rsocket"></a>9. RSocket</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://rsocket.io">RSocket</a> is a binary protocol for use on byte stream transports.
It enables symmetric interaction models via async message passing over a single connection.</p>
</div>
<div class="paragraph">
<p>The <code>spring-messaging</code> module of the Spring Framework provides support for RSocket requesters and responders, both on the client and on the server side.
See the <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/web-reactive.html#rsocket-spring">RSocket section</a> of the Spring Framework reference for more details, including an overview of the RSocket protocol.</p>
</div>
<div class="sect2">
<h3 id="features.rsocket.strategies-auto-configuration"><a class="anchor" href="#features.rsocket.strategies-auto-configuration"></a>9.1. RSocket Strategies Auto-configuration</h3>
<div class="paragraph">
<p>Spring Boot auto-configures an <code>RSocketStrategies</code> bean that provides all the required infrastructure for encoding and decoding RSocket payloads.
By default, the auto-configuration will try to configure the following (in order):</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://cbor.io/">CBOR</a> codecs with Jackson</p>
</li>
<li>
<p>JSON codecs with Jackson</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The <code>spring-boot-starter-rsocket</code> starter provides both dependencies.
Check out the <a href="#features.json.jackson">Jackson support section</a> to know more about customization possibilities.</p>
</div>
<div class="paragraph">
<p>Developers can customize the <code>RSocketStrategies</code> component by creating beans that implement the <code>RSocketStrategiesCustomizer</code> interface.
Note that their <code>@Order</code> is important, as it determines the order of codecs.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.rsocket.server-auto-configuration"><a class="anchor" href="#features.rsocket.server-auto-configuration"></a>9.2. RSocket server Auto-configuration</h3>
<div class="paragraph">
<p>Spring Boot provides RSocket server auto-configuration.
The required dependencies are provided by the <code>spring-boot-starter-rsocket</code>.</p>
</div>
<div class="paragraph">
<p>Spring Boot allows exposing RSocket over WebSocket from a WebFlux server, or standing up an independent RSocket server.
This depends on the type of application and its configuration.</p>
</div>
<div class="paragraph">
<p>For WebFlux application (i.e. of type <code>WebApplicationType.REACTIVE</code>), the RSocket server will be plugged into the Web Server only if the following properties match:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.rsocket.server.mapping-path=/rsocket
spring.rsocket.server.transport=websocket</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  rsocket:
    server:
      mapping-path: "/rsocket"
      transport: "websocket"</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Plugging RSocket into a web server is only supported with Reactor Netty, as RSocket itself is built with that library.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Alternatively, an RSocket TCP or websocket server is started as an independent, embedded server.
Besides the dependency requirements, the only required configuration is to define a port for that server:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.rsocket.server.port=9898</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  rsocket:
    server:
      port: 9898</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.rsocket.messaging"><a class="anchor" href="#features.rsocket.messaging"></a>9.3. Spring Messaging RSocket support</h3>
<div class="paragraph">
<p>Spring Boot will auto-configure the Spring Messaging infrastructure for RSocket.</p>
</div>
<div class="paragraph">
<p>This means that Spring Boot will create a <code>RSocketMessageHandler</code> bean that will handle RSocket requests to your application.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.rsocket.requester"><a class="anchor" href="#features.rsocket.requester"></a>9.4. Calling RSocket Services with RSocketRequester</h3>
<div class="paragraph">
<p>Once the <code>RSocket</code> channel is established between server and client, any party can send or receive requests to the other.</p>
</div>
<div class="paragraph">
<p>As a server, you can get injected with an <code>RSocketRequester</code> instance on any handler method of an RSocket <code>@Controller</code>.
As a client, you need to configure and establish an RSocket connection first.
Spring Boot auto-configures an <code>RSocketRequester.Builder</code> for such cases with the expected codecs.</p>
</div>
<div class="paragraph">
<p>The <code>RSocketRequester.Builder</code> instance is a prototype bean, meaning each injection point will provide you with a new instance .
This is done on purpose since this builder is stateful and you shouldn&#8217;t create requesters with different setups using the same instance.</p>
</div>
<div class="paragraph">
<p>The following code shows a typical example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import reactor.core.publisher.Mono;

import org.springframework.messaging.rsocket.RSocketRequester;
import org.springframework.stereotype.Service;

</span><span class="fold-block">@Service
public class MyService {

    private final RSocketRequester rsocketRequester;

    public MyService(RSocketRequester.Builder rsocketRequesterBuilder) {
        this.rsocketRequester = rsocketRequesterBuilder.tcp("example.org", 9898);
    }

    public Mono&lt;User&gt; someRSocketCall(String name) {
        return this.rsocketRequester.route("user").data(name).retrieveMono(User.class);
    }

}
</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.security"><a class="anchor" href="#features.security"></a>10. Security</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If <a href="https://spring.io/projects/spring-security">Spring Security</a> is on the classpath, then web applications are secured by default.
Spring Boot relies on Spring Security’s content-negotiation strategy to determine whether to use <code>httpBasic</code> or <code>formLogin</code>.
To add method-level security to a web application, you can also add <code>@EnableGlobalMethodSecurity</code> with your desired settings.
Additional information can be found in the <a href="https://docs.spring.io/spring-security/site/docs/5.5.1/reference/html5/#jc-method">Spring Security Reference Guide</a>.</p>
</div>
<div class="paragraph">
<p>The default <code>UserDetailsService</code> has a single user.
The user name is <code>user</code>, and the password is random and is printed at INFO level when the application starts, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Using generated security password: 78fa095d-3f4c-48b1-ad50-e24c31d5cf35</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you fine-tune your logging configuration, ensure that the <code>org.springframework.boot.autoconfigure.security</code> category is set to log <code>INFO</code>-level messages.
Otherwise, the default password is not printed.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can change the username and password by providing a <code>spring.security.user.name</code> and <code>spring.security.user.password</code>.</p>
</div>
<div class="paragraph">
<p>The basic features you get by default in a web application are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>UserDetailsService</code> (or <code>ReactiveUserDetailsService</code> in case of a WebFlux application) bean with in-memory store and a single user with a generated password (see <a href="https://docs.spring.io/spring-boot/docs/2.5.3/api/org/springframework/boot/autoconfigure/security/SecurityProperties.User.html"><code>SecurityProperties.User</code></a> for the properties of the user).</p>
</li>
<li>
<p>Form-based login or HTTP Basic security (depending on the <code>Accept</code> header in the request) for the entire application (including actuator endpoints if actuator is on the classpath).</p>
</li>
<li>
<p>A <code>DefaultAuthenticationEventPublisher</code> for publishing authentication events.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can provide a different <code>AuthenticationEventPublisher</code> by adding a bean for it.</p>
</div>
<div class="sect2">
<h3 id="features.security.spring-mvc"><a class="anchor" href="#features.security.spring-mvc"></a>10.1. MVC Security</h3>
<div class="paragraph">
<p>The default security configuration is implemented in <code>SecurityAutoConfiguration</code> and <code>UserDetailsServiceAutoConfiguration</code>.
<code>SecurityAutoConfiguration</code> imports <code>SpringBootWebSecurityConfiguration</code> for web security and <code>UserDetailsServiceAutoConfiguration</code> configures authentication, which is also relevant in non-web applications.
To switch off the default web application security configuration completely or to combine multiple Spring Security components such as OAuth2 Client and Resource Server, add a bean of type <code>SecurityFilterChain</code> (doing so does not disable the <code>UserDetailsService</code> configuration or Actuator&#8217;s security).</p>
</div>
<div class="paragraph">
<p>To also switch off the <code>UserDetailsService</code> configuration, you can add a bean of type <code>UserDetailsService</code>, <code>AuthenticationProvider</code>, or <code>AuthenticationManager</code>.</p>
</div>
<div class="paragraph">
<p>Access rules can be overridden by adding a custom <code>SecurityFilterChain</code> or <code>WebSecurityConfigurerAdapter</code> bean.
Spring Boot provides convenience methods that can be used to override access rules for actuator endpoints and static resources.
<code>EndpointRequest</code> can be used to create a <code>RequestMatcher</code> that is based on the <code>management.endpoints.web.base-path</code> property.
<code>PathRequest</code> can be used to create a <code>RequestMatcher</code> for resources in commonly used locations.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.security.spring-webflux"><a class="anchor" href="#features.security.spring-webflux"></a>10.2. WebFlux Security</h3>
<div class="paragraph">
<p>Similar to Spring MVC applications, you can secure your WebFlux applications by adding the <code>spring-boot-starter-security</code> dependency.
The default security configuration is implemented in <code>ReactiveSecurityAutoConfiguration</code> and <code>UserDetailsServiceAutoConfiguration</code>.
<code>ReactiveSecurityAutoConfiguration</code> imports <code>WebFluxSecurityConfiguration</code> for web security and <code>UserDetailsServiceAutoConfiguration</code> configures authentication, which is also relevant in non-web applications.
To switch off the default web application security configuration completely, you can add a bean of type <code>WebFilterChainProxy</code> (doing so does not disable the <code>UserDetailsService</code> configuration or Actuator&#8217;s security).</p>
</div>
<div class="paragraph">
<p>To also switch off the <code>UserDetailsService</code> configuration, you can add a bean of type <code>ReactiveUserDetailsService</code> or <code>ReactiveAuthenticationManager</code>.</p>
</div>
<div class="paragraph">
<p>Access rules and the use of multiple Spring Security components such as OAuth 2 Client and Resource Server can be configured by adding a custom <code>SecurityWebFilterChain</code> bean.
Spring Boot provides convenience methods that can be used to override access rules for actuator endpoints and static resources.
<code>EndpointRequest</code> can be used to create a <code>ServerWebExchangeMatcher</code> that is based on the <code>management.endpoints.web.base-path</code> property.</p>
</div>
<div class="paragraph">
<p><code>PathRequest</code> can be used to create a <code>ServerWebExchangeMatcher</code> for resources in commonly used locations.</p>
</div>
<div class="paragraph">
<p>For example, you can customize your security configuration by adding something like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.autoconfigure.security.reactive.PathRequest;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.web.server.ServerHttpSecurity;
import org.springframework.security.web.server.SecurityWebFilterChain;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyWebFluxSecurityConfiguration {

    @Bean
    public SecurityWebFilterChain springSecurityFilterChain(ServerHttpSecurity http) {
        http.authorizeExchange((spec) -&gt; {
            spec.matchers(PathRequest.toStaticResources().atCommonLocations()).permitAll();
            spec.pathMatchers("/foo", "/bar").authenticated();
        });
        http.formLogin();
        return http.build();
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.security.oauth2"><a class="anchor" href="#features.security.oauth2"></a>10.3. OAuth2</h3>
<div class="paragraph">
<p><a href="https://oauth.net/2/">OAuth2</a> is a widely used authorization framework that is supported by Spring.</p>
</div>
<div class="sect3">
<h4 id="features.security.oauth2.client"><a class="anchor" href="#features.security.oauth2.client"></a>10.3.1. Client</h4>
<div class="paragraph">
<p>If you have <code>spring-security-oauth2-client</code> on your classpath, you can take advantage of some auto-configuration to set up an OAuth2/Open ID Connect clients.
This configuration makes use of the properties under <code>OAuth2ClientProperties</code>.
The same properties are applicable to both servlet and reactive applications.</p>
</div>
<div class="paragraph">
<p>You can register multiple OAuth2 clients and providers under the <code>spring.security.oauth2.client</code> prefix, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.security.oauth2.client.registration.my-client-1.client-id=abcd
spring.security.oauth2.client.registration.my-client-1.client-secret=password
spring.security.oauth2.client.registration.my-client-1.client-name=Client for user scope
spring.security.oauth2.client.registration.my-client-1.provider=my-oauth-provider
spring.security.oauth2.client.registration.my-client-1.scope=user
spring.security.oauth2.client.registration.my-client-1.redirect-uri=https://my-redirect-uri.com
spring.security.oauth2.client.registration.my-client-1.client-authentication-method=basic
spring.security.oauth2.client.registration.my-client-1.authorization-grant-type=authorization-code

spring.security.oauth2.client.registration.my-client-2.client-id=abcd
spring.security.oauth2.client.registration.my-client-2.client-secret=password
spring.security.oauth2.client.registration.my-client-2.client-name=Client for email scope
spring.security.oauth2.client.registration.my-client-2.provider=my-oauth-provider
spring.security.oauth2.client.registration.my-client-2.scope=email
spring.security.oauth2.client.registration.my-client-2.redirect-uri=https://my-redirect-uri.com
spring.security.oauth2.client.registration.my-client-2.client-authentication-method=basic
spring.security.oauth2.client.registration.my-client-2.authorization-grant-type=authorization_code

spring.security.oauth2.client.provider.my-oauth-provider.authorization-uri=https://my-auth-server/oauth/authorize
spring.security.oauth2.client.provider.my-oauth-provider.token-uri=https://my-auth-server/oauth/token
spring.security.oauth2.client.provider.my-oauth-provider.user-info-uri=https://my-auth-server/userinfo
spring.security.oauth2.client.provider.my-oauth-provider.user-info-authentication-method=header
spring.security.oauth2.client.provider.my-oauth-provider.jwk-set-uri=https://my-auth-server/token_keys
spring.security.oauth2.client.provider.my-oauth-provider.user-name-attribute=name</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  security:
    oauth2:
      client:
        registration:
          my-client-1:
            client-id: "abcd"
            client-secret: "password"
            client-name: "Client for user scope"
            provider: "my-oauth-provider"
            scope: "user"
            redirect-uri: "https://my-redirect-uri.com"
            client-authentication-method: "basic"
            authorization-grant-type: "authorization-code"

          my-client-2:
            client-id: "abcd"
            client-secret: "password"
            client-name: "Client for email scope"
            provider: "my-oauth-provider"
            scope: "email"
            redirect-uri: "https://my-redirect-uri.com"
            client-authentication-method: "basic"
            authorization-grant-type: "authorization_code"

        provider:
          my-oauth-provider:
            authorization-uri: "https://my-auth-server/oauth/authorize"
            token-uri: "https://my-auth-server/oauth/token"
            user-info-uri: "https://my-auth-server/userinfo"
            user-info-authentication-method: "header"
            jwk-set-uri: "https://my-auth-server/token_keys"
            user-name-attribute: "name"</code></pre>
</div>
</div>
<div class="paragraph">
<p>For OpenID Connect providers that support <a href="https://openid.net/specs/openid-connect-discovery-1_0.html">OpenID Connect discovery</a>, the configuration can be further simplified.
The provider needs to be configured with an <code>issuer-uri</code> which is the URI that the it asserts as its Issuer Identifier.
For example, if the <code>issuer-uri</code> provided is "https://example.com", then an <code>OpenID Provider Configuration Request</code> will be made to "https://example.com/.well-known/openid-configuration".
The result is expected to be an <code>OpenID Provider Configuration Response</code>.
The following example shows how an OpenID Connect Provider can be configured with the <code>issuer-uri</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.security.oauth2.client.provider.oidc-provider.issuer-uri=https://dev-123456.oktapreview.com/oauth2/default/</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  security:
    oauth2:
      client:
        provider:
          oidc-provider:
            issuer-uri: "https://dev-123456.oktapreview.com/oauth2/default/"</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, Spring Security&#8217;s <code>OAuth2LoginAuthenticationFilter</code> only processes URLs matching <code>/login/oauth2/code/*</code>.
If you want to customize the <code>redirect-uri</code> to use a different pattern, you need to provide configuration to process that custom pattern.
For example, for servlet applications, you can add your own <code>SecurityFilterChain</code> that resembles the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.web.SecurityFilterChain;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyOAuthClientConfiguration {

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http.authorizeRequests().anyRequest().authenticated();
        http.oauth2Login().redirectionEndpoint().baseUri("custom-callback");
        return http.build();
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Spring Boot auto-configures an <code>InMemoryOAuth2AuthorizedClientService</code> which is used by Spring Security for the management of client registrations.
The <code>InMemoryOAuth2AuthorizedClientService</code> has limited capabilities and we recommend using it only for development environments.
For production environments, consider using a <code>JdbcOAuth2AuthorizedClientService</code> or creating your own implementation of <code>OAuth2AuthorizedClientService</code>.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="features.security.oauth2.client.common-providers"><a class="anchor" href="#features.security.oauth2.client.common-providers"></a>OAuth2 client registration for common providers</h5>
<div class="paragraph">
<p>For common OAuth2 and OpenID providers, including Google, Github, Facebook, and Okta, we provide a set of provider defaults (<code>google</code>, <code>github</code>, <code>facebook</code>, and <code>okta</code>, respectively).</p>
</div>
<div class="paragraph">
<p>If you do not need to customize these providers, you can set the <code>provider</code> attribute to the one for which you need to infer defaults.
Also, if the key for the client registration matches a default supported provider, Spring Boot infers that as well.</p>
</div>
<div class="paragraph">
<p>In other words, the two configurations in the following example use the Google provider:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.security.oauth2.client.registration.my-client.client-id=abcd
spring.security.oauth2.client.registration.my-client.client-secret=password
spring.security.oauth2.client.registration.my-client.provider=google
spring.security.oauth2.client.registration.google.client-id=abcd
spring.security.oauth2.client.registration.google.client-secret=password</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  security:
    oauth2:
      client:
        registration:
          my-client:
            client-id: "abcd"
            client-secret: "password"
            provider: "google"
          google:
            client-id: "abcd"
            client-secret: "password"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.security.oauth2.server"><a class="anchor" href="#features.security.oauth2.server"></a>10.3.2. Resource Server</h4>
<div class="paragraph">
<p>If you have <code>spring-security-oauth2-resource-server</code> on your classpath, Spring Boot can set up an OAuth2 Resource Server.
For JWT configuration, a JWK Set URI or OIDC Issuer URI needs to be specified, as shown in the following examples:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.security.oauth2.resourceserver.jwt.jwk-set-uri=https://example.com/oauth2/default/v1/keys</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  security:
    oauth2:
      resourceserver:
        jwt:
          jwk-set-uri: "https://example.com/oauth2/default/v1/keys"</code></pre>
</div>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.security.oauth2.resourceserver.jwt.issuer-uri=https://dev-123456.oktapreview.com/oauth2/default/</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: "https://dev-123456.oktapreview.com/oauth2/default/"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the authorization server does not support a JWK Set URI, you can configure the resource server with the Public Key used for verifying the signature of the JWT.
This can be done using the <code>spring.security.oauth2.resourceserver.jwt.public-key-location</code> property, where the value needs to point to a file containing the public key in the PEM-encoded x509 format.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The same properties are applicable for both servlet and reactive applications.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can define your own <code>JwtDecoder</code> bean for servlet applications or a <code>ReactiveJwtDecoder</code> for reactive applications.</p>
</div>
<div class="paragraph">
<p>In cases where opaque tokens are used instead of JWTs, you can configure the following properties to validate tokens via introspection:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.security.oauth2.resourceserver.opaquetoken.introspection-uri=https://example.com/check-token
spring.security.oauth2.resourceserver.opaquetoken.client-id=my-client-id
spring.security.oauth2.resourceserver.opaquetoken.client-secret=my-client-secret</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  security:
    oauth2:
      resourceserver:
        opaquetoken:
          introspection-uri: "https://example.com/check-token"
          client-id: "my-client-id"
          client-secret: "my-client-secret"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Again, the same properties are applicable for both servlet and reactive applications.</p>
</div>
<div class="paragraph">
<p>Alternatively, you can define your own <code>OpaqueTokenIntrospector</code> bean for servlet applications or a <code>ReactiveOpaqueTokenIntrospector</code> for reactive applications.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.security.oauth2.authorization-server"><a class="anchor" href="#features.security.oauth2.authorization-server"></a>10.3.3. Authorization Server</h4>
<div class="paragraph">
<p>Currently, Spring Security does not provide support for implementing an OAuth 2.0 Authorization Server.
However, this functionality is available from the <a href="https://spring.io/projects/spring-security-oauth">Spring Security OAuth</a> project, which will eventually be superseded by Spring Security completely.
Until then, you can use the <code>spring-security-oauth2-autoconfigure</code> module to easily set up an OAuth 2.0 authorization server; see its <a href="https://docs.spring.io/spring-security-oauth2-boot/">documentation</a> for instructions.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.security.saml2"><a class="anchor" href="#features.security.saml2"></a>10.4. SAML 2.0</h3>
<div class="sect3">
<h4 id="features.security.saml2.relying-party"><a class="anchor" href="#features.security.saml2.relying-party"></a>10.4.1. Relying Party</h4>
<div class="paragraph">
<p>If you have <code>spring-security-saml2-service-provider</code> on your classpath, you can take advantage of some auto-configuration to set up a SAML 2.0 Relying Party.
This configuration makes use of the properties under <code>Saml2RelyingPartyProperties</code>.</p>
</div>
<div class="paragraph">
<p>A relying party registration represents a paired configuration between an Identity Provider, IDP, and a Service Provider, SP.
You can register multiple relying parties under the <code>spring.security.saml2.relyingparty</code> prefix, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.security.saml2.relyingparty.registration.my-relying-party1.signing.credentials[0].private-key-location=path-to-private-key
spring.security.saml2.relyingparty.registration.my-relying-party1.signing.credentials[0].certificate-location=path-to-certificate
spring.security.saml2.relyingparty.registration.my-relying-party1.decryption.credentials[0].private-key-location=path-to-private-key
spring.security.saml2.relyingparty.registration.my-relying-party1.decryption.credentials[0].certificate-location=path-to-certificate
spring.security.saml2.relyingparty.registration.my-relying-party1.identityprovider.verification.credentials[0].certificate-location=path-to-verification-cert
spring.security.saml2.relyingparty.registration.my-relying-party1.identityprovider.entity-id=remote-idp-entity-id1
spring.security.saml2.relyingparty.registration.my-relying-party1.identityprovider.sso-url=https://remoteidp1.sso.url

spring.security.saml2.relyingparty.registration.my-relying-party2.signing.credentials[0].private-key-location=path-to-private-key
spring.security.saml2.relyingparty.registration.my-relying-party2.signing.credentials[0].certificate-location=path-to-certificate
spring.security.saml2.relyingparty.registration.my-relying-party2.decryption.credentials[0].private-key-location=path-to-private-key
spring.security.saml2.relyingparty.registration.my-relying-party2.decryption.credentials[0].certificate-location=path-to-certificate
spring.security.saml2.relyingparty.registration.my-relying-party2.identityprovider.verification.credentials[0].certificate-location=path-to-other-verification-cert
spring.security.saml2.relyingparty.registration.my-relying-party2.identityprovider.entity-id=remote-idp-entity-id2
spring.security.saml2.relyingparty.registration.my-relying-party2.identityprovider.sso-url=https://remoteidp2.sso.url</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  security:
    saml2:
      relyingparty:
        registration:
          my-relying-party1:
            signing:
              credentials:
              - private-key-location: "path-to-private-key"
                certificate-location: "path-to-certificate"
            decryption:
              credentials:
              - private-key-location: "path-to-private-key"
                certificate-location: "path-to-certificate"
            identityprovider:
              verification:
                credentials:
                - certificate-location: "path-to-verification-cert"
              entity-id: "remote-idp-entity-id1"
              sso-url: "https://remoteidp1.sso.url"

          my-relying-party2:
            signing:
              credentials:
              - private-key-location: "path-to-private-key"
                certificate-location: "path-to-certificate"
            decryption:
              credentials:
              - private-key-location: "path-to-private-key"
                certificate-location: "path-to-certificate"
            identityprovider:
              verification:
                credentials:
                - certificate-location: "path-to-other-verification-cert"
              entity-id: "remote-idp-entity-id2"
              sso-url: "https://remoteidp2.sso.url"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.security.actuator"><a class="anchor" href="#features.security.actuator"></a>10.5. Actuator Security</h3>
<div class="paragraph">
<p>For security purposes, all actuators other than <code>/health</code> are disabled by default.
The <code>management.endpoints.web.exposure.include</code> property can be used to enable the actuators.</p>
</div>
<div class="paragraph">
<p>If Spring Security is on the classpath and no other <code>WebSecurityConfigurerAdapter</code> or <code>SecurityFilterChain</code> bean is present, all actuators other than <code>/health</code> are secured by Spring Boot auto-configuration.
If you define a custom <code>WebSecurityConfigurerAdapter</code> or <code>SecurityFilterChain</code> bean, Spring Boot auto-configuration will back off and you will be in full control of actuator access rules.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Before setting the <code>management.endpoints.web.exposure.include</code>, ensure that the exposed actuators do not contain sensitive information and/or are secured by placing them behind a firewall or by something like Spring Security.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="features.security.actuator.csrf"><a class="anchor" href="#features.security.actuator.csrf"></a>10.5.1. Cross Site Request Forgery Protection</h4>
<div class="paragraph">
<p>Since Spring Boot relies on Spring Security&#8217;s defaults, CSRF protection is turned on by default.
This means that the actuator endpoints that require a <code>POST</code> (shutdown and loggers endpoints), <code>PUT</code> or <code>DELETE</code> will get a 403 forbidden error when the default security configuration is in use.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
We recommend disabling CSRF protection completely only if you are creating a service that is used by non-browser clients.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Additional information about CSRF protection can be found in the <a href="https://docs.spring.io/spring-security/site/docs/5.5.1/reference/html5/#csrf">Spring Security Reference Guide</a>.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.sql"><a class="anchor" href="#features.sql"></a>11. Working with SQL Databases</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="https://spring.io/projects/spring-framework">Spring Framework</a> provides extensive support for working with SQL databases, from direct JDBC access using <code>JdbcTemplate</code> to complete &#8220;object relational mapping&#8221; technologies such as Hibernate.
<a href="https://spring.io/projects/spring-data">Spring Data</a> provides an additional level of functionality: creating <code>Repository</code> implementations directly from interfaces and using conventions to generate queries from your method names.</p>
</div>
<div class="sect2">
<h3 id="features.sql.datasource"><a class="anchor" href="#features.sql.datasource"></a>11.1. Configure a DataSource</h3>
<div class="paragraph">
<p>Java&#8217;s <code>javax.sql.DataSource</code> interface provides a standard method of working with database connections.
Traditionally, a 'DataSource' uses a <code>URL</code> along with some credentials to establish a database connection.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="howto.html#howto.data-access.configure-custom-datasource">the &#8220;How-to&#8221; section</a> for more advanced examples, typically to take full control over the configuration of the DataSource.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="features.sql.datasource.embedded"><a class="anchor" href="#features.sql.datasource.embedded"></a>11.1.1. Embedded Database Support</h4>
<div class="paragraph">
<p>It is often convenient to develop applications by using an in-memory embedded database.
Obviously, in-memory databases do not provide persistent storage.
You need to populate your database when your application starts and be prepared to throw away data when your application ends.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The &#8220;How-to&#8221; section includes a <a href="howto.html#howto.data-initialization">section on how to initialize a database</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Spring Boot can auto-configure embedded <a href="https://www.h2database.com">H2</a>, <a href="http://hsqldb.org/">HSQL</a>, and <a href="https://db.apache.org/derby/">Derby</a> databases.
You need not provide any connection URLs.
You need only include a build dependency to the embedded database that you want to use.
If there are multiple embedded databases on the classpath, set the <code>spring.datasource.embedded-database-connection</code> configuration property to control which one is used.
Setting the property to <code>none</code> disables auto-configuration of an embedded database.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you are using this feature in your tests, you may notice that the same database is reused by your whole test suite regardless of the number of application contexts that you use.
If you want to make sure that each context has a separate embedded database, you should set <code>spring.datasource.generate-unique-name</code> to <code>true</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, the typical POM dependencies would be as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.hsqldb&lt;/groupId&gt;
    &lt;artifactId&gt;hsqldb&lt;/artifactId&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You need a dependency on <code>spring-jdbc</code> for an embedded database to be auto-configured.
In this example, it is pulled in transitively through <code>spring-boot-starter-data-jpa</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If, for whatever reason, you do configure the connection URL for an embedded database, take care to ensure that the database&#8217;s automatic shutdown is disabled.
If you use H2, you should use <code>DB_CLOSE_ON_EXIT=FALSE</code> to do so.
If you use HSQLDB, you should ensure that <code>shutdown=true</code> is not used.
Disabling the database&#8217;s automatic shutdown lets Spring Boot control when the database is closed, thereby ensuring that it happens once access to the database is no longer needed.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.sql.datasource.production"><a class="anchor" href="#features.sql.datasource.production"></a>11.1.2. Connection to a Production Database</h4>
<div class="paragraph">
<p>Production database connections can also be auto-configured by using a pooling <code>DataSource</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.sql.datasource.configuration"><a class="anchor" href="#features.sql.datasource.configuration"></a>11.1.3. DataSource Configuration</h4>
<div class="paragraph">
<p>DataSource configuration is controlled by external configuration properties in <code>spring.datasource.*</code>.
For example, you might declare the following section in <code>application.properties</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.datasource.url=jdbc:mysql://localhost/test
spring.datasource.username=dbuser
spring.datasource.password=dbpass</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  datasource:
    url: "jdbc:mysql://localhost/test"
    username: "dbuser"
    password: "dbpass"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You should at least specify the URL by setting the <code>spring.datasource.url</code> property.
Otherwise, Spring Boot tries to auto-configure an embedded database.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Spring Boot can deduce the JDBC driver class for most databases from the URL.
If you need to specify a specific class, you can use the <code>spring.datasource.driver-class-name</code> property.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
For a pooling <code>DataSource</code> to be created, we need to be able to verify that a valid <code>Driver</code> class is available, so we check for that before doing anything.
In other words, if you set <code>spring.datasource.driver-class-name=com.mysql.jdbc.Driver</code>, then that class has to be loadable.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jdbc/DataSourceProperties.java"><code>DataSourceProperties</code></a> for more of the supported options.
These are the standard options that work regardless of <a href="#features.sql.datasource.connection-pool">the actual implementation</a>.
It is also possible to fine-tune implementation-specific settings by using their respective prefix (<code>spring.datasource.hikari.*</code>, <code>spring.datasource.tomcat.*</code>, <code>spring.datasource.dbcp2.*</code>, and <code>spring.datasource.oracleucp.*</code>).
Refer to the documentation of the connection pool implementation you are using for more details.</p>
</div>
<div class="paragraph">
<p>For instance, if you use the <a href="https://tomcat.apache.org/tomcat-9.0-doc/jdbc-pool.html#Common_Attributes">Tomcat connection pool</a>, you could customize many additional settings, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.datasource.tomcat.max-wait=10000
spring.datasource.tomcat.max-active=50
spring.datasource.tomcat.test-on-borrow=true</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  datasource:
    tomcat:
      max-wait: 10000
      max-active: 50
      test-on-borrow: true</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will set the pool to wait 10000ms before throwing an exception if no connection is available, limit the maximum number of connections to 50 and validate the connection before borrowing it from the pool.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.sql.datasource.connection-pool"><a class="anchor" href="#features.sql.datasource.connection-pool"></a>11.1.4. Supported Connection Pools</h4>
<div class="paragraph">
<p>Spring Boot uses the following algorithm for choosing a specific implementation:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>We prefer <a href="https://github.com/brettwooldridge/HikariCP">HikariCP</a> for its performance and concurrency.
If HikariCP is available, we always choose it.</p>
</li>
<li>
<p>Otherwise, if the Tomcat pooling <code>DataSource</code> is available, we use it.</p>
</li>
<li>
<p>Otherwise, if <a href="https://commons.apache.org/proper/commons-dbcp/">Commons DBCP2</a> is available, we use it.</p>
</li>
<li>
<p>If none of HikariCP, Tomcat, and DBCP2 are available and if Oracle UCP is available, we use it.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you use the <code>spring-boot-starter-jdbc</code> or <code>spring-boot-starter-data-jpa</code> &#8220;starters&#8221;, you automatically get a dependency to <code>HikariCP</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can bypass that algorithm completely and specify the connection pool to use by setting the <code>spring.datasource.type</code> property.
This is especially important if you run your application in a Tomcat container, as <code>tomcat-jdbc</code> is provided by default.</p>
</div>
<div class="paragraph">
<p>Additional connection pools can always be configured manually, using <code>DataSourceBuilder</code>.
If you define your own <code>DataSource</code> bean, auto-configuration does not occur.
The following connection pools are supported by <code>DataSourceBuilder</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>HikariCP</p>
</li>
<li>
<p>Tomcat pooling <code>Datasource</code></p>
</li>
<li>
<p>Commons DBCP2</p>
</li>
<li>
<p>Oracle UCP &amp; <code>OracleDataSource</code></p>
</li>
<li>
<p>Spring Framework&#8217;s <code>SimpleDriverDataSource</code></p>
</li>
<li>
<p>H2 <code>JdbcDataSource</code></p>
</li>
<li>
<p>PostgreSQL <code>PGSimpleDataSource</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="features.sql.datasource.jndi"><a class="anchor" href="#features.sql.datasource.jndi"></a>11.1.5. Connection to a JNDI DataSource</h4>
<div class="paragraph">
<p>If you deploy your Spring Boot application to an Application Server, you might want to configure and manage your DataSource by using your Application Server&#8217;s built-in features and access it by using JNDI.</p>
</div>
<div class="paragraph">
<p>The <code>spring.datasource.jndi-name</code> property can be used as an alternative to the <code>spring.datasource.url</code>, <code>spring.datasource.username</code>, and <code>spring.datasource.password</code> properties to access the <code>DataSource</code> from a specific JNDI location.
For example, the following section in <code>application.properties</code> shows how you can access a JBoss AS defined <code>DataSource</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.datasource.jndi-name=java:jboss/datasources/customers</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  datasource:
    jndi-name: "java:jboss/datasources/customers"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.sql.jdbc-template"><a class="anchor" href="#features.sql.jdbc-template"></a>11.2. Using JdbcTemplate</h3>
<div class="paragraph">
<p>Spring&#8217;s <code>JdbcTemplate</code> and <code>NamedParameterJdbcTemplate</code> classes are auto-configured, and you can <code>@Autowire</code> them directly into your own beans, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    private final JdbcTemplate jdbcTemplate;

    public MyBean(JdbcTemplate jdbcTemplate) {
        this.jdbcTemplate = jdbcTemplate;
    }

    public void doSomething() {
        this.jdbcTemplate ...
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can customize some properties of the template by using the <code>spring.jdbc.template.*</code> properties, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.jdbc.template.max-rows=500</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  jdbc:
    template:
      max-rows: 500</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <code>NamedParameterJdbcTemplate</code> reuses the same <code>JdbcTemplate</code> instance behind the scenes.
If more than one <code>JdbcTemplate</code> is defined and no primary candidate exists, the <code>NamedParameterJdbcTemplate</code> is not auto-configured.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features.sql.jpa-and-spring-data"><a class="anchor" href="#features.sql.jpa-and-spring-data"></a>11.3. JPA and Spring Data JPA</h3>
<div class="paragraph">
<p>The Java Persistence API is a standard technology that lets you &#8220;map&#8221; objects to relational databases.
The <code>spring-boot-starter-data-jpa</code> POM provides a quick way to get started.
It provides the following key dependencies:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hibernate: One of the most popular JPA implementations.</p>
</li>
<li>
<p>Spring Data JPA: Helps you to implement JPA-based repositories.</p>
</li>
<li>
<p>Spring ORM: Core ORM support from the Spring Framework.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
We do not go into too many details of JPA or <a href="https://spring.io/projects/spring-data">Spring Data</a> here.
You can follow the <a href="https://spring.io/guides/gs/accessing-data-jpa/">&#8220;Accessing Data with JPA&#8221;</a> guide from <a href="https://spring.io" class="bare">spring.io</a> and read the <a href="https://spring.io/projects/spring-data-jpa">Spring Data JPA</a> and <a href="https://hibernate.org/orm/documentation/">Hibernate</a> reference documentation.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="features.sql.jpa-and-spring-data.entity-classes"><a class="anchor" href="#features.sql.jpa-and-spring-data.entity-classes"></a>11.3.1. Entity Classes</h4>
<div class="paragraph">
<p>Traditionally, JPA &#8220;Entity&#8221; classes are specified in a <code>persistence.xml</code> file.
With Spring Boot, this file is not necessary and &#8220;Entity Scanning&#8221; is used instead.
By default, all packages below your main configuration class (the one annotated with <code>@EnableAutoConfiguration</code> or <code>@SpringBootApplication</code>) are searched.</p>
</div>
<div class="paragraph">
<p>Any classes annotated with <code>@Entity</code>, <code>@Embeddable</code>, or <code>@MappedSuperclass</code> are considered.
A typical entity class resembles the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.io.Serializable;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;

</span><span class="fold-block">@Entity
public class City implements Serializable {

    @Id
    @GeneratedValue
    private Long id;

    @Column(nullable = false)
    private String name;

    @Column(nullable = false)
    private String state;

    // ... additional members, often include @OneToMany mappings

    protected City() {
        // no-args constructor required by JPA spec
        // this one is protected since it shouldn't be used directly
    }

    public City(String name, String state) {
        this.name = name;
        this.state = state;
    }

    public String getName() {
        return this.name;
    }

    public String getState() {
        return this.state;
    }

    // ... etc

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can customize entity scanning locations by using the <code>@EntityScan</code> annotation.
See the &#8220;<a href="howto.html#howto.data-access.separate-entity-definitions-from-spring-configuration">howto.html</a>&#8221; how-to.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.sql.jpa-and-spring-data.repositories"><a class="anchor" href="#features.sql.jpa-and-spring-data.repositories"></a>11.3.2. Spring Data JPA Repositories</h4>
<div class="paragraph">
<p><a href="https://spring.io/projects/spring-data-jpa">Spring Data JPA</a> repositories are interfaces that you can define to access data.
JPA queries are created automatically from your method names.
For example, a <code>CityRepository</code> interface might declare a <code>findAllByState(String state)</code> method to find all the cities in a given state.</p>
</div>
<div class="paragraph">
<p>For more complex queries, you can annotate your method with Spring Data&#8217;s <a href="https://docs.spring.io/spring-data/jpa/docs/2.5.3/api/org/springframework/data/jpa/repository/Query.html"><code>Query</code></a> annotation.</p>
</div>
<div class="paragraph">
<p>Spring Data repositories usually extend from the <a href="https://docs.spring.io/spring-data/commons/docs/2.5.3/api/org/springframework/data/repository/Repository.html"><code>Repository</code></a> or <a href="https://docs.spring.io/spring-data/commons/docs/2.5.3/api/org/springframework/data/repository/CrudRepository.html"><code>CrudRepository</code></a> interfaces.
If you use auto-configuration, repositories are searched from the package containing your main configuration class (the one annotated with <code>@EnableAutoConfiguration</code> or <code>@SpringBootApplication</code>) down.</p>
</div>
<div class="paragraph">
<p>The following example shows a typical Spring Data repository interface definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.docs.features.sql.jpaandspringdata.entityclasses.City;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;
import org.springframework.data.repository.Repository;

</span><span class="fold-block">public interface CityRepository extends Repository&lt;City, Long&gt; {

    Page&lt;City&gt; findAll(Pageable pageable);

    City findByNameAndStateAllIgnoringCase(String name, String state);

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Spring Data JPA repositories support three different modes of bootstrapping: default, deferred, and lazy.
To enable deferred or lazy bootstrapping, set the <code>spring.data.jpa.repositories.bootstrap-mode</code> property to <code>deferred</code> or <code>lazy</code> respectively.
When using deferred or lazy bootstrapping, the auto-configured <code>EntityManagerFactoryBuilder</code> will use the context&#8217;s <code>AsyncTaskExecutor</code>, if any, as the bootstrap executor.
If more than one exists, the one named <code>applicationTaskExecutor</code> will be used.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When using deferred or lazy bootstrapping, make sure to defer any access to the JPA infrastructure after the application context bootstrap phase.
You can use <code>SmartInitializingSingleton</code> to invoke any initialization that requires the JPA infrastructure.
For JPA components (such as converters) that are created as Spring beans, use <code>ObjectProvider</code> to delay the resolution of dependencies, if any.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
We have barely scratched the surface of Spring Data JPA.
For complete details, see the <a href="https://docs.spring.io/spring-data/jpa/docs/2.5.3/reference/html">Spring Data JPA reference documentation</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.sql.jpa-and-spring-data.creating-and-dropping"><a class="anchor" href="#features.sql.jpa-and-spring-data.creating-and-dropping"></a>11.3.3. Creating and Dropping JPA Databases</h4>
<div class="paragraph">
<p>By default, JPA databases are automatically created <strong>only</strong> if you use an embedded database (H2, HSQL, or Derby).
You can explicitly configure JPA settings by using <code>spring.jpa.*</code> properties.
For example, to create and drop tables you can add the following line to your <code>application.properties</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.jpa.hibernate.ddl-auto=create-drop</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  jpa:
    hibernate.ddl-auto: "create-drop"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Hibernate&#8217;s own internal property name for this (if you happen to remember it better) is <code>hibernate.hbm2ddl.auto</code>.
You can set it, along with other Hibernate native properties, by using <code>spring.jpa.properties.*</code> (the prefix is stripped before adding them to the entity manager).
The following line shows an example of setting JPA properties for Hibernate:
</td>
</tr>
</table>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.jpa.properties.hibernate[globally_quoted_identifiers]=true</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  jpa:
    properties:
      hibernate:
        "globally_quoted_identifiers": "true"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The line in the preceding example passes a value of <code>true</code> for the <code>hibernate.globally_quoted_identifiers</code> property to the Hibernate entity manager.</p>
</div>
<div class="paragraph">
<p>By default, the DDL execution (or validation) is deferred until the <code>ApplicationContext</code> has started.
There is also a <code>spring.jpa.generate-ddl</code> flag, but it is not used if Hibernate auto-configuration is active, because the <code>ddl-auto</code> settings are more fine-grained.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.sql.jpa-and-spring-data.open-entity-manager-in-view"><a class="anchor" href="#features.sql.jpa-and-spring-data.open-entity-manager-in-view"></a>11.3.4. Open EntityManager in View</h4>
<div class="paragraph">
<p>If you are running a web application, Spring Boot by default registers <a href="https://docs.spring.io/spring-framework/docs/5.3.9/javadoc-api/org/springframework/orm/jpa/support/OpenEntityManagerInViewInterceptor.html"><code>OpenEntityManagerInViewInterceptor</code></a> to apply the &#8220;Open EntityManager in View&#8221; pattern, to allow for lazy loading in web views.
If you do not want this behavior, you should set <code>spring.jpa.open-in-view</code> to <code>false</code> in your <code>application.properties</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.sql.jdbc"><a class="anchor" href="#features.sql.jdbc"></a>11.4. Spring Data JDBC</h3>
<div class="paragraph">
<p>Spring Data includes repository support for JDBC and will automatically generate SQL for the methods on <code>CrudRepository</code>.
For more advanced queries, a <code>@Query</code> annotation is provided.</p>
</div>
<div class="paragraph">
<p>Spring Boot will auto-configure Spring Data&#8217;s JDBC repositories when the necessary dependencies are on the classpath.
They can be added to your project with a single dependency on <code>spring-boot-starter-data-jdbc</code>.
If necessary, you can take control of Spring Data JDBC&#8217;s configuration by adding the <code>@EnableJdbcRepositories</code> annotation or a <code>JdbcConfiguration</code> subclass to your application.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
For complete details of Spring Data JDBC, please refer to the <a href="https://docs.spring.io/spring-data/jdbc/docs/2.2.3/reference/html/">reference documentation</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features.sql.h2-web-console"><a class="anchor" href="#features.sql.h2-web-console"></a>11.5. Using H2&#8217;s Web Console</h3>
<div class="paragraph">
<p>The <a href="https://www.h2database.com">H2 database</a> provides a <a href="https://www.h2database.com/html/quickstart.html#h2_console">browser-based console</a> that Spring Boot can auto-configure for you.
The console is auto-configured when the following conditions are met:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You are developing a servlet-based web application.</p>
</li>
<li>
<p><code>com.h2database:h2</code> is on the classpath.</p>
</li>
<li>
<p>You are using <a href="using.html#using.devtools">Spring Boot&#8217;s developer tools</a>.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you are not using Spring Boot&#8217;s developer tools but would still like to make use of H2&#8217;s console, you can configure the <code>spring.h2.console.enabled</code> property with a value of <code>true</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The H2 console is only intended for use during development, so you should take care to ensure that <code>spring.h2.console.enabled</code> is not set to <code>true</code> in production.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="features.sql.h2-web-console.custom-path"><a class="anchor" href="#features.sql.h2-web-console.custom-path"></a>11.5.1. Changing the H2 Console&#8217;s Path</h4>
<div class="paragraph">
<p>By default, the console is available at <code>/h2-console</code>.
You can customize the console&#8217;s path by using the <code>spring.h2.console.path</code> property.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.sql.jooq"><a class="anchor" href="#features.sql.jooq"></a>11.6. Using jOOQ</h3>
<div class="paragraph">
<p>jOOQ Object Oriented Querying (<a href="https://www.jooq.org/">jOOQ</a>) is a popular product from <a href="https://www.datageekery.com/">Data Geekery</a> which generates Java code from your database and lets you build type-safe SQL queries through its fluent API.
Both the commercial and open source editions can be used with Spring Boot.</p>
</div>
<div class="sect3">
<h4 id="features.sql.jooq.codegen"><a class="anchor" href="#features.sql.jooq.codegen"></a>11.6.1. Code Generation</h4>
<div class="paragraph">
<p>In order to use jOOQ type-safe queries, you need to generate Java classes from your database schema.
You can follow the instructions in the <a href="https://www.jooq.org/doc/3.14.13/manual-single-page/#jooq-in-7-steps-step3">jOOQ user manual</a>.
If you use the <code>jooq-codegen-maven</code> plugin and you also use the <code>spring-boot-starter-parent</code> &#8220;parent POM&#8221;, you can safely omit the plugin&#8217;s <code>&lt;version&gt;</code> tag.
You can also use Spring Boot-defined version variables (such as <code>h2.version</code>) to declare the plugin&#8217;s database dependency.
The following listing shows an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;plugin&gt;
    &lt;groupId&gt;org.jooq&lt;/groupId&gt;
    &lt;artifactId&gt;jooq-codegen-maven&lt;/artifactId&gt;
    &lt;executions&gt;
        ...
    &lt;/executions&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.h2database&lt;/groupId&gt;
            &lt;artifactId&gt;h2&lt;/artifactId&gt;
            &lt;version&gt;${h2.version}&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
    &lt;configuration&gt;
        &lt;jdbc&gt;
            &lt;driver&gt;org.h2.Driver&lt;/driver&gt;
            &lt;url&gt;jdbc:h2:~/yourdatabase&lt;/url&gt;
        &lt;/jdbc&gt;
        &lt;generator&gt;
            ...
        &lt;/generator&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.sql.jooq.dslcontext"><a class="anchor" href="#features.sql.jooq.dslcontext"></a>11.6.2. Using DSLContext</h4>
<div class="paragraph">
<p>The fluent API offered by jOOQ is initiated through the <code>org.jooq.DSLContext</code> interface.
Spring Boot auto-configures a <code>DSLContext</code> as a Spring Bean and connects it to your application <code>DataSource</code>.
To use the <code>DSLContext</code>, you can inject it, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.util.GregorianCalendar;
import java.util.List;

import org.jooq.DSLContext;

import org.springframework.stereotype.Component;

import static org.springframework.boot.docs.features.sql.jooq.dslcontext.Tables.AUTHOR;

</span><span class="fold-block">@Component
public class MyBean {

    private final DSLContext create;

    public MyBean(DSLContext dslContext) {
        this.create = dslContext;
    }


}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The jOOQ manual tends to use a variable named <code>create</code> to hold the <code>DSLContext</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can then use the <code>DSLContext</code> to construct your queries, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public List&lt;GregorianCalendar&gt; authorsBornAfter1980() {
    return this.create.selectFrom(AUTHOR)
            .where(AUTHOR.DATE_OF_BIRTH.greaterThan(new GregorianCalendar(1980, 0, 1)))
            .fetch(AUTHOR.DATE_OF_BIRTH);
</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.sql.jooq.sqldialect"><a class="anchor" href="#features.sql.jooq.sqldialect"></a>11.6.3. jOOQ SQL Dialect</h4>
<div class="paragraph">
<p>Unless the <code>spring.jooq.sql-dialect</code> property has been configured, Spring Boot determines the SQL dialect to use for your datasource.
If Spring Boot could not detect the dialect, it uses <code>DEFAULT</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Spring Boot can only auto-configure dialects supported by the open source version of jOOQ.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.sql.jooq.customizing"><a class="anchor" href="#features.sql.jooq.customizing"></a>11.6.4. Customizing jOOQ</h4>
<div class="paragraph">
<p>More advanced customizations can be achieved by defining your own <code>DefaultConfigurationCustomizer</code> bean that will be invoked prior to creating the <code>org.jooq.Configuration</code> <code>@Bean</code>.
This takes precedence to anything that is applied by the auto-configuration.</p>
</div>
<div class="paragraph">
<p>You can also create your own <code>org.jooq.Configuration</code> <code>@Bean</code> if you want to take complete control of the jOOQ configuration.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.sql.r2dbc"><a class="anchor" href="#features.sql.r2dbc"></a>11.7. Using R2DBC</h3>
<div class="paragraph">
<p>The Reactive Relational Database Connectivity (<a href="https://r2dbc.io">R2DBC</a>) project brings reactive programming APIs to relational databases.
R2DBC&#8217;s <code>io.r2dbc.spi.Connection</code> provides a standard method of working with non-blocking database connections.
Connections are provided via a <code>ConnectionFactory</code>, similar to a <code>DataSource</code> with jdbc.</p>
</div>
<div class="paragraph">
<p><code>ConnectionFactory</code> configuration is controlled by external configuration properties in <code>spring.r2dbc.*</code>.
For example, you might declare the following section in <code>application.properties</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.r2dbc.url=r2dbc:postgresql://localhost/test
spring.r2dbc.username=dbuser
spring.r2dbc.password=dbpass</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  r2dbc:
    url: "r2dbc:postgresql://localhost/test"
    username: "dbuser"
    password: "dbpass"</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You do not need to specify a driver class name, since Spring Boot obtains the driver from R2DBC&#8217;s Connection Factory discovery.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
At least the url should be provided.
Information specified in the URL takes precedence over individual properties, i.e. <code>name</code>, <code>username</code>, <code>password</code> and pooling options.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
The &#8220;How-to&#8221; section includes a <a href="howto.html#howto.data-initialization.using-basic-sql-scripts">section on how to initialize a database</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To customize the connections created by a <code>ConnectionFactory</code>, i.e., set specific parameters that you do not want (or cannot) configure in your central database configuration, you can use a <code>ConnectionFactoryOptionsBuilderCustomizer</code> <code>@Bean</code>.
The following example shows how to manually override the database port while the rest of the options is taken from the application configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.r2dbc.spi.ConnectionFactoryOptions;

import org.springframework.boot.autoconfigure.r2dbc.ConnectionFactoryOptionsBuilderCustomizer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyR2dbcConfiguration {

    @Bean
    public ConnectionFactoryOptionsBuilderCustomizer connectionFactoryPortCustomizer() {
        return (builder) -&gt; builder.option(ConnectionFactoryOptions.PORT, 5432);
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following examples show how to set some PostgreSQL connection options:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.util.HashMap;
import java.util.Map;

import io.r2dbc.postgresql.PostgresqlConnectionFactoryProvider;

import org.springframework.boot.autoconfigure.r2dbc.ConnectionFactoryOptionsBuilderCustomizer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyPostgresR2dbcConfiguration {

    @Bean
    public ConnectionFactoryOptionsBuilderCustomizer postgresCustomizer() {
        Map&lt;String, String&gt; options = new HashMap&lt;&gt;();
        options.put("lock_timeout", "30s");
        options.put("statement_timeout", "60s");
        return (builder) -&gt; builder.option(PostgresqlConnectionFactoryProvider.OPTIONS, options);
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>When a <code>ConnectionFactory</code> bean is available, the regular JDBC <code>DataSource</code> auto-configuration backs off.
If you want to retain the JDBC <code>DataSource</code> auto-configuration, and are comfortable with the risk of using the blocking JDBC API in a reactive application, add <code>@Import(DataSourceAutoConfiguration.class)</code> on a <code>@Configuration</code> class in your application to re-enable it.</p>
</div>
<div class="sect3">
<h4 id="features.sql.r2dbc.embedded"><a class="anchor" href="#features.sql.r2dbc.embedded"></a>11.7.1. Embedded Database Support</h4>
<div class="paragraph">
<p>Similarly to <a href="#features.sql.datasource.embedded">the JDBC support</a>, Spring Boot can automatically configure an embedded database for reactive usage.
You need not provide any connection URLs.
You need only include a build dependency to the embedded database that you want to use, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.r2dbc&lt;/groupId&gt;
    &lt;artifactId&gt;r2dbc-h2&lt;/artifactId&gt;
    &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you are using this feature in your tests, you may notice that the same database is reused by your whole test suite regardless of the number of application contexts that you use.
If you want to make sure that each context has a separate embedded database, you should set <code>spring.r2dbc.generate-unique-name</code> to <code>true</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.sql.r2dbc.using-database-client"><a class="anchor" href="#features.sql.r2dbc.using-database-client"></a>11.7.2. Using DatabaseClient</h4>
<div class="paragraph">
<p>A <code>DatabaseClient</code> bean is auto-configured, and you can <code>@Autowire</code> it directly into your own beans, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.util.Map;

import reactor.core.publisher.Flux;

import org.springframework.r2dbc.core.DatabaseClient;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    private final DatabaseClient databaseClient;

    public MyBean(DatabaseClient databaseClient) {
        this.databaseClient = databaseClient;
    }

</span><span class="fold-block hide-when-unfolded">    // ...

</span><span class="fold-block hide-when-folded">    public Flux&lt;Map&lt;String, Object&gt;&gt; someMethod() {
        return this.databaseClient.sql("select * from user").fetch().all();
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.sql.r2dbc.repositories"><a class="anchor" href="#features.sql.r2dbc.repositories"></a>11.7.3. Spring Data R2DBC Repositories</h4>
<div class="paragraph">
<p><a href="https://spring.io/projects/spring-data-r2dbc">Spring Data R2DBC</a> repositories are interfaces that you can define to access data.
Queries are created automatically from your method names.
For example, a <code>CityRepository</code> interface might declare a <code>findAllByState(String state)</code> method to find all the cities in a given state.</p>
</div>
<div class="paragraph">
<p>For more complex queries, you can annotate your method with Spring Data&#8217;s <a href="https://docs.spring.io/spring-data/r2dbc/docs/1.3.3/api/org/springframework/data/r2dbc/repository/Query.html"><code>Query</code></a> annotation.</p>
</div>
<div class="paragraph">
<p>Spring Data repositories usually extend from the <a href="https://docs.spring.io/spring-data/commons/docs/2.5.3/api/org/springframework/data/repository/Repository.html"><code>Repository</code></a> or <a href="https://docs.spring.io/spring-data/commons/docs/2.5.3/api/org/springframework/data/repository/CrudRepository.html"><code>CrudRepository</code></a> interfaces.
If you use auto-configuration, repositories are searched from the package containing your main configuration class (the one annotated with <code>@EnableAutoConfiguration</code> or <code>@SpringBootApplication</code>) down.</p>
</div>
<div class="paragraph">
<p>The following example shows a typical Spring Data repository interface definition:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import reactor.core.publisher.Mono;

import org.springframework.data.repository.Repository;

</span><span class="fold-block">public interface CityRepository extends Repository&lt;City, Long&gt; {

    Mono&lt;City&gt; findByNameAndStateAllIgnoringCase(String name, String state);

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
We have barely scratched the surface of Spring Data R2DBC. For complete details, see the <a href="https://docs.spring.io/spring-data/r2dbc/docs/1.3.3/reference/html/">Spring Data R2DBC reference documentation</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.nosql"><a class="anchor" href="#features.nosql"></a>12. Working with NoSQL Technologies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Data provides additional projects that help you access a variety of NoSQL technologies, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://spring.io/projects/spring-data-mongodb">MongoDB</a></p>
</li>
<li>
<p><a href="https://spring.io/projects/spring-data-neo4j">Neo4J</a></p>
</li>
<li>
<p><a href="https://spring.io/projects/spring-data-elasticsearch">Elasticsearch</a></p>
</li>
<li>
<p><a href="https://spring.io/projects/spring-data-redis">Redis</a></p>
</li>
<li>
<p><a href="https://spring.io/projects/spring-data-gemfire">GemFire</a> or <a href="https://spring.io/projects/spring-data-geode">Geode</a></p>
</li>
<li>
<p><a href="https://spring.io/projects/spring-data-cassandra">Cassandra</a></p>
</li>
<li>
<p><a href="https://spring.io/projects/spring-data-couchbase">Couchbase</a></p>
</li>
<li>
<p><a href="https://spring.io/projects/spring-data-ldap">LDAP</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Spring Boot provides auto-configuration for Redis, MongoDB, Neo4j, Solr, Elasticsearch, Cassandra, Couchbase, LDAP and InfluxDB.
You can make use of the other projects, but you must configure them yourself.
Refer to the appropriate reference documentation at <a href="https://spring.io/projects/spring-data" class="bare">spring.io/projects/spring-data</a>.</p>
</div>
<div class="sect2">
<h3 id="features.nosql.redis"><a class="anchor" href="#features.nosql.redis"></a>12.1. Redis</h3>
<div class="paragraph">
<p><a href="https://redis.io/">Redis</a> is a cache, message broker, and richly-featured key-value store.
Spring Boot offers basic auto-configuration for the <a href="https://github.com/lettuce-io/lettuce-core/">Lettuce</a> and <a href="https://github.com/xetorthio/jedis/">Jedis</a> client libraries and the abstractions on top of them provided by <a href="https://github.com/spring-projects/spring-data-redis">Spring Data Redis</a>.</p>
</div>
<div class="paragraph">
<p>There is a <code>spring-boot-starter-data-redis</code> &#8220;Starter&#8221; for collecting the dependencies in a convenient way.
By default, it uses <a href="https://github.com/lettuce-io/lettuce-core/">Lettuce</a>.
That starter handles both traditional and reactive applications.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
We also provide a <code>spring-boot-starter-data-redis-reactive</code> &#8220;Starter&#8221; for consistency with the other stores with reactive support.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="features.nosql.redis.connecting"><a class="anchor" href="#features.nosql.redis.connecting"></a>12.1.1. Connecting to Redis</h4>
<div class="paragraph">
<p>You can inject an auto-configured <code>RedisConnectionFactory</code>, <code>StringRedisTemplate</code>, or vanilla <code>RedisTemplate</code> instance as you would any other Spring Bean.
By default, the instance tries to connect to a Redis server at <code>localhost:6379</code>.
The following listing shows an example of such a bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.data.redis.core.StringRedisTemplate;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    private final StringRedisTemplate template;

    public MyBean(StringRedisTemplate template) {
        this.template = template;
    }

</span><span class="fold-block hide-when-unfolded">    // ...

</span><span class="fold-block hide-when-folded">    public Boolean someMethod() {
        return this.template.hasKey("spring");
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can also register an arbitrary number of beans that implement <code>LettuceClientConfigurationBuilderCustomizer</code> for more advanced customizations.
If you use Jedis, <code>JedisClientConfigurationBuilderCustomizer</code> is also available.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you add your own <code>@Bean</code> of any of the auto-configured types, it replaces the default (except in the case of <code>RedisTemplate</code>, when the exclusion is based on the bean name, <code>redisTemplate</code>, not its type).</p>
</div>
<div class="paragraph">
<p>A pooled connection factory is auto-configured if <code>commons-pool2</code> is on the classpath and at least one <code>Pool</code> option of <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/data/redis/RedisProperties.java"><code>RedisProperties</code></a> is set.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.nosql.mongodb"><a class="anchor" href="#features.nosql.mongodb"></a>12.2. MongoDB</h3>
<div class="paragraph">
<p><a href="https://www.mongodb.com/">MongoDB</a> is an open-source NoSQL document database that uses a JSON-like schema instead of traditional table-based relational data.
Spring Boot offers several conveniences for working with MongoDB, including the <code>spring-boot-starter-data-mongodb</code> and <code>spring-boot-starter-data-mongodb-reactive</code> &#8220;Starters&#8221;.</p>
</div>
<div class="sect3">
<h4 id="features.nosql.mongodb.connecting"><a class="anchor" href="#features.nosql.mongodb.connecting"></a>12.2.1. Connecting to a MongoDB Database</h4>
<div class="paragraph">
<p>To access MongoDB databases, you can inject an auto-configured <code>org.springframework.data.mongodb.MongoDatabaseFactory</code>.
By default, the instance tries to connect to a MongoDB server at <code>mongodb://localhost/test</code>.
The following example shows how to connect to a MongoDB database:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoDatabase;
import org.bson.Document;

import org.springframework.data.mongodb.MongoDatabaseFactory;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    private final MongoDatabaseFactory mongo;

    public MyBean(MongoDatabaseFactory mongo) {
        this.mongo = mongo;
    }

</span><span class="fold-block hide-when-unfolded">    // ...

</span><span class="fold-block hide-when-folded">    public MongoCollection&lt;Document&gt; someMethod() {
        MongoDatabase db = this.mongo.getMongoDatabase();
        return db.getCollection("users");
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you have defined your own <code>MongoClient</code>, it will be used to auto-configure a suitable <code>MongoDatabaseFactory</code>.</p>
</div>
<div class="paragraph">
<p>The auto-configured <code>MongoClient</code> is created using a <code>MongoClientSettings</code> bean.
If you have defined your own <code>MongoClientSettings</code>, it will be used without modification and the <code>spring.data.mongodb</code> properties will be ignored.
Otherwise a <code>MongoClientSettings</code> will be auto-configured and will have the <code>spring.data.mongodb</code> properties applied to it.
In either case, you can declare one or more <code>MongoClientSettingsBuilderCustomizer</code> beans to fine-tune the <code>MongoClientSettings</code> configuration.
Each will be called in order with the <code>MongoClientSettings.Builder</code> that is used to build the <code>MongoClientSettings</code>.</p>
</div>
<div class="paragraph">
<p>You can set the <code>spring.data.mongodb.uri</code> property to change the URL and configure additional settings such as the <em>replica set</em>, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.data.mongodb.uri=mongodb://user:<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="43302620312637032e2c2d242c726d263b222e332f266d202c2e">[email&#160;protected]</a>:12345,mongo2.example.com:23456/test</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  data:
    mongodb:
      uri: "mongodb://user:<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="81f2e4e2f3e4f5c1eceeefe6eeb0afe4f9e0ecf1ede4afe2eeec">[email&#160;protected]</a>:12345,mongo2.example.com:23456/test"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you can specify connection details using discrete properties.
For example, you might declare the following settings in your <code>application.properties</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.data.mongodb.host=mongoserver.example.com
spring.data.mongodb.port=27017
spring.data.mongodb.database=test
spring.data.mongodb.username=user
spring.data.mongodb.password=secret</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  data:
    mongodb:
      host: "mongoserver.example.com"
      port: 27017
      database: "test"
      username: "user"
      password: "secret"</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If <code>spring.data.mongodb.port</code> is not specified, the default of <code>27017</code> is used.
You could delete this line from the example shown earlier.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you do not use Spring Data MongoDB, you can inject a <code>MongoClient</code> bean instead of using <code>MongoDatabaseFactory</code>.
If you want to take complete control of establishing the MongoDB connection, you can also declare your own <code>MongoDatabaseFactory</code> or <code>MongoClient</code> bean.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you are using the reactive driver, Netty is required for SSL.
The auto-configuration configures this factory automatically if Netty is available and the factory to use hasn&#8217;t been customized already.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.nosql.mongodb.template"><a class="anchor" href="#features.nosql.mongodb.template"></a>12.2.2. MongoTemplate</h4>
<div class="paragraph">
<p><a href="https://spring.io/projects/spring-data-mongodb">Spring Data MongoDB</a> provides a <a href="https://docs.spring.io/spring-data/mongodb/docs/3.2.3/api/org/springframework/data/mongodb/core/MongoTemplate.html"><code>MongoTemplate</code></a> class that is very similar in its design to Spring&#8217;s <code>JdbcTemplate</code>.
As with <code>JdbcTemplate</code>, Spring Boot auto-configures a bean for you to inject the template, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import com.mongodb.client.MongoCollection;
import org.bson.Document;

import org.springframework.data.mongodb.core.MongoTemplate;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    private final MongoTemplate mongoTemplate;

    public MyBean(MongoTemplate mongoTemplate) {
        this.mongoTemplate = mongoTemplate;
    }

</span><span class="fold-block hide-when-unfolded">    // ...

</span><span class="fold-block hide-when-folded">    public MongoCollection&lt;Document&gt; someMethod() {
        return this.mongoTemplate.getCollection("users");
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="https://docs.spring.io/spring-data/mongodb/docs/3.2.3/api/org/springframework/data/mongodb/core/MongoOperations.html"><code>MongoOperations</code> Javadoc</a> for complete details.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.nosql.mongodb.repositories"><a class="anchor" href="#features.nosql.mongodb.repositories"></a>12.2.3. Spring Data MongoDB Repositories</h4>
<div class="paragraph">
<p>Spring Data includes repository support for MongoDB.
As with the JPA repositories discussed earlier, the basic principle is that queries are constructed automatically, based on method names.</p>
</div>
<div class="paragraph">
<p>In fact, both Spring Data JPA and Spring Data MongoDB share the same common infrastructure.
You could take the JPA example from earlier and, assuming that <code>City</code> is now a MongoDB data class rather than a JPA <code>@Entity</code>, it works in the same way, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;
import org.springframework.data.repository.Repository;

</span><span class="fold-block">public interface CityRepository extends Repository&lt;City, Long&gt; {

    Page&lt;City&gt; findAll(Pageable pageable);

    City findByNameAndStateAllIgnoringCase(String name, String state);

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can customize document scanning locations by using the <code>@EntityScan</code> annotation.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
For complete details of Spring Data MongoDB, including its rich object mapping technologies, refer to its <a href="https://spring.io/projects/spring-data-mongodb">reference documentation</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.nosql.mongodb.embedded"><a class="anchor" href="#features.nosql.mongodb.embedded"></a>12.2.4. Embedded Mongo</h4>
<div class="paragraph">
<p>Spring Boot offers auto-configuration for <a href="https://github.com/flapdoodle-oss/de.flapdoodle.embed.mongo">Embedded Mongo</a>.
To use it in your Spring Boot application, add a dependency on <code>de.flapdoodle.embed:de.flapdoodle.embed.mongo</code>.</p>
</div>
<div class="paragraph">
<p>The port that Mongo listens on can be configured by setting the <code>spring.data.mongodb.port</code> property.
To use a randomly allocated free port, use a value of 0.
The <code>MongoClient</code> created by <code>MongoAutoConfiguration</code> is automatically configured to use the randomly allocated port.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you do not configure a custom port, the embedded support uses a random port (rather than 27017) by default.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you have SLF4J on the classpath, the output produced by Mongo is automatically routed to a logger named <code>org.springframework.boot.autoconfigure.mongo.embedded.EmbeddedMongo</code>.</p>
</div>
<div class="paragraph">
<p>You can declare your own <code>IMongodConfig</code> and <code>IRuntimeConfig</code> beans to take control of the Mongo instance&#8217;s configuration and logging routing.
The download configuration can be customized by declaring a <code>DownloadConfigBuilderCustomizer</code> bean.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.nosql.neo4j"><a class="anchor" href="#features.nosql.neo4j"></a>12.3. Neo4j</h3>
<div class="paragraph">
<p><a href="https://neo4j.com/">Neo4j</a> is an open-source NoSQL graph database that uses a rich data model of nodes connected by first class relationships, which is better suited for connected big data than traditional RDBMS approaches.
Spring Boot offers several conveniences for working with Neo4j, including the <code>spring-boot-starter-data-neo4j</code> &#8220;Starter&#8221;.</p>
</div>
<div class="sect3">
<h4 id="features.nosql.neo4j.connecting"><a class="anchor" href="#features.nosql.neo4j.connecting"></a>12.3.1. Connecting to a Neo4j Database</h4>
<div class="paragraph">
<p>To access a Neo4j server, you can inject an auto-configured <code>org.neo4j.driver.Driver</code>.
By default, the instance tries to connect to a Neo4j server at <code>localhost:7687</code> using the Bolt protocol.
The following example shows how to inject a Neo4j <code>Driver</code> that gives you access, amongst other things, to a <code>Session</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.neo4j.driver.Driver;
import org.neo4j.driver.Session;
import org.neo4j.driver.Values;

import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    private final Driver driver;

    public MyBean(Driver driver) {
        this.driver = driver;
    }

</span><span class="fold-block hide-when-unfolded">    // ...

</span><span class="fold-block hide-when-folded">    public String someMethod(String message) {
        try (Session session = this.driver.session()) {
            return session.writeTransaction((transaction) -&gt; transaction
                    .run("CREATE (a:Greeting) SET a.message = $message RETURN a.message + ', from node ' + id(a)",
                            Values.parameters("message", message))
                    .single().get(0).asString());
        }
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can configure various aspects of the driver using <code>spring.neo4j.*</code> properties.
The following example shows how to configure the uri and credentials to use:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.neo4j.uri=bolt://my-server:7687
spring.neo4j.authentication.username=neo4j
spring.neo4j.authentication.password=secret</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  neo4j:
    uri: "bolt://my-server:7687"
    authentication:
      username: "neo4j"
      password: "secret"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The auto-configured <code>Driver</code> is created using <code>ConfigBuilder</code>.
To fine-tune its configuration, declare one or more <code>ConfigBuilderCustomizer</code> beans.
Each will be called in order with the <code>ConfigBuilder</code> that is used to build the <code>Driver</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.nosql.neo4j.repositories"><a class="anchor" href="#features.nosql.neo4j.repositories"></a>12.3.2. Spring Data Neo4j Repositories</h4>
<div class="paragraph">
<p>Spring Data includes repository support for Neo4j.
For complete details of Spring Data Neo4j, refer to the <a href="https://docs.spring.io/spring-data/neo4j/docs/6.1.3/reference/html/">reference documentation</a>.</p>
</div>
<div class="paragraph">
<p>Spring Data Neo4j shares the common infrastructure with Spring Data JPA as many other Spring Data modules do.
You could take the JPA example from earlier and define <code>City</code> as Spring Data Neo4j <code>@Node</code> rather than JPA <code>@Entity</code> and the repository abstraction works in the same way, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.util.Optional;

import org.springframework.data.neo4j.repository.Neo4jRepository;

</span><span class="fold-block">public interface CityRepository extends Neo4jRepository&lt;City, Long&gt; {

    Optional&lt;City&gt; findOneByNameAndState(String name, String state);

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>spring-boot-starter-data-neo4j</code> &#8220;Starter&#8221; enables the repository support as well as transaction management.
Spring Boot supports both classic and reactive Neo4j repositories, using the <code>Neo4jTemplate</code> or <code>ReactiveNeo4jTemplate</code> beans.
When Project Reactor is available on the classpath, the reactive style is also auto-configured.</p>
</div>
<div class="paragraph">
<p>You can customize the locations to look for repositories and entities by using <code>@EnableNeo4jRepositories</code> and <code>@EntityScan</code> respectively on a <code>@Configuration</code>-bean.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In an application using the reactive style, a <code>ReactiveTransactionManager</code> is not auto-configured.
To enable transaction management, the following bean must be defined in your configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.neo4j.driver.Driver;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.neo4j.core.ReactiveDatabaseSelectionProvider;
import org.springframework.data.neo4j.core.transaction.ReactiveNeo4jTransactionManager;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyNeo4jConfiguration {

    @Bean
    public ReactiveNeo4jTransactionManager reactiveTransactionManager(Driver driver,
            ReactiveDatabaseSelectionProvider databaseNameProvider) {
        return new ReactiveNeo4jTransactionManager(driver, databaseNameProvider);
    }

}
</span></code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.nosql.solr"><a class="anchor" href="#features.nosql.solr"></a>12.4. Solr</h3>
<div class="paragraph">
<p><a href="https://lucene.apache.org/solr/">Apache Solr</a> is a search engine.
Spring Boot offers basic auto-configuration for the Solr 5 client library.</p>
</div>
<div class="sect3">
<h4 id="features.nosql.solr.connecting"><a class="anchor" href="#features.nosql.solr.connecting"></a>12.4.1. Connecting to Solr</h4>
<div class="paragraph">
<p>You can inject an auto-configured <code>SolrClient</code> instance as you would any other Spring bean.
By default, the instance tries to connect to a server at <code><a href="http://localhost:8983/solr" class="bare">localhost:8983/solr</a></code>.
The following example shows how to inject a Solr bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.io.IOException;

import org.apache.solr.client.solrj.SolrClient;
import org.apache.solr.client.solrj.SolrServerException;
import org.apache.solr.client.solrj.response.SolrPingResponse;

import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    private final SolrClient solr;

    public MyBean(SolrClient solr) {
        this.solr = solr;
    }

</span><span class="fold-block hide-when-unfolded">    // ...

</span><span class="fold-block hide-when-folded">    public SolrPingResponse someMethod() throws SolrServerException, IOException {
        return this.solr.ping("users");
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you add your own <code>@Bean</code> of type <code>SolrClient</code>, it replaces the default.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.nosql.elasticsearch"><a class="anchor" href="#features.nosql.elasticsearch"></a>12.5. Elasticsearch</h3>
<div class="paragraph">
<p><a href="https://www.elastic.co/products/elasticsearch">Elasticsearch</a> is an open source, distributed, RESTful search and analytics engine.
Spring Boot offers basic auto-configuration for Elasticsearch.</p>
</div>
<div class="paragraph">
<p>Spring Boot supports several clients:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The official Java "Low Level" and "High Level" REST clients</p>
</li>
<li>
<p>The <code>ReactiveElasticsearchClient</code> provided by Spring Data Elasticsearch</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Spring Boot provides a dedicated &#8220;Starter&#8221;, <code>spring-boot-starter-data-elasticsearch</code>.</p>
</div>
<div class="sect3">
<h4 id="features.nosql.elasticsearch.connecting-using-rest"><a class="anchor" href="#features.nosql.elasticsearch.connecting-using-rest"></a>12.5.1. Connecting to Elasticsearch using REST clients</h4>
<div class="paragraph">
<p>Elasticsearch ships <a href="https://www.elastic.co/guide/en/elasticsearch/client/java-rest/current/index.html">two different REST clients</a> that you can use to query a cluster: the "Low Level" client and the "High Level" client.
Spring Boot provides support for the "High Level" client, which ships with <code>org.elasticsearch.client:elasticsearch-rest-high-level-client</code>.</p>
</div>
<div class="paragraph">
<p>If you have this dependency on the classpath, Spring Boot will auto-configure and register a <code>RestHighLevelClient</code> bean that by default targets <code><a href="http://localhost:9200" class="bare">localhost:9200</a></code>.
You can further tune how <code>RestHighLevelClient</code> is configured, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.elasticsearch.rest.uris=https://search.example.com:9200
spring.elasticsearch.rest.read-timeout=10s
spring.elasticsearch.rest.username=user
spring.elasticsearch.rest.password=secret</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  elasticsearch:
    rest:
      uris: "https://search.example.com:9200"
      read-timeout: "10s"
      username: "user"
      password: "secret"</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also register an arbitrary number of beans that implement <code>RestClientBuilderCustomizer</code> for more advanced customizations.
To take full control over the registration, define a <code>RestClientBuilder</code> bean.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If your application needs access to a "Low Level" <code>RestClient</code>, you can get it by calling <code>client.getLowLevelClient()</code> on the auto-configured <code>RestHighLevelClient</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Additionally, if <code>elasticsearch-rest-client-sniffer</code> is on the classpath, a <code>Sniffer</code> is auto-configured to automatically discover nodes from a running Elasticsearch cluster and set them to the <code>RestHighLevelClient</code> bean.
You can further tune how <code>Sniffer</code> is configured, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.elasticsearch.rest.sniffer.interval=10m
spring.elasticsearch.rest.sniffer.delay-after-failure=30s</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  elasticsearch:
    rest:
      sniffer:
        interval: 10m
        delay-after-failure: 30s</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.nosql.elasticsearch.connecting-using-reactive-rest"><a class="anchor" href="#features.nosql.elasticsearch.connecting-using-reactive-rest"></a>12.5.2. Connecting to Elasticsearch using Reactive REST clients</h4>
<div class="paragraph">
<p><a href="https://spring.io/projects/spring-data-elasticsearch">Spring Data Elasticsearch</a> ships <code>ReactiveElasticsearchClient</code> for querying Elasticsearch instances in a reactive fashion.
It is built on top of WebFlux&#8217;s <code>WebClient</code>, so both <code>spring-boot-starter-elasticsearch</code> and <code>spring-boot-starter-webflux</code> dependencies are useful to enable this support.</p>
</div>
<div class="paragraph">
<p>By default, Spring Boot will auto-configure and register a <code>ReactiveElasticsearchClient</code>
bean that targets <code><a href="http://localhost:9200" class="bare">localhost:9200</a></code>.
You can further tune how it is configured, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.data.elasticsearch.client.reactive.endpoints=search.example.com:9200
spring.data.elasticsearch.client.reactive.use-ssl=true
spring.data.elasticsearch.client.reactive.socket-timeout=10s
spring.data.elasticsearch.client.reactive.username=user
spring.data.elasticsearch.client.reactive.password=secret</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  data:
    elasticsearch:
      client:
        reactive:
          endpoints: "search.example.com:9200"
          use-ssl: true
          socket-timeout: "10s"
          username: "user"
          password: "secret"</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the configuration properties are not enough and you&#8217;d like to fully control the client
configuration, you can register a custom <code>ClientConfiguration</code> bean.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.nosql.elasticsearch.connecting-using-spring-data"><a class="anchor" href="#features.nosql.elasticsearch.connecting-using-spring-data"></a>12.5.3. Connecting to Elasticsearch by Using Spring Data</h4>
<div class="paragraph">
<p>To connect to Elasticsearch, a <code>RestHighLevelClient</code> bean must be defined,
auto-configured by Spring Boot or manually provided by the application (see previous sections).
With this configuration in place, an
<code>ElasticsearchRestTemplate</code> can be injected like any other Spring bean,
as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.data.elasticsearch.core.ElasticsearchRestTemplate;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    private final ElasticsearchRestTemplate template;

    public MyBean(ElasticsearchRestTemplate template) {
        this.template = template;
    }

</span><span class="fold-block hide-when-unfolded">    // ...

</span><span class="fold-block hide-when-folded">    public boolean someMethod(String id) {
        return this.template.exists(id, User.class);
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the presence of <code>spring-data-elasticsearch</code> and the required dependencies for using a <code>WebClient</code> (typically <code>spring-boot-starter-webflux</code>), Spring Boot can also auto-configure a <a href="#features.nosql.elasticsearch.connecting-using-reactive-rest">ReactiveElasticsearchClient</a> and a <code>ReactiveElasticsearchTemplate</code> as beans.
They are the reactive equivalent of the other REST clients.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.nosql.elasticsearch.repositories"><a class="anchor" href="#features.nosql.elasticsearch.repositories"></a>12.5.4. Spring Data Elasticsearch Repositories</h4>
<div class="paragraph">
<p>Spring Data includes repository support for Elasticsearch.
As with the JPA repositories discussed earlier, the basic principle is that queries are constructed for you automatically based on method names.</p>
</div>
<div class="paragraph">
<p>In fact, both Spring Data JPA and Spring Data Elasticsearch share the same common infrastructure.
You could take the JPA example from earlier and, assuming that <code>City</code> is now an Elasticsearch <code>@Document</code> class rather than a JPA <code>@Entity</code>, it works in the same way.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
For complete details of Spring Data Elasticsearch, refer to the <a href="https://docs.spring.io/spring-data/elasticsearch/docs/current/reference/html/">reference documentation</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Spring Boot supports both classic and reactive Elasticsearch repositories, using the <code>ElasticsearchRestTemplate</code> or <code>ReactiveElasticsearchTemplate</code> beans.
Most likely those beans are auto-configured by Spring Boot given the required dependencies are present.</p>
</div>
<div class="paragraph">
<p>If you wish to use your own template for backing the Elasticsearch repositories, you can add your own <code>ElasticsearchRestTemplate</code> or <code>ElasticsearchOperations</code> <code>@Bean</code>, as long as it is named <code>"elasticsearchTemplate"</code>.
Same applies to <code>ReactiveElasticsearchTemplate</code> and <code>ReactiveElasticsearchOperations</code>, with the bean name <code>"reactiveElasticsearchTemplate"</code>.</p>
</div>
<div class="paragraph">
<p>You can choose to disable the repositories support with the following property:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.data.elasticsearch.repositories.enabled=false</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  data:
    elasticsearch:
      repositories:
        enabled: false</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.nosql.cassandra"><a class="anchor" href="#features.nosql.cassandra"></a>12.6. Cassandra</h3>
<div class="paragraph">
<p><a href="https://cassandra.apache.org/">Cassandra</a> is an open source, distributed database management system designed to handle large amounts of data across many commodity servers.
Spring Boot offers auto-configuration for Cassandra and the abstractions on top of it provided by <a href="https://github.com/spring-projects/spring-data-cassandra">Spring Data Cassandra</a>.
There is a <code>spring-boot-starter-data-cassandra</code> &#8220;Starter&#8221; for collecting the dependencies in a convenient way.</p>
</div>
<div class="sect3">
<h4 id="features.nosql.cassandra.connecting"><a class="anchor" href="#features.nosql.cassandra.connecting"></a>12.6.1. Connecting to Cassandra</h4>
<div class="paragraph">
<p>You can inject an auto-configured <code>CassandraTemplate</code> or a Cassandra <code>CqlSession</code> instance as you would with any other Spring Bean.
The <code>spring.data.cassandra.*</code> properties can be used to customize the connection.
Generally, you provide <code>keyspace-name</code> and <code>contact-points</code> as well the local datacenter name, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.data.cassandra.keyspace-name=mykeyspace
spring.data.cassandra.contact-points=cassandrahost1:9042,cassandrahost2:9042
spring.data.cassandra.local-datacenter=datacenter1</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  data:
    cassandra:
      keyspace-name: "mykeyspace"
      contact-points: "cassandrahost1:9042,cassandrahost2:9042"
      local-datacenter: "datacenter1"</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the port is the same for all your contact points you can use a shortcut and only specify the host names, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.data.cassandra.keyspace-name=mykeyspace
spring.data.cassandra.contact-points=cassandrahost1,cassandrahost2
spring.data.cassandra.local-datacenter=datacenter1</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  data:
    cassandra:
      keyspace-name: "mykeyspace"
      contact-points: "cassandrahost1,cassandrahost2"
      local-datacenter: "datacenter1"</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Those two examples are identical as the port default to <code>9042</code>.
If you need to configure the port, use <code>spring.data.cassandra.port</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Cassandra driver has its own configuration infrastructure that loads an <code>application.conf</code> at the root of the classpath.</p>
</div>
<div class="paragraph">
<p>Spring Boot does not look for such a file by default but can load one using <code>spring.data.cassandra.config</code>.
If a property is both present in <code>spring.data.cassandra.*</code> and the configuration file, the value in <code>spring.data.cassandra.*</code> takes precedence.</p>
</div>
<div class="paragraph">
<p>For more advanced driver customizations, you can register an arbitrary number of beans that implement <code>DriverConfigLoaderBuilderCustomizer</code>.
The <code>CqlSession</code> can be customized with a bean of type <code>CqlSessionBuilderCustomizer</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you&#8217;re using <code>CqlSessionBuilder</code> to create multiple <code>CqlSession</code> beans, keep in mind the builder is mutable so make sure to inject a fresh copy for each session.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following code listing shows how to inject a Cassandra bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.data.cassandra.core.CassandraTemplate;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    private final CassandraTemplate template;

    public MyBean(CassandraTemplate template) {
        this.template = template;
    }

</span><span class="fold-block hide-when-unfolded">    // ...

</span><span class="fold-block hide-when-folded">    public long someMethod() {
        return this.template.count(User.class);
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you add your own <code>@Bean</code> of type <code>CassandraTemplate</code>, it replaces the default.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.nosql.cassandra.repositories"><a class="anchor" href="#features.nosql.cassandra.repositories"></a>12.6.2. Spring Data Cassandra Repositories</h4>
<div class="paragraph">
<p>Spring Data includes basic repository support for Cassandra.
Currently, this is more limited than the JPA repositories discussed earlier and needs to annotate finder methods with <code>@Query</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
For complete details of Spring Data Cassandra, refer to the <a href="https://docs.spring.io/spring-data/cassandra/docs/">reference documentation</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.nosql.couchbase"><a class="anchor" href="#features.nosql.couchbase"></a>12.7. Couchbase</h3>
<div class="paragraph">
<p><a href="https://www.couchbase.com/">Couchbase</a> is an open-source, distributed, multi-model NoSQL document-oriented database that is optimized for interactive applications.
Spring Boot offers auto-configuration for Couchbase and the abstractions on top of it provided by <a href="https://github.com/spring-projects/spring-data-couchbase">Spring Data Couchbase</a>.
There are <code>spring-boot-starter-data-couchbase</code> and <code>spring-boot-starter-data-couchbase-reactive</code> &#8220;Starters&#8221; for collecting the dependencies in a convenient way.</p>
</div>
<div class="sect3">
<h4 id="features.nosql.couchbase.connecting"><a class="anchor" href="#features.nosql.couchbase.connecting"></a>12.7.1. Connecting to Couchbase</h4>
<div class="paragraph">
<p>You can get a <code>Cluster</code> by adding the Couchbase SDK and some configuration.
The <code>spring.couchbase.*</code> properties can be used to customize the connection.
Generally, you provide the <a href="https://github.com/couchbaselabs/sdk-rfcs/blob/master/rfc/0011-connection-string.md">connection string</a>, username, and password, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.couchbase.connection-string=couchbase://192.168.1.123
spring.couchbase.username=user
spring.couchbase.password=secret</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  couchbase:
    connection-string: "couchbase://192.168.1.123"
    username: "user"
    password: "secret"</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to customize some of the <code>ClusterEnvironment</code> settings.
For instance, the following configuration changes the timeout to use to open a new <code>Bucket</code> and enables SSL support:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.couchbase.env.timeouts.connect=3s
spring.couchbase.env.ssl.key-store=/location/of/keystore.jks
spring.couchbase.env.ssl.key-store-password=secret</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  couchbase:
    env:
      timeouts:
        connect: "3s"
      ssl:
        key-store: "/location/of/keystore.jks"
        key-store-password: "secret"</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Check the <code>spring.couchbase.env.*</code> properties for more details.
To take more control, one or more <code>ClusterEnvironmentBuilderCustomizer</code> beans can be used.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.nosql.couchbase.repositories"><a class="anchor" href="#features.nosql.couchbase.repositories"></a>12.7.2. Spring Data Couchbase Repositories</h4>
<div class="paragraph">
<p>Spring Data includes repository support for Couchbase.
For complete details of Spring Data Couchbase, refer to the <a href="https://docs.spring.io/spring-data/couchbase/docs/4.2.3/reference/html/">reference documentation</a>.</p>
</div>
<div class="paragraph">
<p>You can inject an auto-configured <code>CouchbaseTemplate</code> instance as you would with any other Spring Bean, provided a <code>CouchbaseClientFactory</code> bean is available.
This happens when a <code>Cluster</code> is available, as described above, and a bucket name has been specified:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.data.couchbase.bucket-name=my-bucket</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  data:
    couchbase:
      bucket-name: "my-bucket"</code></pre>
</div>
</div>
<div class="paragraph">
<p>The following examples shows how to inject a <code>CouchbaseTemplate</code> bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.data.couchbase.core.CouchbaseTemplate;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    private final CouchbaseTemplate template;

    public MyBean(CouchbaseTemplate template) {
        this.template = template;
    }

</span><span class="fold-block hide-when-unfolded">    // ...

</span><span class="fold-block hide-when-folded">    public String someMethod() {
        return this.template.getBucketName();
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>There are a few beans that you can define in your own configuration to override those provided by the auto-configuration:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>CouchbaseMappingContext</code> <code>@Bean</code> with a name of <code>couchbaseMappingContext</code>.</p>
</li>
<li>
<p>A <code>CustomConversions</code> <code>@Bean</code> with a name of <code>couchbaseCustomConversions</code>.</p>
</li>
<li>
<p>A <code>CouchbaseTemplate</code> <code>@Bean</code> with a name of <code>couchbaseTemplate</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To avoid hard-coding those names in your own config, you can reuse <code>BeanNames</code> provided by Spring Data Couchbase.
For instance, you can customize the converters to use, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.assertj.core.util.Arrays;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.couchbase.config.BeanNames;
import org.springframework.data.couchbase.core.convert.CouchbaseCustomConversions;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyCouchbaseConfiguration {

    @Bean(BeanNames.COUCHBASE_CUSTOM_CONVERSIONS)
    public CouchbaseCustomConversions myCustomConversions() {
        return new CouchbaseCustomConversions(Arrays.asList(new MyConverter()));
    }

}
</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.nosql.ldap"><a class="anchor" href="#features.nosql.ldap"></a>12.8. LDAP</h3>
<div class="paragraph">
<p><a href="https://en.wikipedia.org/wiki/Lightweight_Directory_Access_Protocol">LDAP</a> (Lightweight Directory Access Protocol) is an open, vendor-neutral, industry standard application protocol for accessing and maintaining distributed directory information services over an IP network.
Spring Boot offers auto-configuration for any compliant LDAP server as well as support for the embedded in-memory LDAP server from <a href="https://ldap.com/unboundid-ldap-sdk-for-java/">UnboundID</a>.</p>
</div>
<div class="paragraph">
<p>LDAP abstractions are provided by <a href="https://github.com/spring-projects/spring-data-ldap">Spring Data LDAP</a>.
There is a <code>spring-boot-starter-data-ldap</code> &#8220;Starter&#8221; for collecting the dependencies in a convenient way.</p>
</div>
<div class="sect3">
<h4 id="features.nosql.ldap.connecting"><a class="anchor" href="#features.nosql.ldap.connecting"></a>12.8.1. Connecting to an LDAP Server</h4>
<div class="paragraph">
<p>To connect to an LDAP server, make sure you declare a dependency on the <code>spring-boot-starter-data-ldap</code> &#8220;Starter&#8221; or <code>spring-ldap-core</code> and then declare the URLs of your server in your application.properties, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.ldap.urls=ldap://myserver:1235
spring.ldap.username=admin
spring.ldap.password=secret</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  ldap:
    urls: "ldap://myserver:1235"
    username: "admin"
    password: "secret"</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you need to customize connection settings, you can use the <code>spring.ldap.base</code> and <code>spring.ldap.base-environment</code> properties.</p>
</div>
<div class="paragraph">
<p>An <code>LdapContextSource</code> is auto-configured based on these settings.
If a <code>DirContextAuthenticationStrategy</code> bean is available, it is associated to the auto-configured <code>LdapContextSource</code>.
If you need to customize it, for instance to use a <code>PooledContextSource</code>, you can still inject the auto-configured <code>LdapContextSource</code>.
Make sure to flag your customized <code>ContextSource</code> as <code>@Primary</code> so that the auto-configured <code>LdapTemplate</code> uses it.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.nosql.ldap.repositories"><a class="anchor" href="#features.nosql.ldap.repositories"></a>12.8.2. Spring Data LDAP Repositories</h4>
<div class="paragraph">
<p>Spring Data includes repository support for LDAP.
For complete details of Spring Data LDAP, refer to the <a href="https://docs.spring.io/spring-data/ldap/docs/1.0.x/reference/html/">reference documentation</a>.</p>
</div>
<div class="paragraph">
<p>You can also inject an auto-configured <code>LdapTemplate</code> instance as you would with any other Spring Bean, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.util.List;

import org.springframework.ldap.core.LdapTemplate;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    private final LdapTemplate template;

    public MyBean(LdapTemplate template) {
        this.template = template;
    }

</span><span class="fold-block hide-when-unfolded">    // ...

</span><span class="fold-block hide-when-folded">    public List&lt;User&gt; someMethod() {
        return this.template.findAll(User.class);
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.nosql.ldap.embedded"><a class="anchor" href="#features.nosql.ldap.embedded"></a>12.8.3. Embedded In-memory LDAP Server</h4>
<div class="paragraph">
<p>For testing purposes, Spring Boot supports auto-configuration of an in-memory LDAP server from <a href="https://ldap.com/unboundid-ldap-sdk-for-java/">UnboundID</a>.
To configure the server, add a dependency to <code>com.unboundid:unboundid-ldapsdk</code> and declare a <code>spring.ldap.embedded.base-dn</code> property, as follows:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.ldap.embedded.base-dn=dc=spring,dc=io</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  ldap:
    embedded:
      base-dn: "dc=spring,dc=io"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is possible to define multiple base-dn values, however, since distinguished names usually contain commas, they must be defined using the correct notation.</p>
</div>
<div class="paragraph">
<p>In yaml files, you can use the yaml list notation. In properties files, you must include the index as part of the property name:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.ldap.embedded.base-dn[0]=dc=spring,dc=io
spring.ldap.embedded.base-dn[1]=dc=pivotal,dc=io</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring.ldap.embedded.base-dn:
  - dc=spring,dc=io
  - dc=pivotal,dc=io</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, the server starts on a random port and triggers the regular LDAP support.
There is no need to specify a <code>spring.ldap.urls</code> property.</p>
</div>
<div class="paragraph">
<p>If there is a <code>schema.ldif</code> file on your classpath, it is used to initialize the server.
If you want to load the initialization script from a different resource, you can also use the <code>spring.ldap.embedded.ldif</code> property.</p>
</div>
<div class="paragraph">
<p>By default, a standard schema is used to validate <code>LDIF</code> files.
You can turn off validation altogether by setting the <code>spring.ldap.embedded.validation.enabled</code> property.
If you have custom attributes, you can use <code>spring.ldap.embedded.validation.schema</code> to define your custom attribute types or object classes.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.nosql.influxdb"><a class="anchor" href="#features.nosql.influxdb"></a>12.9. InfluxDB</h3>
<div class="paragraph">
<p><a href="https://www.influxdata.com/">InfluxDB</a> is an open-source time series database optimized for fast, high-availability storage and retrieval of time series data in fields such as operations monitoring, application metrics, Internet-of-Things sensor data, and real-time analytics.</p>
</div>
<div class="sect3">
<h4 id="features.nosql.influxdb.connecting"><a class="anchor" href="#features.nosql.influxdb.connecting"></a>12.9.1. Connecting to InfluxDB</h4>
<div class="paragraph">
<p>Spring Boot auto-configures an <code>InfluxDB</code> instance, provided the <code>influxdb-java</code> client is on the classpath and the URL of the database is set, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.influx.url=https://172.0.0.1:8086</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  influx:
    url: "https://172.0.0.1:8086"</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the connection to InfluxDB requires a user and password, you can set the <code>spring.influx.user</code> and <code>spring.influx.password</code> properties accordingly.</p>
</div>
<div class="paragraph">
<p>InfluxDB relies on OkHttp.
If you need to tune the http client <code>InfluxDB</code> uses behind the scenes, you can register an <code>InfluxDbOkHttpClientBuilderProvider</code> bean.</p>
</div>
<div class="paragraph">
<p>If you need more control over the configuration, consider registering an <code>InfluxDbCustomizer</code> bean.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.caching"><a class="anchor" href="#features.caching"></a>13. Caching</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Spring Framework provides support for transparently adding caching to an application.
At its core, the abstraction applies caching to methods, thus reducing the number of executions based on the information available in the cache.
The caching logic is applied transparently, without any interference to the invoker.
Spring Boot auto-configures the cache infrastructure as long as caching support is enabled via the <code>@EnableCaching</code> annotation.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Check the <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/integration.html#cache">relevant section</a> of the Spring Framework reference for more details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In a nutshell, to add caching to an operation of your service add the relevant annotation to its method, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.cache.annotation.Cacheable;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyMathService {

    @Cacheable("piDecimals")
    public int computePiDecimal(int precision) {
        ...
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This example demonstrates the use of caching on a potentially costly operation.
Before invoking <code>computePiDecimal</code>, the abstraction looks for an entry in the <code>piDecimals</code> cache that matches the <code>i</code> argument.
If an entry is found, the content in the cache is immediately returned to the caller, and the method is not invoked.
Otherwise, the method is invoked, and the cache is updated before returning the value.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
You can also use the standard JSR-107 (JCache) annotations (such as <code>@CacheResult</code>) transparently.
However, we strongly advise you to not mix and match the Spring Cache and JCache annotations.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you do not add any specific cache library, Spring Boot auto-configures a <a href="#features.caching.provider.simple">simple provider</a> that uses concurrent maps in memory.
When a cache is required (such as <code>piDecimals</code> in the preceding example), this provider creates it for you.
The simple provider is not really recommended for production usage, but it is great for getting started and making sure that you understand the features.
When you have made up your mind about the cache provider to use, please make sure to read its documentation to figure out how to configure the caches that your application uses.
Nearly all providers require you to explicitly configure every cache that you use in the application.
Some offer a way to customize the default caches defined by the <code>spring.cache.cache-names</code> property.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
It is also possible to transparently <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/integration.html#cache-annotations-put">update</a> or <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/integration.html#cache-annotations-evict">evict</a> data from the cache.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="features.caching.provider"><a class="anchor" href="#features.caching.provider"></a>13.1. Supported Cache Providers</h3>
<div class="paragraph">
<p>The cache abstraction does not provide an actual store and relies on abstraction materialized by the <code>org.springframework.cache.Cache</code> and <code>org.springframework.cache.CacheManager</code> interfaces.</p>
</div>
<div class="paragraph">
<p>If you have not defined a bean of type <code>CacheManager</code> or a <code>CacheResolver</code> named <code>cacheResolver</code> (see <a href="https://docs.spring.io/spring-framework/docs/5.3.9/javadoc-api/org/springframework/cache/annotation/CachingConfigurer.html"><code>CachingConfigurer</code></a>), Spring Boot tries to detect the following providers (in the indicated order):</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#features.caching.provider.generic">Generic</a></p>
</li>
<li>
<p><a href="#features.caching.provider.jcache">JCache (JSR-107)</a> (EhCache 3, Hazelcast, Infinispan, and others)</p>
</li>
<li>
<p><a href="#features.caching.provider.ehcache2">EhCache 2.x</a></p>
</li>
<li>
<p><a href="#features.caching.provider.hazelcast">Hazelcast</a></p>
</li>
<li>
<p><a href="#features.caching.provider.infinispan">Infinispan</a></p>
</li>
<li>
<p><a href="#features.caching.provider.couchbase">Couchbase</a></p>
</li>
<li>
<p><a href="#features.caching.provider.redis">Redis</a></p>
</li>
<li>
<p><a href="#features.caching.provider.caffeine">Caffeine</a></p>
</li>
<li>
<p><a href="#features.caching.provider.simple">Simple</a></p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
It is also possible to <em>force</em> a particular cache provider by setting the <code>spring.cache.type</code> property.
Use this property if you need to <a href="#features.caching.provider.none">disable caching altogether</a> in certain environment (such as tests).
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Use the <code>spring-boot-starter-cache</code> &#8220;Starter&#8221; to quickly add basic caching dependencies.
The starter brings in <code>spring-context-support</code>.
If you add dependencies manually, you must include <code>spring-context-support</code> in order to use the JCache, EhCache 2.x, or Caffeine support.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the <code>CacheManager</code> is auto-configured by Spring Boot, you can further tune its configuration before it is fully initialized by exposing a bean that implements the <code>CacheManagerCustomizer</code> interface.
The following example sets a flag to say that <code>null</code> values should be passed down to the underlying map:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.autoconfigure.cache.CacheManagerCustomizer;
import org.springframework.cache.concurrent.ConcurrentMapCacheManager;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyCacheManagerConfiguration {

    @Bean
    public CacheManagerCustomizer&lt;ConcurrentMapCacheManager&gt; cacheManagerCustomizer() {
        return (cacheManager) -&gt; cacheManager.setAllowNullValues(false);
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the preceding example, an auto-configured <code>ConcurrentMapCacheManager</code> is expected.
If that is not the case (either you provided your own config or a different cache provider was auto-configured), the customizer is not invoked at all.
You can have as many customizers as you want, and you can also order them by using <code>@Order</code> or <code>Ordered</code>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="features.caching.provider.generic"><a class="anchor" href="#features.caching.provider.generic"></a>13.1.1. Generic</h4>
<div class="paragraph">
<p>Generic caching is used if the context defines <em>at least</em> one <code>org.springframework.cache.Cache</code> bean.
A <code>CacheManager</code> wrapping all beans of that type is created.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.caching.provider.jcache"><a class="anchor" href="#features.caching.provider.jcache"></a>13.1.2. JCache (JSR-107)</h4>
<div class="paragraph">
<p><a href="https://jcp.org/en/jsr/detail?id=107">JCache</a> is bootstrapped through the presence of a <code>javax.cache.spi.CachingProvider</code> on the classpath (that is, a JSR-107 compliant caching library exists on the classpath), and the <code>JCacheCacheManager</code> is provided by the <code>spring-boot-starter-cache</code> &#8220;Starter&#8221;.
Various compliant libraries are available, and Spring Boot provides dependency management for Ehcache 3, Hazelcast, and Infinispan.
Any other compliant library can be added as well.</p>
</div>
<div class="paragraph">
<p>It might happen that more than one provider is present, in which case the provider must be explicitly specified.
Even if the JSR-107 standard does not enforce a standardized way to define the location of the configuration file, Spring Boot does its best to accommodate setting a cache with implementation details, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties"># Only necessary if more than one provider is present
spring.cache.jcache.provider=com.example.MyCachingProvider
spring.cache.jcache.config=classpath:example.xml</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml"># Only necessary if more than one provider is present
spring:
  cache:
    jcache:
      provider: "com.example.MyCachingProvider"
      config: "classpath:example.xml"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When a cache library offers both a native implementation and JSR-107 support, Spring Boot prefers the JSR-107 support, so that the same features are available if you switch to a different JSR-107 implementation.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Spring Boot has <a href="#features.hazelcast">general support for Hazelcast</a>.
If a single <code>HazelcastInstance</code> is available, it is automatically reused for the <code>CacheManager</code> as well, unless the <code>spring.cache.jcache.config</code> property is specified.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There are two ways to customize the underlying <code>javax.cache.cacheManager</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Caches can be created on startup by setting the <code>spring.cache.cache-names</code> property.
If a custom <code>javax.cache.configuration.Configuration</code> bean is defined, it is used to customize them.</p>
</li>
<li>
<p><code>org.springframework.boot.autoconfigure.cache.JCacheManagerCustomizer</code> beans are invoked with the reference of the <code>CacheManager</code> for full customization.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If a standard <code>javax.cache.CacheManager</code> bean is defined, it is wrapped automatically in an <code>org.springframework.cache.CacheManager</code> implementation that the abstraction expects.
No further customization is applied to it.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.caching.provider.ehcache2"><a class="anchor" href="#features.caching.provider.ehcache2"></a>13.1.3. EhCache 2.x</h4>
<div class="paragraph">
<p><a href="https://www.ehcache.org/">EhCache</a> 2.x is used if a file named <code>ehcache.xml</code> can be found at the root of the classpath.
If EhCache 2.x is found, the <code>EhCacheCacheManager</code> provided by the <code>spring-boot-starter-cache</code> &#8220;Starter&#8221; is used to bootstrap the cache manager.
An alternate configuration file can be provided as well, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.cache.ehcache.config=classpath:config/another-config.xml</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  cache:
    ehcache:
      config: "classpath:config/another-config.xml"</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.caching.provider.hazelcast"><a class="anchor" href="#features.caching.provider.hazelcast"></a>13.1.4. Hazelcast</h4>
<div class="paragraph">
<p>Spring Boot has <a href="#features.hazelcast">general support for Hazelcast</a>.
If a <code>HazelcastInstance</code> has been auto-configured, it is automatically wrapped in a <code>CacheManager</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.caching.provider.infinispan"><a class="anchor" href="#features.caching.provider.infinispan"></a>13.1.5. Infinispan</h4>
<div class="paragraph">
<p><a href="https://infinispan.org/">Infinispan</a> has no default configuration file location, so it must be specified explicitly.
Otherwise, the default bootstrap is used.</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.cache.infinispan.config=infinispan.xml</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  cache:
    infinispan:
      config: "infinispan.xml"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Caches can be created on startup by setting the <code>spring.cache.cache-names</code> property.
If a custom <code>ConfigurationBuilder</code> bean is defined, it is used to customize the caches.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The support of Infinispan in Spring Boot is restricted to the embedded mode and is quite basic.
If you want more options, you should use the official Infinispan Spring Boot starter instead.
See <a href="https://github.com/infinispan/infinispan-spring-boot">Infinispan&#8217;s documentation</a> for more details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.caching.provider.couchbase"><a class="anchor" href="#features.caching.provider.couchbase"></a>13.1.6. Couchbase</h4>
<div class="paragraph">
<p>If Spring Data Couchbase is available and Couchbase is <a href="#features.nosql.couchbase">configured</a>, a <code>CouchbaseCacheManager</code> is auto-configured.
It is possible to create additional caches on startup by setting the <code>spring.cache.cache-names</code> property and cache defaults can be configured by using <code>spring.cache.couchbase.*</code> properties.
For instance, the following configuration creates <code>cache1</code> and <code>cache2</code> caches with an entry <em>expiration</em> of 10 minutes:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.cache.cache-names=cache1,cache2
spring.cache.couchbase.expiration=10m</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  cache:
    cache-names: "cache1,cache2"
    couchbase:
      expiration: "10m"</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you need more control over the configuration, consider registering a <code>CouchbaseCacheManagerBuilderCustomizer</code> bean.
The following example shows a customizer that configures a specific entry expiration for <code>cache1</code> and <code>cache2</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.time.Duration;

import org.springframework.boot.autoconfigure.cache.CouchbaseCacheManagerBuilderCustomizer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.couchbase.cache.CouchbaseCacheConfiguration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyCouchbaseCacheManagerConfiguration {

    @Bean
    public CouchbaseCacheManagerBuilderCustomizer myCouchbaseCacheManagerBuilderCustomizer() {
        return (builder) -&gt; builder
                .withCacheConfiguration("cache1", CouchbaseCacheConfiguration
                        .defaultCacheConfig().entryExpiry(Duration.ofSeconds(10)))
                .withCacheConfiguration("cache2", CouchbaseCacheConfiguration
                        .defaultCacheConfig().entryExpiry(Duration.ofMinutes(1)));

    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.caching.provider.redis"><a class="anchor" href="#features.caching.provider.redis"></a>13.1.7. Redis</h4>
<div class="paragraph">
<p>If <a href="https://redis.io/">Redis</a> is available and configured, a <code>RedisCacheManager</code> is auto-configured.
It is possible to create additional caches on startup by setting the <code>spring.cache.cache-names</code> property and cache defaults can be configured by using <code>spring.cache.redis.*</code> properties.
For instance, the following configuration creates <code>cache1</code> and <code>cache2</code> caches with a <em>time to live</em> of 10 minutes:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.cache.cache-names=cache1,cache2
spring.cache.redis.time-to-live=10m</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  cache:
    cache-names: "cache1,cache2"
    redis:
      time-to-live: "10m"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By default, a key prefix is added so that, if two separate caches use the same key, Redis does not have overlapping keys and cannot return invalid values.
We strongly recommend keeping this setting enabled if you create your own <code>RedisCacheManager</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can take full control of the default configuration by adding a <code>RedisCacheConfiguration</code> <code>@Bean</code> of your own.
This can be useful if you&#8217;re looking for customizing the default serialization strategy.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you need more control over the configuration, consider registering a <code>RedisCacheManagerBuilderCustomizer</code> bean.
The following example shows a customizer that configures a specific time to live for <code>cache1</code> and <code>cache2</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.time.Duration;

import org.springframework.boot.autoconfigure.cache.RedisCacheManagerBuilderCustomizer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.data.redis.cache.RedisCacheConfiguration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyRedisCacheManagerConfiguration {

    @Bean
    public RedisCacheManagerBuilderCustomizer myRedisCacheManagerBuilderCustomizer() {
        return (builder) -&gt; builder
                .withCacheConfiguration("cache1", RedisCacheConfiguration
                        .defaultCacheConfig().entryTtl(Duration.ofSeconds(10)))
                .withCacheConfiguration("cache2", RedisCacheConfiguration
                        .defaultCacheConfig().entryTtl(Duration.ofMinutes(1)));

    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.caching.provider.caffeine"><a class="anchor" href="#features.caching.provider.caffeine"></a>13.1.8. Caffeine</h4>
<div class="paragraph">
<p><a href="https://github.com/ben-manes/caffeine">Caffeine</a> is a Java 8 rewrite of Guava&#8217;s cache that supersedes support for Guava.
If Caffeine is present, a <code>CaffeineCacheManager</code> (provided by the <code>spring-boot-starter-cache</code> &#8220;Starter&#8221;) is auto-configured.
Caches can be created on startup by setting the <code>spring.cache.cache-names</code> property and can be customized by one of the following (in the indicated order):</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A cache spec defined by <code>spring.cache.caffeine.spec</code></p>
</li>
<li>
<p>A <code>com.github.benmanes.caffeine.cache.CaffeineSpec</code> bean is defined</p>
</li>
<li>
<p>A <code>com.github.benmanes.caffeine.cache.Caffeine</code> bean is defined</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For instance, the following configuration creates <code>cache1</code> and <code>cache2</code> caches with a maximum size of 500 and a <em>time to live</em> of 10 minutes</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.cache.cache-names=cache1,cache2
spring.cache.caffeine.spec=maximumSize=500,expireAfterAccess=600s</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  cache:
    cache-names: "cache1,cache2"
    caffeine:
      spec: "maximumSize=500,expireAfterAccess=600s"</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a <code>com.github.benmanes.caffeine.cache.CacheLoader</code> bean is defined, it is automatically associated to the <code>CaffeineCacheManager</code>.
Since the <code>CacheLoader</code> is going to be associated with <em>all</em> caches managed by the cache manager, it must be defined as <code>CacheLoader&lt;Object, Object&gt;</code>.
The auto-configuration ignores any other generic type.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.caching.provider.simple"><a class="anchor" href="#features.caching.provider.simple"></a>13.1.9. Simple</h4>
<div class="paragraph">
<p>If none of the other providers can be found, a simple implementation using a <code>ConcurrentHashMap</code> as the cache store is configured.
This is the default if no caching library is present in your application.
By default, caches are created as needed, but you can restrict the list of available caches by setting the <code>cache-names</code> property.
For instance, if you want only <code>cache1</code> and <code>cache2</code> caches, set the <code>cache-names</code> property as follows:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.cache.cache-names=cache1,cache2</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  cache:
    cache-names: "cache1,cache2"</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you do so and your application uses a cache not listed, then it fails at runtime when the cache is needed, but not on startup.
This is similar to the way the "real" cache providers behave if you use an undeclared cache.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.caching.provider.none"><a class="anchor" href="#features.caching.provider.none"></a>13.1.10. None</h4>
<div class="paragraph">
<p>When <code>@EnableCaching</code> is present in your configuration, a suitable cache configuration is expected as well.
If you need to disable caching altogether in certain environments, force the cache type to <code>none</code> to use a no-op implementation, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.cache.type=none</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  cache:
    type: "none"</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.messaging"><a class="anchor" href="#features.messaging"></a>14. Messaging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Spring Framework provides extensive support for integrating with messaging systems, from simplified use of the JMS API using <code>JmsTemplate</code> to a complete infrastructure to receive messages asynchronously.
Spring AMQP provides a similar feature set for the Advanced Message Queuing Protocol.
Spring Boot also provides auto-configuration options for <code>RabbitTemplate</code> and RabbitMQ.
Spring WebSocket natively includes support for STOMP messaging, and Spring Boot has support for that through starters and a small amount of auto-configuration.
Spring Boot also has support for Apache Kafka.</p>
</div>
<div class="sect2">
<h3 id="features.messaging.jms"><a class="anchor" href="#features.messaging.jms"></a>14.1. JMS</h3>
<div class="paragraph">
<p>The <code>javax.jms.ConnectionFactory</code> interface provides a standard method of creating a <code>javax.jms.Connection</code> for interacting with a JMS broker.
Although Spring needs a <code>ConnectionFactory</code> to work with JMS, you generally need not use it directly yourself and can instead rely on higher level messaging abstractions.
(See the <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/integration.html#jms">relevant section</a> of the Spring Framework reference documentation for details.)
Spring Boot also auto-configures the necessary infrastructure to send and receive messages.</p>
</div>
<div class="sect3">
<h4 id="features.messaging.jms.activemq"><a class="anchor" href="#features.messaging.jms.activemq"></a>14.1.1. ActiveMQ Support</h4>
<div class="paragraph">
<p>When <a href="https://activemq.apache.org/">ActiveMQ</a> is available on the classpath, Spring Boot can also configure a <code>ConnectionFactory</code>.
If the broker is present, an embedded broker is automatically started and configured (provided no broker URL is specified through configuration).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you use <code>spring-boot-starter-activemq</code>, the necessary dependencies to connect or embed an ActiveMQ instance are provided, as is the Spring infrastructure to integrate with JMS.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>ActiveMQ configuration is controlled by external configuration properties in <code>spring.activemq.*</code>.
For example, you might declare the following section in <code>application.properties</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.activemq.broker-url=tcp://192.168.1.210:9876
spring.activemq.user=admin
spring.activemq.password=secret</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  activemq:
    broker-url: "tcp://192.168.1.210:9876"
    user: "admin"
    password: "secret"</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, a <code>CachingConnectionFactory</code> wraps the native <code>ConnectionFactory</code> with sensible settings that you can control by external configuration properties in <code>spring.jms.*</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.jms.cache.session-cache-size=5</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  jms:
    cache:
      session-cache-size: 5</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you&#8217;d rather use native pooling, you can do so by adding a dependency to <code>org.messaginghub:pooled-jms</code> and configuring the <code>JmsPoolConnectionFactory</code> accordingly, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.activemq.pool.enabled=true
spring.activemq.pool.max-connections=50</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  activemq:
    pool:
      enabled: true
      max-connections: 50</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jms/activemq/ActiveMQProperties.java"><code>ActiveMQProperties</code></a> for more of the supported options.
You can also register an arbitrary number of beans that implement <code>ActiveMQConnectionFactoryCustomizer</code> for more advanced customizations.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, ActiveMQ creates a destination if it does not yet exist so that destinations are resolved against their provided names.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.messaging.jms.artemis"><a class="anchor" href="#features.messaging.jms.artemis"></a>14.1.2. ActiveMQ Artemis Support</h4>
<div class="paragraph">
<p>Spring Boot can auto-configure a <code>ConnectionFactory</code> when it detects that <a href="https://activemq.apache.org/components/artemis/">ActiveMQ Artemis</a> is available on the classpath.
If the broker is present, an embedded broker is automatically started and configured (unless the mode property has been explicitly set).
The supported modes are <code>embedded</code> (to make explicit that an embedded broker is required and that an error should occur if the broker is not available on the classpath) and <code>native</code> (to connect to a broker using the <code>netty</code> transport protocol).
When the latter is configured, Spring Boot configures a <code>ConnectionFactory</code> that connects to a broker running on the local machine with the default settings.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you use <code>spring-boot-starter-artemis</code>, the necessary dependencies to connect to an existing ActiveMQ Artemis instance are provided, as well as the Spring infrastructure to integrate with JMS.
Adding <code>org.apache.activemq:artemis-jms-server</code> to your application lets you use embedded mode.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>ActiveMQ Artemis configuration is controlled by external configuration properties in <code>spring.artemis.*</code>.
For example, you might declare the following section in <code>application.properties</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.artemis.mode=native
spring.artemis.broker-url=tcp://192.168.1.210:9876
spring.artemis.user=admin
spring.artemis.password=secret</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  artemis:
    mode: native
    broker-url: "tcp://192.168.1.210:9876"
    user: "admin"
    password: "secret"</code></pre>
</div>
</div>
<div class="paragraph">
<p>When embedding the broker, you can choose if you want to enable persistence and list the destinations that should be made available.
These can be specified as a comma-separated list to create them with the default options, or you can define bean(s) of type <code>org.apache.activemq.artemis.jms.server.config.JMSQueueConfiguration</code> or <code>org.apache.activemq.artemis.jms.server.config.TopicConfiguration</code>, for advanced queue and topic configurations, respectively.</p>
</div>
<div class="paragraph">
<p>By default, a <code>CachingConnectionFactory</code> wraps the native <code>ConnectionFactory</code> with sensible settings that you can control by external configuration properties in <code>spring.jms.*</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.jms.cache.session-cache-size=5</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  jms:
    cache:
      session-cache-size: 5</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you&#8217;d rather use native pooling, you can do so by adding a dependency to <code>org.messaginghub:pooled-jms</code> and configuring the <code>JmsPoolConnectionFactory</code> accordingly, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.artemis.pool.enabled=true
spring.artemis.pool.max-connections=50</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  artemis:
    pool:
      enabled: true
      max-connections: 50</code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jms/artemis/ArtemisProperties.java"><code>ArtemisProperties</code></a> for more supported options.</p>
</div>
<div class="paragraph">
<p>No JNDI lookup is involved, and destinations are resolved against their names, using either the <code>name</code> attribute in the Artemis configuration or the names provided through configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.messaging.jms.jndi"><a class="anchor" href="#features.messaging.jms.jndi"></a>14.1.3. Using a JNDI ConnectionFactory</h4>
<div class="paragraph">
<p>If you are running your application in an application server, Spring Boot tries to locate a JMS <code>ConnectionFactory</code> by using JNDI.
By default, the <code>java:/JmsXA</code> and <code>java:/XAConnectionFactory</code> location are checked.
You can use the <code>spring.jms.jndi-name</code> property if you need to specify an alternative location, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.jms.jndi-name=java:/MyConnectionFactory</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  jms:
    jndi-name: "java:/MyConnectionFactory"</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.messaging.jms.sending"><a class="anchor" href="#features.messaging.jms.sending"></a>14.1.4. Sending a Message</h4>
<div class="paragraph">
<p>Spring&#8217;s <code>JmsTemplate</code> is auto-configured, and you can autowire it directly into your own beans, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.jms.core.JmsTemplate;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    private final JmsTemplate jmsTemplate;

    public MyBean(JmsTemplate jmsTemplate) {
        this.jmsTemplate = jmsTemplate;
    }

</span><span class="fold-block hide-when-unfolded">    // ...

</span><span class="fold-block hide-when-folded">    public void someMethod() {
        this.jmsTemplate.convertAndSend("hello");
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<a href="https://docs.spring.io/spring-framework/docs/5.3.9/javadoc-api/org/springframework/jms/core/JmsMessagingTemplate.html"><code>JmsMessagingTemplate</code></a> can be injected in a similar manner.
If a <code>DestinationResolver</code> or a <code>MessageConverter</code> bean is defined, it is associated automatically to the auto-configured <code>JmsTemplate</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.messaging.jms.receiving"><a class="anchor" href="#features.messaging.jms.receiving"></a>14.1.5. Receiving a Message</h4>
<div class="paragraph">
<p>When the JMS infrastructure is present, any bean can be annotated with <code>@JmsListener</code> to create a listener endpoint.
If no <code>JmsListenerContainerFactory</code> has been defined, a default one is configured automatically.
If a <code>DestinationResolver</code>, a <code>MessageConverter</code>, or a <code>javax.jms.ExceptionListener</code> beans are defined, they are associated automatically with the default factory.</p>
</div>
<div class="paragraph">
<p>By default, the default factory is transactional.
If you run in an infrastructure where a <code>JtaTransactionManager</code> is present, it is associated to the listener container by default.
If not, the <code>sessionTransacted</code> flag is enabled.
In that latter scenario, you can associate your local data store transaction to the processing of an incoming message by adding <code>@Transactional</code> on your listener method (or a delegate thereof).
This ensures that the incoming message is acknowledged, once the local transaction has completed.
This also includes sending response messages that have been performed on the same JMS session.</p>
</div>
<div class="paragraph">
<p>The following component creates a listener endpoint on the <code>someQueue</code> destination:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.jms.annotation.JmsListener;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    @JmsListener(destination = "someQueue")
    public void processMessage(String content) {
        // ...
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="https://docs.spring.io/spring-framework/docs/5.3.9/javadoc-api/org/springframework/jms/annotation/EnableJms.html">the Javadoc of <code>@EnableJms</code></a> for more details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you need to create more <code>JmsListenerContainerFactory</code> instances or if you want to override the default, Spring Boot provides a <code>DefaultJmsListenerContainerFactoryConfigurer</code> that you can use to initialize a <code>DefaultJmsListenerContainerFactory</code> with the same settings as the one that is auto-configured.</p>
</div>
<div class="paragraph">
<p>For instance, the following example exposes another factory that uses a specific <code>MessageConverter</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import javax.jms.ConnectionFactory;

import org.springframework.boot.autoconfigure.jms.DefaultJmsListenerContainerFactoryConfigurer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.jms.config.DefaultJmsListenerContainerFactory;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyJmsConfiguration {

    @Bean
    public DefaultJmsListenerContainerFactory myFactory(DefaultJmsListenerContainerFactoryConfigurer configurer) {
        DefaultJmsListenerContainerFactory factory = new DefaultJmsListenerContainerFactory();
        ConnectionFactory connectionFactory = getCustomConnectionFactory();
        configurer.configure(factory, connectionFactory);
        factory.setMessageConverter(new MyMessageConverter());
        return factory;
    }

    private ConnectionFactory getCustomConnectionFactory() {
        return ...
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then you can use the factory in any <code>@JmsListener</code>-annotated method as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.jms.annotation.JmsListener;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    @JmsListener(destination = "someQueue", containerFactory = "myFactory")
    public void processMessage(String content) {
        // ...
    }

}
</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.messaging.amqp"><a class="anchor" href="#features.messaging.amqp"></a>14.2. AMQP</h3>
<div class="paragraph">
<p>The Advanced Message Queuing Protocol (AMQP) is a platform-neutral, wire-level protocol for message-oriented middleware.
The Spring AMQP project applies core Spring concepts to the development of AMQP-based messaging solutions.
Spring Boot offers several conveniences for working with AMQP through RabbitMQ, including the <code>spring-boot-starter-amqp</code> &#8220;Starter&#8221;.</p>
</div>
<div class="sect3">
<h4 id="features.messaging.amqp.rabbitmq"><a class="anchor" href="#features.messaging.amqp.rabbitmq"></a>14.2.1. RabbitMQ support</h4>
<div class="paragraph">
<p><a href="https://www.rabbitmq.com/">RabbitMQ</a> is a lightweight, reliable, scalable, and portable message broker based on the AMQP protocol.
Spring uses <code>RabbitMQ</code> to communicate through the AMQP protocol.</p>
</div>
<div class="paragraph">
<p>RabbitMQ configuration is controlled by external configuration properties in <code>spring.rabbitmq.*</code>.
For example, you might declare the following section in <code>application.properties</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.rabbitmq.host=localhost
spring.rabbitmq.port=5672
spring.rabbitmq.username=admin
spring.rabbitmq.password=secret</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  rabbitmq:
    host: "localhost"
    port: 5672
    username: "admin"
    password: "secret"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, you could configure the same connection using the <code>addresses</code> attribute:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.rabbitmq.addresses=amqp://admin:<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0c7f696f7e69784c60636f6d6064637f78">[email&#160;protected]</a></code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  rabbitmq:
    addresses: "amqp://admin:<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="483b2d2b3a2d3c0824272b292420273b3c">[email&#160;protected]</a>"</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When specifying addresses that way, the <code>host</code> and <code>port</code> properties are ignored.
If the address uses the <code>amqps</code> protocol, SSL support is enabled automatically.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/amqp/RabbitProperties.java"><code>RabbitProperties</code></a> for more of the supported property-based configuration options.
To configure lower-level details of the RabbitMQ <code>ConnectionFactory</code> that is used by Spring AMQP, define a <code>ConnectionFactoryCustomizer</code> bean.</p>
</div>
<div class="paragraph">
<p>If a <code>ConnectionNameStrategy</code> bean exists in the context, it will be automatically used to name connections created by the auto-configured <code>CachingConnectionFactory</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="https://spring.io/blog/2010/06/14/understanding-amqp-the-protocol-used-by-rabbitmq/">Understanding AMQP, the protocol used by RabbitMQ</a> for more details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.messaging.amqp.sending"><a class="anchor" href="#features.messaging.amqp.sending"></a>14.2.2. Sending a Message</h4>
<div class="paragraph">
<p>Spring&#8217;s <code>AmqpTemplate</code> and <code>AmqpAdmin</code> are auto-configured, and you can autowire them directly into your own beans, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.amqp.core.AmqpAdmin;
import org.springframework.amqp.core.AmqpTemplate;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    private final AmqpAdmin amqpAdmin;

    private final AmqpTemplate amqpTemplate;

    public MyBean(AmqpAdmin amqpAdmin, AmqpTemplate amqpTemplate) {
        this.amqpAdmin = amqpAdmin;
        this.amqpTemplate = amqpTemplate;
    }

</span><span class="fold-block hide-when-unfolded">    // ...

</span><span class="fold-block hide-when-folded">    public void someMethod() {
        this.amqpAdmin.getQueueInfo("someQueue");
    }

    public void someOtherMethod() {
        this.amqpTemplate.convertAndSend("hello");
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<a href="https://docs.spring.io/spring-amqp/docs/2.3.10/api/org/springframework/amqp/rabbit/core/RabbitMessagingTemplate.html"><code>RabbitMessagingTemplate</code></a> can be injected in a similar manner.
If a <code>MessageConverter</code> bean is defined, it is associated automatically to the auto-configured <code>AmqpTemplate</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If necessary, any <code>org.springframework.amqp.core.Queue</code> that is defined as a bean is automatically used to declare a corresponding queue on the RabbitMQ instance.</p>
</div>
<div class="paragraph">
<p>To retry operations, you can enable retries on the <code>AmqpTemplate</code> (for example, in the event that the broker connection is lost):</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.rabbitmq.template.retry.enabled=true
spring.rabbitmq.template.retry.initial-interval=2s</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  rabbitmq:
    template:
      retry:
        enabled: true
        initial-interval: "2s"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Retries are disabled by default.
You can also customize the <code>RetryTemplate</code> programmatically by declaring a <code>RabbitRetryTemplateCustomizer</code> bean.</p>
</div>
<div class="paragraph">
<p>If you need to create more <code>RabbitTemplate</code> instances or if you want to override the default, Spring Boot provides a <code>RabbitTemplateConfigurer</code> bean that you can use to initialize a <code>RabbitTemplate</code> with the same settings as the factories used by the auto-configuration.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.messaging.amqp.receiving"><a class="anchor" href="#features.messaging.amqp.receiving"></a>14.2.3. Receiving a Message</h4>
<div class="paragraph">
<p>When the Rabbit infrastructure is present, any bean can be annotated with <code>@RabbitListener</code> to create a listener endpoint.
If no <code>RabbitListenerContainerFactory</code> has been defined, a default <code>SimpleRabbitListenerContainerFactory</code> is automatically configured and you can switch to a direct container using the <code>spring.rabbitmq.listener.type</code> property.
If a <code>MessageConverter</code> or a <code>MessageRecoverer</code> bean is defined, it is automatically associated with the default factory.</p>
</div>
<div class="paragraph">
<p>The following sample component creates a listener endpoint on the <code>someQueue</code> queue:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.amqp.rabbit.annotation.RabbitListener;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    @RabbitListener(queues = "someQueue")
    public void processMessage(String content) {
        // ...
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See <a href="https://docs.spring.io/spring-amqp/docs/2.3.10/api/org/springframework/amqp/rabbit/annotation/EnableRabbit.html">the Javadoc of <code>@EnableRabbit</code></a> for more details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you need to create more <code>RabbitListenerContainerFactory</code> instances or if you want to override the default, Spring Boot provides a <code>SimpleRabbitListenerContainerFactoryConfigurer</code> and a <code>DirectRabbitListenerContainerFactoryConfigurer</code> that you can use to initialize a <code>SimpleRabbitListenerContainerFactory</code> and a <code>DirectRabbitListenerContainerFactory</code> with the same settings as the factories used by the auto-configuration.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
It does not matter which container type you chose.
Those two beans are exposed by the auto-configuration.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For instance, the following configuration class exposes another factory that uses a specific <code>MessageConverter</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.amqp.rabbit.config.SimpleRabbitListenerContainerFactory;
import org.springframework.amqp.rabbit.connection.ConnectionFactory;
import org.springframework.boot.autoconfigure.amqp.SimpleRabbitListenerContainerFactoryConfigurer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyRabbitConfiguration {

    @Bean
    public SimpleRabbitListenerContainerFactory myFactory(SimpleRabbitListenerContainerFactoryConfigurer configurer) {
        SimpleRabbitListenerContainerFactory factory = new SimpleRabbitListenerContainerFactory();
        ConnectionFactory connectionFactory = getCustomConnectionFactory();
        configurer.configure(factory, connectionFactory);
        factory.setMessageConverter(new MyMessageConverter());
        return factory;
    }

    private ConnectionFactory getCustomConnectionFactory() {
        return ...
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Then you can use the factory in any <code>@RabbitListener</code>-annotated method, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.amqp.rabbit.annotation.RabbitListener;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    @RabbitListener(queues = "someQueue", containerFactory = "myFactory")
    public void processMessage(String content) {
        // ...
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can enable retries to handle situations where your listener throws an exception.
By default, <code>RejectAndDontRequeueRecoverer</code> is used, but you can define a <code>MessageRecoverer</code> of your own.
When retries are exhausted, the message is rejected and either dropped or routed to a dead-letter exchange if the broker is configured to do so.
By default, retries are disabled.
You can also customize the <code>RetryTemplate</code> programmatically by declaring a <code>RabbitRetryTemplateCustomizer</code> bean.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
By default, if retries are disabled and the listener throws an exception, the delivery is retried indefinitely.
You can modify this behavior in two ways: Set the <code>defaultRequeueRejected</code> property to <code>false</code> so that zero re-deliveries are attempted or throw an <code>AmqpRejectAndDontRequeueException</code> to signal the message should be rejected.
The latter is the mechanism used when retries are enabled and the maximum number of delivery attempts is reached.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.messaging.kafka"><a class="anchor" href="#features.messaging.kafka"></a>14.3. Apache Kafka Support</h3>
<div class="paragraph">
<p><a href="https://kafka.apache.org/">Apache Kafka</a> is supported by providing auto-configuration of the <code>spring-kafka</code> project.</p>
</div>
<div class="paragraph">
<p>Kafka configuration is controlled by external configuration properties in <code>spring.kafka.*</code>.
For example, you might declare the following section in <code>application.properties</code>:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.kafka.bootstrap-servers=localhost:9092
spring.kafka.consumer.group-id=myGroup</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  kafka:
    bootstrap-servers: "localhost:9092"
    consumer:
      group-id: "myGroup"</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
To create a topic on startup, add a bean of type <code>NewTopic</code>.
If the topic already exists, the bean is ignored.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/kafka/KafkaProperties.java"><code>KafkaProperties</code></a> for more supported options.</p>
</div>
<div class="sect3">
<h4 id="features.messaging.kafka.sending"><a class="anchor" href="#features.messaging.kafka.sending"></a>14.3.1. Sending a Message</h4>
<div class="paragraph">
<p>Spring&#8217;s <code>KafkaTemplate</code> is auto-configured, and you can autowire it directly in your own beans, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.kafka.core.KafkaTemplate;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    private final KafkaTemplate&lt;String, String&gt; kafkaTemplate;

    public MyBean(KafkaTemplate&lt;String, String&gt; kafkaTemplate) {
        this.kafkaTemplate = kafkaTemplate;
    }

</span><span class="fold-block hide-when-unfolded">    // ...

</span><span class="fold-block hide-when-folded">    public void someMethod() {
        this.kafkaTemplate.send("someTopic", "Hello");
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the property <code>spring.kafka.producer.transaction-id-prefix</code> is defined, a <code>KafkaTransactionManager</code> is automatically configured.
Also, if a <code>RecordMessageConverter</code> bean is defined, it is automatically associated to the auto-configured <code>KafkaTemplate</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.messaging.kafka.receiving"><a class="anchor" href="#features.messaging.kafka.receiving"></a>14.3.2. Receiving a Message</h4>
<div class="paragraph">
<p>When the Apache Kafka infrastructure is present, any bean can be annotated with <code>@KafkaListener</code> to create a listener endpoint.
If no <code>KafkaListenerContainerFactory</code> has been defined, a default one is automatically configured with keys defined in <code>spring.kafka.listener.*</code>.</p>
</div>
<div class="paragraph">
<p>The following component creates a listener endpoint on the <code>someTopic</code> topic:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.kafka.annotation.KafkaListener;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    @KafkaListener(topics = "someTopic")
    public void processMessage(String content) {
        // ...
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If a <code>KafkaTransactionManager</code> bean is defined, it is automatically associated to the container factory.
Similarly, if a <code>RecordFilterStrategy</code>, <code>ErrorHandler</code>, <code>AfterRollbackProcessor</code> or <code>ConsumerAwareRebalanceListener</code> bean is defined, it is automatically associated to the default factory.</p>
</div>
<div class="paragraph">
<p>Depending on the listener type, a <code>RecordMessageConverter</code> or <code>BatchMessageConverter</code> bean is associated to the default factory.
If only a <code>RecordMessageConverter</code> bean is present for a batch listener, it is wrapped in a <code>BatchMessageConverter</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A custom <code>ChainedKafkaTransactionManager</code> must be marked <code>@Primary</code> as it usually references the auto-configured <code>KafkaTransactionManager</code> bean.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.messaging.kafka.streams"><a class="anchor" href="#features.messaging.kafka.streams"></a>14.3.3. Kafka Streams</h4>
<div class="paragraph">
<p>Spring for Apache Kafka provides a factory bean to create a <code>StreamsBuilder</code> object and manage the lifecycle of its streams.
Spring Boot auto-configures the required <code>KafkaStreamsConfiguration</code> bean as long as <code>kafka-streams</code> is on the classpath and Kafka Streams is enabled via the <code>@EnableKafkaStreams</code> annotation.</p>
</div>
<div class="paragraph">
<p>Enabling Kafka Streams means that the application id and bootstrap servers must be set.
The former can be configured using <code>spring.kafka.streams.application-id</code>, defaulting to <code>spring.application.name</code> if not set.
The latter can be set globally or specifically overridden only for streams.</p>
</div>
<div class="paragraph">
<p>Several additional properties are available using dedicated properties; other arbitrary Kafka properties can be set using the <code>spring.kafka.streams.properties</code> namespace.
See also <a href="#features.messaging.kafka.additional-properties">Additional Kafka Properties</a> for more information.</p>
</div>
<div class="paragraph">
<p>To use the factory bean, wire <code>StreamsBuilder</code> into your <code>@Bean</code> as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.apache.kafka.common.serialization.Serdes;
import org.apache.kafka.streams.KeyValue;
import org.apache.kafka.streams.StreamsBuilder;
import org.apache.kafka.streams.kstream.KStream;
import org.apache.kafka.streams.kstream.Produced;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.kafka.annotation.EnableKafkaStreams;
import org.springframework.kafka.support.serializer.JsonSerde;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
@EnableKafkaStreams
public class MyKafkaStreamsConfiguration {

    @Bean
    public KStream&lt;Integer, String&gt; kStream(StreamsBuilder streamsBuilder) {
        KStream&lt;Integer, String&gt; stream = streamsBuilder.stream("ks1In");
        stream.map(this::uppercaseValue).to("ks1Out", Produced.with(Serdes.Integer(), new JsonSerde&lt;&gt;()));
        return stream;
    }

    private KeyValue&lt;Integer, String&gt; uppercaseValue(Integer key, String value) {
        return new KeyValue&lt;&gt;(key, value.toUpperCase());
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, the streams managed by the <code>StreamBuilder</code> object it creates are started automatically.
You can customize this behavior using the <code>spring.kafka.streams.auto-startup</code> property.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.messaging.kafka.additional-properties"><a class="anchor" href="#features.messaging.kafka.additional-properties"></a>14.3.4. Additional Kafka Properties</h4>
<div class="paragraph">
<p>The properties supported by auto configuration are shown in <a href="application-properties.html#application-properties">application-properties.html</a>.
Note that, for the most part, these properties (hyphenated or camelCase) map directly to the Apache Kafka dotted properties.
Refer to the Apache Kafka documentation for details.</p>
</div>
<div class="paragraph">
<p>The first few of these properties apply to all components (producers, consumers, admins, and streams) but can be specified at the component level if you wish to use different values.
Apache Kafka designates properties with an importance of HIGH, MEDIUM, or LOW.
Spring Boot auto-configuration supports all HIGH importance properties, some selected MEDIUM and LOW properties, and any properties that do not have a default value.</p>
</div>
<div class="paragraph">
<p>Only a subset of the properties supported by Kafka are available directly through the <code>KafkaProperties</code> class.
If you wish to configure the producer or consumer with additional properties that are not directly supported, use the following properties:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.kafka.properties[prop.one]=first
spring.kafka.admin.properties[prop.two]=second
spring.kafka.consumer.properties[prop.three]=third
spring.kafka.producer.properties[prop.four]=fourth
spring.kafka.streams.properties[prop.five]=fifth</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  kafka:
    properties:
      "[prop.one]": "first"
    admin:
      properties:
        "[prop.two]": "second"
    consumer:
      properties:
        "[prop.three]": "third"
    producer:
      properties:
        "[prop.four]": "fourth"
    streams:
      properties:
        "[prop.five]": "fifth"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This sets the common <code>prop.one</code> Kafka property to <code>first</code> (applies to producers, consumers and admins), the <code>prop.two</code> admin property to <code>second</code>, the <code>prop.three</code> consumer property to <code>third</code>, the <code>prop.four</code> producer property to <code>fourth</code> and the <code>prop.five</code> streams property to <code>fifth</code>.</p>
</div>
<div class="paragraph">
<p>You can also configure the Spring Kafka <code>JsonDeserializer</code> as follows:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.kafka.consumer.value-deserializer=org.springframework.kafka.support.serializer.JsonDeserializer
spring.kafka.consumer.properties[spring.json.value.default.type]=com.example.Invoice
spring.kafka.consumer.properties[spring.json.trusted.packages]=com.example.main,com.example.another</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  kafka:
    consumer:
      value-deserializer: "org.springframework.kafka.support.serializer.JsonDeserializer"
      properties:
        "[spring.json.value.default.type]": "com.example.Invoice"
        "[spring.json.trusted.packages]": "com.example.main,com.example.another"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, you can disable the <code>JsonSerializer</code> default behavior of sending type information in headers:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.kafka.producer.value-serializer=org.springframework.kafka.support.serializer.JsonSerializer
spring.kafka.producer.properties[spring.json.add.type.headers]=false</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  kafka:
    producer:
      value-serializer: "org.springframework.kafka.support.serializer.JsonSerializer"
      properties:
        "[spring.json.add.type.headers]": false</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Properties set in this way override any configuration item that Spring Boot explicitly supports.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.messaging.kafka.embedded"><a class="anchor" href="#features.messaging.kafka.embedded"></a>14.3.5. Testing with Embedded Kafka</h4>
<div class="paragraph">
<p>Spring for Apache Kafka provides a convenient way to test projects with an embedded Apache Kafka broker.
To use this feature, annotate a test class with <code>@EmbeddedKafka</code> from the <code>spring-kafka-test</code> module.
For more information, please see the Spring for Apache Kafka <a href="https://docs.spring.io/spring-kafka/docs/2.7.4/reference/html/#embedded-kafka-annotation">reference manual</a>.</p>
</div>
<div class="paragraph">
<p>To make Spring Boot auto-configuration work with the aforementioned embedded Apache Kafka broker, you need to remap a system property for embedded broker addresses (populated by the <code>EmbeddedKafkaBroker</code>) into the Spring Boot configuration property for Apache Kafka.
There are several ways to do that:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Provide a system property to map embedded broker addresses into <code>spring.kafka.bootstrap-servers</code> in the test class:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">static {
    System.setProperty(EmbeddedKafkaBroker.BROKER_LIST_PROPERTY, "spring.kafka.bootstrap-servers");
}
</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Configure a property name on the <code>@EmbeddedKafka</code> annotation:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.kafka.test.context.EmbeddedKafka;

</span><span class="fold-block">@SpringBootTest
@EmbeddedKafka(topics = "someTopic", bootstrapServersProperty = "spring.kafka.bootstrap-servers")
class MyTest {

    // ...

}
</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Use a placeholder in configuration properties:</p>
</li>
</ul>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.kafka.bootstrap-servers=${spring.embedded.kafka.brokers}</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  kafka:
    bootstrap-servers: "${spring.embedded.kafka.brokers}"</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.resttemplate"><a class="anchor" href="#features.resttemplate"></a>15. Calling REST Services with RestTemplate</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you need to call remote REST services from your application, you can use the Spring Framework&#8217;s <a href="https://docs.spring.io/spring-framework/docs/5.3.9/javadoc-api/org/springframework/web/client/RestTemplate.html"><code>RestTemplate</code></a> class.
Since <code>RestTemplate</code> instances often need to be customized before being used, Spring Boot does not provide any single auto-configured <code>RestTemplate</code> bean.
It does, however, auto-configure a <code>RestTemplateBuilder</code>, which can be used to create <code>RestTemplate</code> instances when needed.
The auto-configured <code>RestTemplateBuilder</code> ensures that sensible <code>HttpMessageConverters</code> are applied to <code>RestTemplate</code> instances.</p>
</div>
<div class="paragraph">
<p>The following code shows a typical example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.web.client.RestTemplateBuilder;
import org.springframework.stereotype.Service;
import org.springframework.web.client.RestTemplate;

</span><span class="fold-block">@Service
public class MyService {

    private final RestTemplate restTemplate;

    public MyService(RestTemplateBuilder restTemplateBuilder) {
        this.restTemplate = restTemplateBuilder.build();
    }

    public Details someRestCall(String name) {
        return this.restTemplate.getForObject("/{name}/details", Details.class, name);
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>RestTemplateBuilder</code> includes a number of useful methods that can be used to quickly configure a <code>RestTemplate</code>.
For example, to add BASIC auth support, you can use <code>builder.basicAuthentication("user", "password").build()</code>.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="features.resttemplate.customization"><a class="anchor" href="#features.resttemplate.customization"></a>15.1. RestTemplate Customization</h3>
<div class="paragraph">
<p>There are three main approaches to <code>RestTemplate</code> customization, depending on how broadly you want the customizations to apply.</p>
</div>
<div class="paragraph">
<p>To make the scope of any customizations as narrow as possible, inject the auto-configured <code>RestTemplateBuilder</code> and then call its methods as required.
Each method call returns a new <code>RestTemplateBuilder</code> instance, so the customizations only affect this use of the builder.</p>
</div>
<div class="paragraph">
<p>To make an application-wide, additive customization, use a <code>RestTemplateCustomizer</code> bean.
All such beans are automatically registered with the auto-configured <code>RestTemplateBuilder</code> and are applied to any templates that are built with it.</p>
</div>
<div class="paragraph">
<p>The following example shows a customizer that configures the use of a proxy for all hosts except <code>192.168.0.5</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.apache.http.HttpException;
import org.apache.http.HttpHost;
import org.apache.http.HttpRequest;
import org.apache.http.client.HttpClient;
import org.apache.http.conn.routing.HttpRoutePlanner;
import org.apache.http.impl.client.HttpClientBuilder;
import org.apache.http.impl.conn.DefaultProxyRoutePlanner;
import org.apache.http.protocol.HttpContext;

import org.springframework.boot.web.client.RestTemplateCustomizer;
import org.springframework.http.client.HttpComponentsClientHttpRequestFactory;
import org.springframework.web.client.RestTemplate;

</span><span class="fold-block">public class MyRestTemplateCustomizer implements RestTemplateCustomizer {

    @Override
    public void customize(RestTemplate restTemplate) {
        HttpRoutePlanner routePlanner = new CustomRoutePlanner(new HttpHost("proxy.example.com"));
        HttpClient httpClient = HttpClientBuilder.create().setRoutePlanner(routePlanner).build();
        restTemplate.setRequestFactory(new HttpComponentsClientHttpRequestFactory(httpClient));
    }

    static class CustomRoutePlanner extends DefaultProxyRoutePlanner {

        CustomRoutePlanner(HttpHost proxy) {
            super(proxy);
        }

        @Override
        public HttpHost determineProxy(HttpHost target, HttpRequest request, HttpContext context) throws HttpException {
            if (target.getHostName().equals("192.168.0.5")) {
                return null;
            }
            return super.determineProxy(target, request, context);
        }

    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, you can also create your own <code>RestTemplateBuilder</code> bean.
To prevent switching off the auto-configuration of a <code>RestTemplateBuilder</code> and prevent any <code>RestTemplateCustomizer</code> beans from being used, make sure to configure your custom instance with a <code>RestTemplateBuilderConfigurer</code>.
The following example exposes a <code>RestTemplateBuilder</code> with what Spring Boot would auto-configure, except that custom connect and read timeouts are also specified:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.time.Duration;

import org.springframework.boot.autoconfigure.web.client.RestTemplateBuilderConfigurer;
import org.springframework.boot.web.client.RestTemplateBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyRestTemplateBuilderConfiguration {

    @Bean
    public RestTemplateBuilder restTemplateBuilder(RestTemplateBuilderConfigurer configurer) {
        return configurer.configure(new RestTemplateBuilder()).setConnectTimeout(Duration.ofSeconds(5))
                .setReadTimeout(Duration.ofSeconds(2));
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The most extreme (and rarely used) option is to create your own <code>RestTemplateBuilder</code> bean without using a configurer.
Doing so switches off the auto-configuration of a <code>RestTemplateBuilder</code> and prevents any <code>RestTemplateCustomizer</code> beans from being used.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.webclient"><a class="anchor" href="#features.webclient"></a>16. Calling REST Services with WebClient</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you have Spring WebFlux on your classpath, you can also choose to use <code>WebClient</code> to call remote REST services.
Compared to <code>RestTemplate</code>, this client has a more functional feel and is fully reactive.
You can learn more about the <code>WebClient</code> in the dedicated <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/web-reactive.html#webflux-client">section in the Spring Framework docs</a>.</p>
</div>
<div class="paragraph">
<p>Spring Boot creates and pre-configures a <code>WebClient.Builder</code> for you.
It is strongly advised to inject it in your components and use it to create <code>WebClient</code> instances.
Spring Boot is configuring that builder to share HTTP resources, reflect codecs setup in the same fashion as the server ones (see <a href="#features.developing-web-applications.spring-webflux.httpcodecs">WebFlux HTTP codecs auto-configuration</a>), and more.</p>
</div>
<div class="paragraph">
<p>The following code shows a typical example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.neo4j.cypherdsl.core.Relationship.Details;
import reactor.core.publisher.Mono;

import org.springframework.stereotype.Service;
import org.springframework.web.reactive.function.client.WebClient;

</span><span class="fold-block">@Service
public class MyService {

    private final WebClient webClient;

    public MyService(WebClient.Builder webClientBuilder) {
        this.webClient = webClientBuilder.baseUrl("https://example.org").build();
    }

    public Mono&lt;Details&gt; someRestCall(String name) {
        return this.webClient.get().uri("/{name}/details", name).retrieve().bodyToMono(Details.class);
    }

}
</span></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="features.webclient.runtime"><a class="anchor" href="#features.webclient.runtime"></a>16.1. WebClient Runtime</h3>
<div class="paragraph">
<p>Spring Boot will auto-detect which <code>ClientHttpConnector</code> to use to drive <code>WebClient</code>, depending on the libraries available on the application classpath.
For now, Reactor Netty and Jetty RS client are supported.</p>
</div>
<div class="paragraph">
<p>The <code>spring-boot-starter-webflux</code> starter depends on <code>io.projectreactor.netty:reactor-netty</code> by default, which brings both server and client implementations.
If you choose to use Jetty as a reactive server instead, you should add a dependency on the Jetty Reactive HTTP client library, <code>org.eclipse.jetty:jetty-reactive-httpclient</code>.
Using the same technology for server and client has it advantages, as it will automatically share HTTP resources between client and server.</p>
</div>
<div class="paragraph">
<p>Developers can override the resource configuration for Jetty and Reactor Netty by providing a custom <code>ReactorResourceFactory</code> or <code>JettyResourceFactory</code> bean - this will be applied to both clients and servers.</p>
</div>
<div class="paragraph">
<p>If you wish to override that choice for the client, you can define your own <code>ClientHttpConnector</code> bean and have full control over the client configuration.</p>
</div>
<div class="paragraph">
<p>You can learn more about the <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/web-reactive.html#webflux-client-builder"><code>WebClient</code> configuration options in the Spring Framework reference documentation</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.webclient.customization"><a class="anchor" href="#features.webclient.customization"></a>16.2. WebClient Customization</h3>
<div class="paragraph">
<p>There are three main approaches to <code>WebClient</code> customization, depending on how broadly you want the customizations to apply.</p>
</div>
<div class="paragraph">
<p>To make the scope of any customizations as narrow as possible, inject the auto-configured <code>WebClient.Builder</code> and then call its methods as required.
<code>WebClient.Builder</code> instances are stateful: Any change on the builder is reflected in all clients subsequently created with it.
If you want to create several clients with the same builder, you can also consider cloning the builder with <code>WebClient.Builder other = builder.clone();</code>.</p>
</div>
<div class="paragraph">
<p>To make an application-wide, additive customization to all <code>WebClient.Builder</code> instances, you can declare <code>WebClientCustomizer</code> beans and change the <code>WebClient.Builder</code> locally at the point of injection.</p>
</div>
<div class="paragraph">
<p>Finally, you can fall back to the original API and use <code>WebClient.create()</code>.
In that case, no auto-configuration or <code>WebClientCustomizer</code> is applied.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.validation"><a class="anchor" href="#features.validation"></a>17. Validation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The method validation feature supported by Bean Validation 1.1 is automatically enabled as long as a JSR-303 implementation (such as Hibernate validator) is on the classpath.
This lets bean methods be annotated with <code>javax.validation</code> constraints on their parameters and/or on their return value.
Target classes with such annotated methods need to be annotated with the <code>@Validated</code> annotation at the type level for their methods to be searched for inline constraint annotations.</p>
</div>
<div class="paragraph">
<p>For instance, the following service triggers the validation of the first argument, making sure its size is between 8 and 10:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import javax.validation.constraints.Size;

import org.springframework.stereotype.Service;
import org.springframework.validation.annotation.Validated;

</span><span class="fold-block">@Service
@Validated
public class MyBean {

    public Archive findByCodeAndAuthor(@Size(min = 8, max = 10) String code, Author author) {
        return ...
    }

}
</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.email"><a class="anchor" href="#features.email"></a>18. Sending Email</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Spring Framework provides an abstraction for sending email by using the <code>JavaMailSender</code> interface, and Spring Boot provides auto-configuration for it as well as a starter module.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
See the <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/integration.html#mail">reference documentation</a> for a detailed explanation of how you can use <code>JavaMailSender</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If <code>spring.mail.host</code> and the relevant libraries (as defined by <code>spring-boot-starter-mail</code>) are available, a default <code>JavaMailSender</code> is created if none exists.
The sender can be further customized by configuration items from the <code>spring.mail</code> namespace.
See <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/mail/MailProperties.java"><code>MailProperties</code></a> for more details.</p>
</div>
<div class="paragraph">
<p>In particular, certain default timeout values are infinite, and you may want to change that to avoid having a thread blocked by an unresponsive mail server, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.mail.properties[mail.smtp.connectiontimeout]=5000
spring.mail.properties[mail.smtp.timeout]=3000
spring.mail.properties[mail.smtp.writetimeout]=5000</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  mail:
    properties:
      "[mail.smtp.connectiontimeout]": 5000
      "[mail.smtp.timeout]": 3000
      "[mail.smtp.writetimeout]": 5000</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to configure a <code>JavaMailSender</code> with an existing <code>Session</code> from JNDI:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.mail.jndi-name=mail/Session</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  mail:
    jndi-name: "mail/Session"</code></pre>
</div>
</div>
<div class="paragraph">
<p>When a <code>jndi-name</code> is set, it takes precedence over all other Session-related settings.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.jta"><a class="anchor" href="#features.jta"></a>19. Distributed Transactions with JTA</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot supports distributed JTA transactions across multiple XA resources by using an <a href="https://www.atomikos.com/">Atomikos</a> embedded transaction manager.
JTA transactions are also supported when deploying to a suitable Java EE Application Server.</p>
</div>
<div class="paragraph">
<p>When a JTA environment is detected, Spring&#8217;s <code>JtaTransactionManager</code> is used to manage transactions.
Auto-configured JMS, DataSource, and JPA beans are upgraded to support XA transactions.
You can use standard Spring idioms, such as <code>@Transactional</code>, to participate in a distributed transaction.
If you are within a JTA environment and still want to use local transactions, you can set the <code>spring.jta.enabled</code> property to <code>false</code> to disable the JTA auto-configuration.</p>
</div>
<div class="sect2">
<h3 id="features.jta.atomikos"><a class="anchor" href="#features.jta.atomikos"></a>19.1. Using an Atomikos Transaction Manager</h3>
<div class="paragraph">
<p><a href="https://www.atomikos.com/">Atomikos</a> is a popular open source transaction manager which can be embedded into your Spring Boot application.
You can use the <code>spring-boot-starter-jta-atomikos</code> starter to pull in the appropriate Atomikos libraries.
Spring Boot auto-configures Atomikos and ensures that appropriate <code>depends-on</code> settings are applied to your Spring beans for correct startup and shutdown ordering.</p>
</div>
<div class="paragraph">
<p>By default, Atomikos transaction logs are written to a <code>transaction-logs</code> directory in your application&#8217;s home directory (the directory in which your application jar file resides).
You can customize the location of this directory by setting a <code>spring.jta.log-dir</code> property in your <code>application.properties</code> file.
Properties starting with <code>spring.jta.atomikos.properties</code> can also be used to customize the Atomikos <code>UserTransactionServiceImp</code>.
See the <a href="https://docs.spring.io/spring-boot/docs/2.5.3/api/org/springframework/boot/jta/atomikos/AtomikosProperties.html"><code>AtomikosProperties</code> Javadoc</a> for complete details.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
To ensure that multiple transaction managers can safely coordinate the same resource managers, each Atomikos instance must be configured with a unique ID.
By default, this ID is the IP address of the machine on which Atomikos is running.
To ensure uniqueness in production, you should configure the <code>spring.jta.transaction-manager-id</code> property with a different value for each instance of your application.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features.jta.javaee"><a class="anchor" href="#features.jta.javaee"></a>19.2. Using a Java EE Managed Transaction Manager</h3>
<div class="paragraph">
<p>If you package your Spring Boot application as a <code>war</code> or <code>ear</code> file and deploy it to a Java EE application server, you can use your application server&#8217;s built-in transaction manager.
Spring Boot tries to auto-configure a transaction manager by looking at common JNDI locations (<code>java:comp/UserTransaction</code>, <code>java:comp/TransactionManager</code>, and so on).
If you use a transaction service provided by your application server, you generally also want to ensure that all resources are managed by the server and exposed over JNDI.
Spring Boot tries to auto-configure JMS by looking for a <code>ConnectionFactory</code> at the JNDI path (<code>java:/JmsXA</code> or <code>java:/XAConnectionFactory</code>), and you can use the <a href="#features.sql.datasource.jndi"><code>spring.datasource.jndi-name</code> property</a> to configure your <code>DataSource</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.jta.mixing-xa-and-non-xa-connections"><a class="anchor" href="#features.jta.mixing-xa-and-non-xa-connections"></a>19.3. Mixing XA and Non-XA JMS Connections</h3>
<div class="paragraph">
<p>When using JTA, the primary JMS <code>ConnectionFactory</code> bean is XA-aware and participates in distributed transactions.
You can inject into your bean without needing to use any <code>@Qualifier</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public MyBean(ConnectionFactory connectionFactory) {
    // ...
}
</code></pre>
</div>
</div>
<div class="paragraph">
<p>In some situations, you might want to process certain JMS messages by using a non-XA <code>ConnectionFactory</code>.
For example, your JMS processing logic might take longer than the XA timeout.</p>
</div>
<div class="paragraph">
<p>If you want to use a non-XA <code>ConnectionFactory</code>, you can the <code>nonXaJmsConnectionFactory</code> bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public MyBean(@Qualifier("nonXaJmsConnectionFactory") ConnectionFactory connectionFactory) {
    // ...
}
</code></pre>
</div>
</div>
<div class="paragraph">
<p>For consistency, the <code>jmsConnectionFactory</code> bean is also provided by using the bean alias <code>xaJmsConnectionFactory</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">public MyBean(@Qualifier("xaJmsConnectionFactory") ConnectionFactory connectionFactory) {
    // ...
}
</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.jta.supporting-alternative-embedded-transaction-manager"><a class="anchor" href="#features.jta.supporting-alternative-embedded-transaction-manager"></a>19.4. Supporting an Alternative Embedded Transaction Manager</h3>
<div class="paragraph">
<p>The <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/jms/XAConnectionFactoryWrapper.java"><code>XAConnectionFactoryWrapper</code></a> and <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/jdbc/XADataSourceWrapper.java"><code>XADataSourceWrapper</code></a> interfaces can be used to support alternative embedded transaction managers.
The interfaces are responsible for wrapping <code>XAConnectionFactory</code> and <code>XADataSource</code> beans and exposing them as regular <code>ConnectionFactory</code> and <code>DataSource</code> beans, which transparently enroll in the distributed transaction.
DataSource and JMS auto-configuration use JTA variants, provided you have a <code>JtaTransactionManager</code> bean and appropriate XA wrapper beans registered within your <code>ApplicationContext</code>.</p>
</div>
<div class="paragraph">
<p>The <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/jta/atomikos/AtomikosXAConnectionFactoryWrapper.java">AtomikosXAConnectionFactoryWrapper</a> and <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/jta/atomikos/AtomikosXADataSourceWrapper.java">AtomikosXADataSourceWrapper</a> provide good examples of how to write XA wrappers.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.hazelcast"><a class="anchor" href="#features.hazelcast"></a>20. Hazelcast</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If <a href="https://hazelcast.com/">Hazelcast</a> is on the classpath and a suitable configuration is found, Spring Boot auto-configures a <code>HazelcastInstance</code> that you can inject in your application.</p>
</div>
<div class="paragraph">
<p>Spring Boot first attempts to create a client by checking the following configuration options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The presence of a <code>com.hazelcast.client.config.ClientConfig</code> bean.</p>
</li>
<li>
<p>A configuration file defined by the <code>spring.hazelcast.config</code> property.</p>
</li>
<li>
<p>The presence of the <code>hazelcast.client.config</code> system property.</p>
</li>
<li>
<p>A <code>hazelcast-client.xml</code> in the working directory or at the root of the classpath.</p>
</li>
<li>
<p>A <code>hazelcast-client.yaml</code> in the working directory or at the root of the classpath.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Spring Boot supports both Hazelcast 4 and Hazelcast 3.
If you downgrade to Hazelcast 3, <code>hazelcast-client</code> should be added to the classpath to configure a client.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If a client can&#8217;t be created, Spring Boot attempts to configure an embedded server.
If you define a <code>com.hazelcast.config.Config</code> bean, Spring Boot uses that.
If your configuration defines an instance name, Spring Boot tries to locate an existing instance rather than creating a new one.</p>
</div>
<div class="paragraph">
<p>You could also specify the Hazelcast configuration file to use through configuration, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.hazelcast.config=classpath:config/my-hazelcast.xml</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  hazelcast:
    config: "classpath:config/my-hazelcast.xml"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Otherwise, Spring Boot tries to find the Hazelcast configuration from the default locations: <code>hazelcast.xml</code> in the working directory or at the root of the classpath, or a <code>.yaml</code> counterpart in the same locations.
We also check if the <code>hazelcast.config</code> system property is set.
See the <a href="https://docs.hazelcast.org/docs/latest/manual/html-single/">Hazelcast documentation</a> for more details.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Spring Boot also has <a href="#features.caching.provider.hazelcast">explicit caching support for Hazelcast</a>.
If caching is enabled, the <code>HazelcastInstance</code> is automatically wrapped in a <code>CacheManager</code> implementation.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.quartz"><a class="anchor" href="#features.quartz"></a>21. Quartz Scheduler</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot offers several conveniences for working with the <a href="https://www.quartz-scheduler.org/">Quartz scheduler</a>, including the <code>spring-boot-starter-quartz</code> &#8220;Starter&#8221;.
If Quartz is available, a <code>Scheduler</code> is auto-configured (through the <code>SchedulerFactoryBean</code> abstraction).</p>
</div>
<div class="paragraph">
<p>Beans of the following types are automatically picked up and associated with the <code>Scheduler</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>JobDetail</code>: defines a particular Job.
<code>JobDetail</code> instances can be built with the <code>JobBuilder</code> API.</p>
</li>
<li>
<p><code>Calendar</code>.</p>
</li>
<li>
<p><code>Trigger</code>: defines when a particular job is triggered.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default, an in-memory <code>JobStore</code> is used.
However, it is possible to configure a JDBC-based store if a <code>DataSource</code> bean is available in your application and if the <code>spring.quartz.job-store-type</code> property is configured accordingly, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.quartz.job-store-type=jdbc</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  quartz:
    job-store-type: "jdbc"</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the JDBC store is used, the schema can be initialized on startup, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.quartz.jdbc.initialize-schema=always</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  quartz:
    jdbc:
      initialize-schema: "always"</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
By default, the database is detected and initialized by using the standard scripts provided with the Quartz library.
These scripts drop existing tables, deleting all triggers on every restart.
It is also possible to provide a custom script by setting the <code>spring.quartz.jdbc.schema</code> property.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To have Quartz use a <code>DataSource</code> other than the application&#8217;s main <code>DataSource</code>, declare a <code>DataSource</code> bean, annotating its <code>@Bean</code> method with <code>@QuartzDataSource</code>.
Doing so ensures that the Quartz-specific <code>DataSource</code> is used by both the <code>SchedulerFactoryBean</code> and for schema initialization.
Similarly, to have Quartz use a <code>TransactionManager</code> other than the application&#8217;s main <code>TransactionManager</code> declare a <code>TransactionManager</code> bean, annotating its <code>@Bean</code> method with <code>@QuartzTransactionManager</code>.</p>
</div>
<div class="paragraph">
<p>By default, jobs created by configuration will not overwrite already registered jobs that have been read from a persistent job store.
To enable overwriting existing job definitions set the <code>spring.quartz.overwrite-existing-jobs</code> property.</p>
</div>
<div class="paragraph">
<p>Quartz Scheduler configuration can be customized using <code>spring.quartz</code> properties and <code>SchedulerFactoryBeanCustomizer</code> beans, which allow programmatic <code>SchedulerFactoryBean</code> customization.
Advanced Quartz configuration properties can be customized using <code>spring.quartz.properties.*</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In particular, an <code>Executor</code> bean is not associated with the scheduler as Quartz offers a way to configure the scheduler via <code>spring.quartz.properties</code>.
If you need to customize the task executor, consider implementing <code>SchedulerFactoryBeanCustomizer</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Jobs can define setters to inject data map properties.
Regular beans can also be injected in a similar manner, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.quartz.JobExecutionContext;
import org.quartz.JobExecutionException;

import org.springframework.scheduling.quartz.QuartzJobBean;

</span><span class="fold-block">public class MySampleJob extends QuartzJobBean {

</span><span class="fold-block hide-when-unfolded">    // fields ...

</span><span class="fold-block hide-when-folded">    private MyService myService;

    private String name;

</span><span class="fold-block">    // Inject "MyService" bean
    public void setMyService(MyService myService) {
        this.myService = myService;
    }

    // Inject the "name" job data property
    public void setName(String name) {
        this.name = name;
    }

    @Override
    protected void executeInternal(JobExecutionContext context) throws JobExecutionException {
        this.myService.someMethod(context.getFireTime(), this.name);
    }

}
</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.task-execution-and-scheduling"><a class="anchor" href="#features.task-execution-and-scheduling"></a>22. Task Execution and Scheduling</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the absence of an <code>Executor</code> bean in the context, Spring Boot auto-configures a <code>ThreadPoolTaskExecutor</code> with sensible defaults that can be automatically associated to asynchronous task execution (<code>@EnableAsync</code>) and Spring MVC asynchronous request processing.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you have defined a custom <code>Executor</code> in the context, regular task execution (i.e. <code>@EnableAsync</code>) will use it transparently but the Spring MVC support will not be configured as it requires an <code>AsyncTaskExecutor</code> implementation (named <code>applicationTaskExecutor</code>).
Depending on your target arrangement, you could change your <code>Executor</code> into a <code>ThreadPoolTaskExecutor</code> or define both a <code>ThreadPoolTaskExecutor</code> and an <code>AsyncConfigurer</code> wrapping your custom <code>Executor</code>.</p>
</div>
<div class="paragraph">
<p>The auto-configured <code>TaskExecutorBuilder</code> allows you to easily create instances that reproduce what the auto-configuration does by default.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The thread pool uses 8 core threads that can grow and shrink according to the load.
Those default settings can be fine-tuned using the <code>spring.task.execution</code> namespace, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.task.execution.pool.max-size=16
spring.task.execution.pool.queue-capacity=100
spring.task.execution.pool.keep-alive=10s</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  task:
    execution:
      pool:
        max-size: 16
        queue-capacity: 100
        keep-alive: "10s"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This changes the thread pool to use a bounded queue so that when the queue is full (100 tasks), the thread pool increases to maximum 16 threads.
Shrinking of the pool is more aggressive as threads are reclaimed when they are idle for 10 seconds (rather than 60 seconds by default).</p>
</div>
<div class="paragraph">
<p>A <code>ThreadPoolTaskScheduler</code> can also be auto-configured if need to be associated to scheduled task execution (e.g. <code>@EnableScheduling</code>).
The thread pool uses one thread by default and its settings can be fine-tuned using the <code>spring.task.scheduling</code> namespace, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.task.scheduling.thread-name-prefix=scheduling-
spring.task.scheduling.pool.size=2</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  task:
    scheduling:
      thread-name-prefix: "scheduling-"
      pool:
        size: 2</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both a <code>TaskExecutorBuilder</code> bean and a <code>TaskSchedulerBuilder</code> bean are made available in the context if a custom executor or scheduler needs to be created.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.spring-integration"><a class="anchor" href="#features.spring-integration"></a>23. Spring Integration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot offers several conveniences for working with <a href="https://spring.io/projects/spring-integration">Spring Integration</a>, including the <code>spring-boot-starter-integration</code> &#8220;Starter&#8221;.
Spring Integration provides abstractions over messaging and also other transports such as HTTP, TCP, and others.
If Spring Integration is available on your classpath, it is initialized through the <code>@EnableIntegration</code> annotation.</p>
</div>
<div class="paragraph">
<p>Spring Integration polling logic relies <a href="#features.task-execution-and-scheduling">on the auto-configured <code>TaskScheduler</code></a>.</p>
</div>
<div class="paragraph">
<p>Spring Boot also configures some features that are triggered by the presence of additional Spring Integration modules.
If <code>spring-integration-jmx</code> is also on the classpath, message processing statistics are published over JMX.
If <code>spring-integration-jdbc</code> is available, the default database schema can be created on startup, as shown in the following line:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.integration.jdbc.initialize-schema=always</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  integration:
    jdbc:
      initialize-schema: "always"</code></pre>
</div>
</div>
<div class="paragraph">
<p>If <code>spring-integration-rsocket</code> is available, developers can configure an RSocket server using <code>"spring.rsocket.server.*"</code> properties and let it use <code>IntegrationRSocketEndpoint</code> or <code>RSocketOutboundGateway</code> components to handle incoming RSocket messages.
This infrastructure can handle Spring Integration RSocket channel adapters and <code>@MessageMapping</code> handlers (given <code>"spring.integration.rsocket.server.message-mapping-enabled"</code> is configured).</p>
</div>
<div class="paragraph">
<p>Spring Boot can also auto-configure an <code>ClientRSocketConnector</code> using configuration properties:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties"># Connecting to a RSocket server over TCP
spring.integration.rsocket.client.host=example.org
spring.integration.rsocket.client.port=9898</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml"># Connecting to a RSocket server over TCP
spring:
  integration:
    rsocket:
      client:
        host: "example.org"
        port: 9898</code></pre>
</div>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties"># Connecting to a RSocket Server over WebSocket
spring.integration.rsocket.client.uri=ws://example.org</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml"># Connecting to a RSocket Server over WebSocket
spring:
  integration:
    rsocket:
      client:
        uri: "ws://example.org"</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/integration/IntegrationAutoConfiguration.java"><code>IntegrationAutoConfiguration</code></a> and <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/integration/IntegrationProperties.java"><code>IntegrationProperties</code></a> classes for more details.</p>
</div>
<div class="paragraph">
<p>By default, if a Micrometer <code>meterRegistry</code> bean is present, Spring Integration metrics will be managed by Micrometer.
If you wish to use legacy Spring Integration metrics, add a <code>DefaultMetricsFactory</code> bean to the application context.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.spring-session"><a class="anchor" href="#features.spring-session"></a>24. Spring Session</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot provides <a href="https://spring.io/projects/spring-session">Spring Session</a> auto-configuration for a wide range of data stores.
When building a Servlet web application, the following stores can be auto-configured:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JDBC</p>
</li>
<li>
<p>Redis</p>
</li>
<li>
<p>Hazelcast</p>
</li>
<li>
<p>MongoDB</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Servlet auto-configuration replaces the need to use <code>@Enable*HttpSession</code>.</p>
</div>
<div class="paragraph">
<p>When building a reactive web application, the following stores can be auto-configured:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Redis</p>
</li>
<li>
<p>MongoDB</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The reactive auto-configuration replaces the need to use <code>@Enable*WebSession</code>.</p>
</div>
<div class="paragraph">
<p>If a single Spring Session module is present on the classpath, Spring Boot uses that store implementation automatically.
If you have more than one implementation, you must choose the <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/session/StoreType.java"><code>StoreType</code></a> that you wish to use to store the sessions.
For instance, to use JDBC as the back-end store, you can configure your application as follows:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.session.store-type=jdbc</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  session:
    store-type: "jdbc"</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can disable Spring Session by setting the <code>store-type</code> to <code>none</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each store has specific additional settings.
For instance, it is possible to customize the name of the table for the JDBC store, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.session.jdbc.table-name=SESSIONS</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  session:
    jdbc:
      table-name: "SESSIONS"</code></pre>
</div>
</div>
<div class="paragraph">
<p>For setting the timeout of the session you can use the <code>spring.session.timeout</code> property.
If that property is not set with a Servlet web application, the auto-configuration falls back to the value of <code>server.servlet.session.timeout</code>.</p>
</div>
<div class="paragraph">
<p>You can take control over Spring Session&#8217;s configuration using <code>@Enable*HttpSession</code> (Servlet) or <code>@Enable*WebSession</code> (Reactive).
This will cause the auto-configuration to back off.
Spring Session can then be configured using the annotation&#8217;s attributes rather than the previously described configuration properties.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.jmx"><a class="anchor" href="#features.jmx"></a>25. Monitoring and Management over JMX</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Java Management Extensions (JMX) provide a standard mechanism to monitor and manage applications.
Spring Boot exposes the most suitable <code>MBeanServer</code> as a bean with an ID of <code>mbeanServer</code>.
Any of your beans that are annotated with Spring JMX annotations (<code>@ManagedResource</code>, <code>@ManagedAttribute</code>, or <code>@ManagedOperation</code>) are exposed to it.</p>
</div>
<div class="paragraph">
<p>If your platform provides a standard <code>MBeanServer</code>, Spring Boot will use that and default to the VM <code>MBeanServer</code> if necessary.
If all that fails, a new <code>MBeanServer</code> will be created.</p>
</div>
<div class="paragraph">
<p>See the <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jmx/JmxAutoConfiguration.java"><code>JmxAutoConfiguration</code></a> class for more details.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.testing"><a class="anchor" href="#features.testing"></a>26. Testing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot provides a number of utilities and annotations to help when testing your application.
Test support is provided by two modules: <code>spring-boot-test</code> contains core items, and <code>spring-boot-test-autoconfigure</code> supports auto-configuration for tests.</p>
</div>
<div class="paragraph">
<p>Most developers use the <code>spring-boot-starter-test</code> &#8220;Starter&#8221;, which imports both Spring Boot test modules as well as JUnit Jupiter, AssertJ, Hamcrest, and a number of other useful libraries.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you have tests that use JUnit 4, JUnit 5&#8217;s vintage engine can be used to run them.
To use the vintage engine, add a dependency on <code>junit-vintage-engine</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.junit.vintage&lt;/groupId&gt;
    &lt;artifactId&gt;junit-vintage-engine&lt;/artifactId&gt;
    &lt;scope&gt;test&lt;/scope&gt;
    &lt;exclusions&gt;
        &lt;exclusion&gt;
            &lt;groupId&gt;org.hamcrest&lt;/groupId&gt;
            &lt;artifactId&gt;hamcrest-core&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>hamcrest-core</code> is excluded in favor of <code>org.hamcrest:hamcrest</code> that is part of <code>spring-boot-starter-test</code>.</p>
</div>
<div class="sect2">
<h3 id="features.testing.test-scope-dependencies"><a class="anchor" href="#features.testing.test-scope-dependencies"></a>26.1. Test Scope Dependencies</h3>
<div class="paragraph">
<p>The <code>spring-boot-starter-test</code> &#8220;Starter&#8221; (in the <code>test</code> <code>scope</code>) contains the following provided libraries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://junit.org/junit5/">JUnit 5</a>: The de-facto standard for unit testing Java applications.</p>
</li>
<li>
<p><a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/testing.html#integration-testing">Spring Test</a> &amp; Spring Boot Test: Utilities and integration test support for Spring Boot applications.</p>
</li>
<li>
<p><a href="https://assertj.github.io/doc/">AssertJ</a>: A fluent assertion library.</p>
</li>
<li>
<p><a href="https://github.com/hamcrest/JavaHamcrest">Hamcrest</a>: A library of matcher objects (also known as constraints or predicates).</p>
</li>
<li>
<p><a href="https://site.mockito.org/">Mockito</a>: A Java mocking framework.</p>
</li>
<li>
<p><a href="https://github.com/skyscreamer/JSONassert">JSONassert</a>: An assertion library for JSON.</p>
</li>
<li>
<p><a href="https://github.com/jayway/JsonPath">JsonPath</a>: XPath for JSON.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We generally find these common libraries to be useful when writing tests.
If these libraries do not suit your needs, you can add additional test dependencies of your own.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.testing.spring-applications"><a class="anchor" href="#features.testing.spring-applications"></a>26.2. Testing Spring Applications</h3>
<div class="paragraph">
<p>One of the major advantages of dependency injection is that it should make your code easier to unit test.
You can instantiate objects by using the <code>new</code> operator without even involving Spring.
You can also use <em>mock objects</em> instead of real dependencies.</p>
</div>
<div class="paragraph">
<p>Often, you need to move beyond unit testing and start integration testing (with a Spring <code>ApplicationContext</code>).
It is useful to be able to perform integration testing without requiring deployment of your application or needing to connect to other infrastructure.</p>
</div>
<div class="paragraph">
<p>The Spring Framework includes a dedicated test module for such integration testing.
You can declare a dependency directly to <code>org.springframework:spring-test</code> or use the <code>spring-boot-starter-test</code> &#8220;Starter&#8221; to pull it in transitively.</p>
</div>
<div class="paragraph">
<p>If you have not used the <code>spring-test</code> module before, you should start by reading the <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/testing.html#testing">relevant section</a> of the Spring Framework reference documentation.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.testing.spring-boot-applications"><a class="anchor" href="#features.testing.spring-boot-applications"></a>26.3. Testing Spring Boot Applications</h3>
<div class="paragraph">
<p>A Spring Boot application is a Spring <code>ApplicationContext</code>, so nothing very special has to be done to test it beyond what you would normally do with a vanilla Spring context.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
External properties, logging, and other features of Spring Boot are installed in the context by default only if you use <code>SpringApplication</code> to create it.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Spring Boot provides a <code>@SpringBootTest</code> annotation, which can be used as an alternative to the standard <code>spring-test</code> <code>@ContextConfiguration</code> annotation when you need Spring Boot features.
The annotation works by <a href="#features.testing.spring-boot-applications.detecting-configuration">creating the <code>ApplicationContext</code> used in your tests through <code>SpringApplication</code></a>.
In addition to <code>@SpringBootTest</code> a number of other annotations are also provided for <a href="#features.testing.spring-boot-applications.autoconfigured-tests">testing more specific slices</a> of an application.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you are using JUnit 4, don&#8217;t forget to also add <code>@RunWith(SpringRunner.class)</code> to your test, otherwise the annotations will be ignored.
If you are using JUnit 5, there&#8217;s no need to add the equivalent <code>@ExtendWith(SpringExtension.class)</code> as <code>@SpringBootTest</code> and the other <code>@&#8230;&#8203;Test</code> annotations are already annotated with it.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, <code>@SpringBootTest</code> will not start a server.
You can use the <code>webEnvironment</code> attribute of <code>@SpringBootTest</code> to further refine how your tests run:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>MOCK</code>(Default) : Loads a web <code>ApplicationContext</code> and provides a mock web environment.
Embedded servers are not started when using this annotation.
If a web environment is not available on your classpath, this mode transparently falls back to creating a regular non-web <code>ApplicationContext</code>.
It can be used in conjunction with <a href="#features.testing.spring-boot-applications.with-mock-environment"><code>@AutoConfigureMockMvc</code> or <code>@AutoConfigureWebTestClient</code></a> for mock-based testing of your web application.</p>
</li>
<li>
<p><code>RANDOM_PORT</code>: Loads a <code>WebServerApplicationContext</code> and provides a real web environment.
Embedded servers are started and listen on a random port.</p>
</li>
<li>
<p><code>DEFINED_PORT</code>: Loads a <code>WebServerApplicationContext</code> and provides a real web environment.
Embedded servers are started and listen on a defined port (from your <code>application.properties</code>) or on the default port of <code>8080</code>.</p>
</li>
<li>
<p><code>NONE</code>: Loads an <code>ApplicationContext</code> by using <code>SpringApplication</code> but does not provide <em>any</em> web environment (mock or otherwise).</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If your test is <code>@Transactional</code>, it rolls back the transaction at the end of each test method by default.
However, as using this arrangement with either <code>RANDOM_PORT</code> or <code>DEFINED_PORT</code> implicitly provides a real servlet environment, the HTTP client and server run in separate threads and, thus, in separate transactions.
Any transaction initiated on the server does not roll back in this case.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>@SpringBootTest</code> with <code>webEnvironment = WebEnvironment.RANDOM_PORT</code> will also start the management server on a separate random port if your application uses a different port for the management server.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.detecting-web-app-type"><a class="anchor" href="#features.testing.spring-boot-applications.detecting-web-app-type"></a>26.3.1. Detecting Web Application Type</h4>
<div class="paragraph">
<p>If Spring MVC is available, a regular MVC-based application context is configured.
If you have only Spring WebFlux, we&#8217;ll detect that and configure a WebFlux-based application context instead.</p>
</div>
<div class="paragraph">
<p>If both are present, Spring MVC takes precedence.
If you want to test a reactive web application in this scenario, you must set the <code>spring.main.web-application-type</code> property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.test.context.SpringBootTest;

</span><span class="fold-block">@SpringBootTest(properties = "spring.main.web-application-type=reactive")
class MyWebFluxTests {

    // ...

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.detecting-configuration"><a class="anchor" href="#features.testing.spring-boot-applications.detecting-configuration"></a>26.3.2. Detecting Test Configuration</h4>
<div class="paragraph">
<p>If you are familiar with the Spring Test Framework, you may be used to using <code>@ContextConfiguration(classes=&#8230;&#8203;)</code> in order to specify which Spring <code>@Configuration</code> to load.
Alternatively, you might have often used nested <code>@Configuration</code> classes within your test.</p>
</div>
<div class="paragraph">
<p>When testing Spring Boot applications, this is often not required.
Spring Boot&#8217;s <code>@*Test</code> annotations search for your primary configuration automatically whenever you do not explicitly define one.</p>
</div>
<div class="paragraph">
<p>The search algorithm works up from the package that contains the test until it finds a class annotated with <code>@SpringBootApplication</code> or <code>@SpringBootConfiguration</code>.
As long as you <a href="using.html#using.structuring-your-code">structured your code</a> in a sensible way, your main configuration is usually found.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you use a <a href="#features.testing.spring-boot-applications.autoconfigured-tests">test annotation to test a more specific slice of your application</a>, you should avoid adding configuration settings that are specific to a particular area on the <a href="#features.testing.spring-boot-applications.user-configuration-and-slicing">main method&#8217;s application class</a>.</p>
</div>
<div class="paragraph">
<p>The underlying component scan configuration of <code>@SpringBootApplication</code> defines exclude filters that are used to make sure slicing works as expected.
If you are using an explicit <code>@ComponentScan</code> directive on your <code>@SpringBootApplication</code>-annotated class, be aware that those filters will be disabled.
If you are using slicing, you should define them again.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you want to customize the primary configuration, you can use a nested <code>@TestConfiguration</code> class.
Unlike a nested <code>@Configuration</code> class, which would be used instead of your application&#8217;s primary configuration, a nested <code>@TestConfiguration</code> class is used in addition to your application&#8217;s primary configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Spring&#8217;s test framework caches application contexts between tests.
Therefore, as long as your tests share the same configuration (no matter how it is discovered), the potentially time-consuming process of loading the context happens only once.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.excluding-configuration"><a class="anchor" href="#features.testing.spring-boot-applications.excluding-configuration"></a>26.3.3. Excluding Test Configuration</h4>
<div class="paragraph">
<p>If your application uses component scanning (for example, if you use <code>@SpringBootApplication</code> or <code>@ComponentScan</code>), you may find top-level configuration classes that you created only for specific tests accidentally get picked up everywhere.</p>
</div>
<div class="paragraph">
<p>As we <a href="#features.testing.spring-boot-applications.detecting-configuration">have seen earlier</a>, <code>@TestConfiguration</code> can be used on an inner class of a test to customize the primary configuration.
When placed on a top-level class, <code>@TestConfiguration</code> indicates that classes in <code>src/test/java</code> should not be picked up by scanning.
You can then import that class explicitly where it is required, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.context.annotation.Import;

</span><span class="fold-block">@SpringBootTest
@Import(MyTestsConfiguration.class)
class MyTests {

    @Test
    void exampleTest() {
        // ...
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you directly use <code>@ComponentScan</code> (that is, not through <code>@SpringBootApplication</code>) you need to register the <code>TypeExcludeFilter</code> with it.
See <a href="https://docs.spring.io/spring-boot/docs/2.5.3/api/org/springframework/boot/context/TypeExcludeFilter.html">the Javadoc</a> for details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.using-application-arguments"><a class="anchor" href="#features.testing.spring-boot-applications.using-application-arguments"></a>26.3.4. Using Application Arguments</h4>
<div class="paragraph">
<p>If your application expects <a href="#features.spring-application.application-arguments">arguments</a>, you can
have <code>@SpringBootTest</code> inject them using the <code>args</code> attribute.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.ApplicationArguments;
import org.springframework.boot.test.context.SpringBootTest;

import static org.assertj.core.api.Assertions.assertThat;

</span><span class="fold-block">@SpringBootTest(args = "--app.test=one")
class MyApplicationArgumentTests {

    @Test
    void applicationArgumentsPopulated(@Autowired ApplicationArguments args) {
        assertThat(args.getOptionNames()).containsOnly("app.test");
        assertThat(args.getOptionValues("app.test")).containsOnly("one");
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.with-mock-environment"><a class="anchor" href="#features.testing.spring-boot-applications.with-mock-environment"></a>26.3.5. Testing with a mock environment</h4>
<div class="paragraph">
<p>By default, <code>@SpringBootTest</code> does not start the server.
If you have web endpoints that you want to test against this mock environment, you can additionally configure <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/testing.html#spring-mvc-test-framework"><code>MockMvc</code></a> as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.web.servlet.MockMvc;

import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

</span><span class="fold-block">@SpringBootTest
@AutoConfigureMockMvc
class MyMockMvcTests {

    @Test
    void exampleTest(@Autowired MockMvc mvc) throws Exception {
        mvc.perform(get("/")).andExpect(status().isOk()).andExpect(content().string("Hello World"));
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you want to focus only on the web layer and not start a complete <code>ApplicationContext</code>, consider <a href="#features.testing.spring-boot-applications.spring-mvc-tests">using <code>@WebMvcTest</code> instead</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Alternatively, you can configure a <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/testing.html#webtestclient-tests"><code>WebTestClient</code></a> as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.reactive.AutoConfigureWebTestClient;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.web.reactive.server.WebTestClient;

</span><span class="fold-block">@SpringBootTest
@AutoConfigureWebTestClient
class MyMockWebTestClientTests {

    @Test
    void exampleTest(@Autowired WebTestClient webClient) {
        webClient
            .get().uri("/")
            .exchange()
            .expectStatus().isOk()
            .expectBody(String.class).isEqualTo("Hello World");
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Testing within a mocked environment is usually faster than running with a full Servlet container.
However, since mocking occurs at the Spring MVC layer, code that relies on lower-level Servlet container behavior cannot be directly tested with MockMvc.</p>
</div>
<div class="paragraph">
<p>For example, Spring Boot&#8217;s error handling is based on the &#8220;error page&#8221; support provided by the Servlet container.
This means that, whilst you can test your MVC layer throws and handles exceptions as expected, you cannot directly test that a specific <a href="#features.developing-web-applications.spring-mvc.error-handling.error-pages">custom error page</a> is rendered.
If you need to test these lower-level concerns, you can start a fully running server as described in the next section.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.with-running-server"><a class="anchor" href="#features.testing.spring-boot-applications.with-running-server"></a>26.3.6. Testing with a running server</h4>
<div class="paragraph">
<p>If you need to start a full running server, we recommend that you use random ports.
If you use <code>@SpringBootTest(webEnvironment=WebEnvironment.RANDOM_PORT)</code>, an available port is picked at random each time your test runs.</p>
</div>
<div class="paragraph">
<p>The <code>@LocalServerPort</code> annotation can be used to <a href="howto.html#howto.webserver.discover-port">inject the actual port used</a> into your test.
For convenience, tests that need to make REST calls to the started server can additionally <code>@Autowire</code> a <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/testing.html#webtestclient-tests"><code>WebTestClient</code></a>, which resolves relative links to the running server and comes with a dedicated API for verifying responses, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.context.SpringBootTest.WebEnvironment;
import org.springframework.test.web.reactive.server.WebTestClient;

</span><span class="fold-block">@SpringBootTest(webEnvironment = WebEnvironment.RANDOM_PORT)
class MyRandomPortWebTestClientTests {

    @Test
    void exampleTest(@Autowired WebTestClient webClient) {
        webClient
            .get().uri("/")
            .exchange()
            .expectStatus().isOk()
            .expectBody(String.class).isEqualTo("Hello World");
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This setup requires <code>spring-webflux</code> on the classpath.
If you can&#8217;t or won&#8217;t add webflux, Spring Boot also provides a <code>TestRestTemplate</code> facility:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.context.SpringBootTest.WebEnvironment;
import org.springframework.boot.test.web.client.TestRestTemplate;

import static org.assertj.core.api.Assertions.assertThat;

</span><span class="fold-block">@SpringBootTest(webEnvironment = WebEnvironment.RANDOM_PORT)
class MyRandomPortTestRestTemplateTests {

    @Test
    void exampleTest(@Autowired TestRestTemplate restTemplate) {
        String body = restTemplate.getForObject("/", String.class);
        assertThat(body).isEqualTo("Hello World");
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.customizing-web-test-client"><a class="anchor" href="#features.testing.spring-boot-applications.customizing-web-test-client"></a>26.3.7. Customizing WebTestClient</h4>
<div class="paragraph">
<p>To customize the <code>WebTestClient</code> bean, configure a <code>WebTestClientBuilderCustomizer</code> bean.
Any such beans are called with the <code>WebTestClient.Builder</code> that is used to create the <code>WebTestClient</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.jmx"><a class="anchor" href="#features.testing.spring-boot-applications.jmx"></a>26.3.8. Using JMX</h4>
<div class="paragraph">
<p>As the test context framework caches context, JMX is disabled by default to prevent identical components to register on the same domain.
If such test needs access to an <code>MBeanServer</code>, consider marking it dirty as well:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import javax.management.MBeanServer;
import javax.management.MalformedObjectNameException;

import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.annotation.DirtiesContext;
import org.springframework.test.context.junit.jupiter.SpringExtension;

import static org.assertj.core.api.Assertions.assertThat;

</span><span class="fold-block">@ExtendWith(SpringExtension.class)
@SpringBootTest(properties = "spring.jmx.enabled=true")
@DirtiesContext
class MyJmxTests {

    @Autowired
    private MBeanServer mBeanServer;

    @Test
    void exampleTest() throws MalformedObjectNameException {
        assertThat(this.mBeanServer.getDomains()).contains("java.lang");
        // ...
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.metrics"><a class="anchor" href="#features.testing.spring-boot-applications.metrics"></a>26.3.9. Using Metrics</h4>
<div class="paragraph">
<p>Regardless of your classpath, meter registries, except the in-memory backed, are not auto-configured when using <code>@SpringBootTest</code>.</p>
</div>
<div class="paragraph">
<p>If you need to export metrics to a different backend as part of an integration test, annotate it with <code>@AutoConfigureMetrics</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.mocking-beans"><a class="anchor" href="#features.testing.spring-boot-applications.mocking-beans"></a>26.3.10. Mocking and Spying Beans</h4>
<div class="paragraph">
<p>When running tests, it is sometimes necessary to mock certain components within your application context.
For example, you may have a facade over some remote service that is unavailable during development.
Mocking can also be useful when you want to simulate failures that might be hard to trigger in a real environment.</p>
</div>
<div class="paragraph">
<p>Spring Boot includes a <code>@MockBean</code> annotation that can be used to define a Mockito mock for a bean inside your <code>ApplicationContext</code>.
You can use the annotation to add new beans or replace a single existing bean definition.
The annotation can be used directly on test classes, on fields within your test, or on <code>@Configuration</code> classes and fields.
When used on a field, the instance of the created mock is also injected.
Mock beans are automatically reset after each test method.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If your test uses one of Spring Boot&#8217;s test annotations (such as <code>@SpringBootTest</code>), this feature is automatically enabled.
To use this feature with a different arrangement, listeners must be explicitly added, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.test.mock.mockito.MockitoTestExecutionListener;
import org.springframework.boot.test.mock.mockito.ResetMocksTestExecutionListener;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.TestExecutionListeners;

</span><span class="fold-block">@ContextConfiguration(classes = MyConfig.class)
@TestExecutionListeners({ MockitoTestExecutionListener.class, ResetMocksTestExecutionListener.class })
class MyTests {

    // ...

}
</span></code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following example replaces an existing <code>RemoteService</code> bean with a mock implementation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.mock.mockito.MockBean;

import static org.assertj.core.api.Assertions.assertThat;
import static org.mockito.BDDMockito.given;

</span><span class="fold-block">@SpringBootTest
class MyTests {

    @Autowired
    private Reverser reverser;

    @MockBean
    private RemoteService remoteService;

    @Test
    void exampleTest() {
        given(this.remoteService.getValue()).willReturn("spring");
        String reverse = this.reverser.getReverseValue(); // Calls injected RemoteService
        assertThat(reverse).isEqualTo("gnirps");
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>@MockBean</code> cannot be used to mock the behavior of a bean that&#8217;s exercised during application context refresh.
By the time the test is executed, the application context refresh has completed and it is too late to configure the mocked behavior.
We recommend using a <code>@Bean</code> method to create and configure the mock in this situation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Additionally, you can use <code>@SpyBean</code> to wrap any existing bean with a Mockito <code>spy</code>.
See the <a href="https://docs.spring.io/spring-boot/docs/2.5.3/api/org/springframework/boot/test/mock/mockito/SpyBean.html">Javadoc</a> for full details.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
CGLib proxies, such as those created for scoped beans, declare the proxied methods as <code>final</code>.
This stops Mockito from functioning correctly as it cannot mock or spy on <code>final</code> methods in its default configuration.
If you want to mock or spy on such a bean, configure Mockito to use its inline mock maker by adding <code>org.mockito:mockito-inline</code> to your application&#8217;s test dependencies.
This allows Mockito to mock and spy on <code>final</code> methods.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
While Spring&#8217;s test framework caches application contexts between tests and reuses a context for tests sharing the same configuration, the use of <code>@MockBean</code> or <code>@SpyBean</code> influences the cache key, which will most likely increase the number of contexts.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you are using <code>@SpyBean</code> to spy on a bean with <code>@Cacheable</code> methods that refer to parameters by name, your application must be compiled with <code>-parameters</code>.
This ensures that the parameter names are available to the caching infrastructure once the bean has been spied upon.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
When you are using <code>@SpyBean</code> to spy on a bean that is proxied by Spring, you may need to remove Spring&#8217;s proxy in some situations, for example when setting expectations using <code>given</code> or <code>when</code>.
Use <code>AopTestUtils.getTargetObject(yourProxiedSpy)</code> to do so.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.autoconfigured-tests"><a class="anchor" href="#features.testing.spring-boot-applications.autoconfigured-tests"></a>26.3.11. Auto-configured Tests</h4>
<div class="paragraph">
<p>Spring Boot&#8217;s auto-configuration system works well for applications but can sometimes be a little too much for tests.
It often helps to load only the parts of the configuration that are required to test a &#8220;slice&#8221; of your application.
For example, you might want to test that Spring MVC controllers are mapping URLs correctly, and you do not want to involve database calls in those tests, or you might want to test JPA entities, and you are not interested in the web layer when those tests run.</p>
</div>
<div class="paragraph">
<p>The <code>spring-boot-test-autoconfigure</code> module includes a number of annotations that can be used to automatically configure such &#8220;slices&#8221;.
Each of them works in a similar way, providing a <code>@&#8230;&#8203;Test</code> annotation that loads the <code>ApplicationContext</code> and one or more <code>@AutoConfigure&#8230;&#8203;</code> annotations that can be used to customize auto-configuration settings.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Each slice restricts component scan to appropriate components and loads a very restricted set of auto-configuration classes.
If you need to exclude one of them, most <code>@&#8230;&#8203;Test</code> annotations provide an <code>excludeAutoConfiguration</code> attribute.
Alternatively, you can use <code>@ImportAutoConfiguration#exclude</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Including multiple &#8220;slices&#8221; by using several <code>@&#8230;&#8203;Test</code> annotations in one test is not supported.
If you need multiple &#8220;slices&#8221;, pick one of the <code>@&#8230;&#8203;Test</code> annotations and include the <code>@AutoConfigure&#8230;&#8203;</code> annotations of the other &#8220;slices&#8221; by hand.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
It is also possible to use the <code>@AutoConfigure&#8230;&#8203;</code> annotations with the standard <code>@SpringBootTest</code> annotation.
You can use this combination if you are not interested in &#8220;slicing&#8221; your application but you want some of the auto-configured test beans.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.json-tests"><a class="anchor" href="#features.testing.spring-boot-applications.json-tests"></a>26.3.12. Auto-configured JSON Tests</h4>
<div class="paragraph">
<p>To test that object JSON serialization and deserialization is working as expected, you can use the <code>@JsonTest</code> annotation.
<code>@JsonTest</code> auto-configures the available supported JSON mapper, which can be one of the following libraries:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Jackson <code>ObjectMapper</code>, any <code>@JsonComponent</code> beans and any Jackson <code>Module</code>s</p>
</li>
<li>
<p><code>Gson</code></p>
</li>
<li>
<p><code>Jsonb</code></p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A list of the auto-configurations that are enabled by <code>@JsonTest</code> can be <a href="test-auto-configuration.html#test-auto-configuration">found in the appendix</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you need to configure elements of the auto-configuration, you can use the <code>@AutoConfigureJsonTesters</code> annotation.</p>
</div>
<div class="paragraph">
<p>Spring Boot includes AssertJ-based helpers that work with the JSONAssert and JsonPath libraries to check that JSON appears as expected.
The <code>JacksonTester</code>, <code>GsonTester</code>, <code>JsonbTester</code>, and <code>BasicJsonTester</code> classes can be used for Jackson, Gson, Jsonb, and Strings respectively.
Any helper fields on the test class can be <code>@Autowired</code> when using <code>@JsonTest</code>.
The following example shows a test class for Jackson:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.json.JsonTest;
import org.springframework.boot.test.json.JacksonTester;

import static org.assertj.core.api.Assertions.assertThat;

</span><span class="fold-block">@JsonTest
class MyJsonTests {

    @Autowired
    private JacksonTester&lt;VehicleDetails&gt; json;

    @Test
    void serialize() throws Exception {
        VehicleDetails details = new VehicleDetails("Honda", "Civic");
        // Assert against a `.json` file in the same package as the test
        assertThat(this.json.write(details)).isEqualToJson("expected.json");
        // Or use JSON path based assertions
        assertThat(this.json.write(details)).hasJsonPathStringValue("@.make");
        assertThat(this.json.write(details)).extractingJsonPathStringValue("@.make").isEqualTo("Honda");
    }

    @Test
    void deserialize() throws Exception {
        String content = "{\"make\":\"Ford\",\"model\":\"Focus\"}";
        assertThat(this.json.parse(content)).isEqualTo(new VehicleDetails("Ford", "Focus"));
        assertThat(this.json.parseObject(content).getMake()).isEqualTo("Ford");
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
JSON helper classes can also be used directly in standard unit tests.
To do so, call the <code>initFields</code> method of the helper in your <code>@Before</code> method if you do not use <code>@JsonTest</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you&#8217;re using Spring Boot&#8217;s AssertJ-based helpers to assert on a number value at a given JSON path, you might not be able to use <code>isEqualTo</code> depending on the type.
Instead, you can use AssertJ&#8217;s <code>satisfies</code> to assert that the value matches the given condition.
For instance, the following example asserts that the actual number is a float value close to <code>0.15</code> within an offset of <code>0.01</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
void someTest() throws Exception {
    SomeObject value = new SomeObject(0.152f);
    assertThat(this.json.write(value)).extractingJsonPathNumberValue("@.test.numberValue")
            .satisfies((number) -&gt; assertThat(number.floatValue()).isCloseTo(0.15f, within(0.01f)));
}
</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.spring-mvc-tests"><a class="anchor" href="#features.testing.spring-boot-applications.spring-mvc-tests"></a>26.3.13. Auto-configured Spring MVC Tests</h4>
<div class="paragraph">
<p>To test whether Spring MVC controllers are working as expected, use the <code>@WebMvcTest</code> annotation.
<code>@WebMvcTest</code> auto-configures the Spring MVC infrastructure and limits scanned beans to <code>@Controller</code>, <code>@ControllerAdvice</code>, <code>@JsonComponent</code>, <code>Converter</code>, <code>GenericConverter</code>, <code>Filter</code>, <code>HandlerInterceptor</code>, <code>WebMvcConfigurer</code>, and <code>HandlerMethodArgumentResolver</code>.
Regular <code>@Component</code> and <code>@ConfigurationProperties</code> beans are not scanned when the <code>@WebMvcTest</code> annotation is used.
<code>@EnableConfigurationProperties</code> can be used to include <code>@ConfigurationProperties</code> beans.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A list of the auto-configuration settings that are enabled by <code>@WebMvcTest</code> can be <a href="test-auto-configuration.html#test-auto-configuration">found in the appendix</a>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you need to register extra components, such as the Jackson <code>Module</code>, you can import additional configuration classes by using <code>@Import</code> on your test.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Often, <code>@WebMvcTest</code> is limited to a single controller and is used in combination with <code>@MockBean</code> to provide mock implementations for required collaborators.</p>
</div>
<div class="paragraph">
<p><code>@WebMvcTest</code> also auto-configures <code>MockMvc</code>.
Mock MVC offers a powerful way to quickly test MVC controllers without needing to start a full HTTP server.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can also auto-configure <code>MockMvc</code> in a non-<code>@WebMvcTest</code> (such as <code>@SpringBootTest</code>) by annotating it with <code>@AutoConfigureMockMvc</code>.
The following example uses <code>MockMvc</code>:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;
import org.springframework.boot.test.mock.mockito.MockBean;
import org.springframework.http.MediaType;
import org.springframework.test.web.servlet.MockMvc;

import static org.mockito.BDDMockito.given;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

</span><span class="fold-block">@WebMvcTest(UserVehicleController.class)
class MyControllerTests {

    @Autowired
    private MockMvc mvc;

    @MockBean
    private UserVehicleService userVehicleService;

    @Test
    void testExample() throws Exception {
        given(this.userVehicleService.getVehicleDetails("sboot"))
            .willReturn(new VehicleDetails("Honda", "Civic"));
        this.mvc.perform(get("/sboot/vehicle").accept(MediaType.TEXT_PLAIN))
            .andExpect(status().isOk())
            .andExpect(content().string("Honda Civic"));
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you need to configure elements of the auto-configuration (for example, when servlet filters should be applied) you can use attributes in the <code>@AutoConfigureMockMvc</code> annotation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you use HtmlUnit or Selenium, auto-configuration also provides an HtmlUnit <code>WebClient</code> bean and/or a Selenium <code>WebDriver</code> bean.
The following example uses HtmlUnit:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import com.gargoylesoftware.htmlunit.WebClient;
import com.gargoylesoftware.htmlunit.html.HtmlPage;
import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;
import org.springframework.boot.test.mock.mockito.MockBean;

import static org.assertj.core.api.Assertions.assertThat;
import static org.mockito.BDDMockito.given;

</span><span class="fold-block">@WebMvcTest(UserVehicleController.class)
class MyHtmlUnitTests {

    @Autowired
    private WebClient webClient;

    @MockBean
    private UserVehicleService userVehicleService;

    @Test
    void testExample() throws Exception {
        given(this.userVehicleService.getVehicleDetails("sboot")).willReturn(new VehicleDetails("Honda", "Civic"));
        HtmlPage page = this.webClient.getPage("/sboot/vehicle.html");
        assertThat(page.getBody().getTextContent()).isEqualTo("Honda Civic");
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By default, Spring Boot puts <code>WebDriver</code> beans in a special &#8220;scope&#8221; to ensure that the driver exits after each test and that a new instance is injected.
If you do not want this behavior, you can add <code>@Scope("singleton")</code> to your <code>WebDriver</code> <code>@Bean</code> definition.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
The <code>webDriver</code> scope created by Spring Boot will replace any user defined scope of the same name.
If you define your own <code>webDriver</code> scope you may find it stops working when you use <code>@WebMvcTest</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you have Spring Security on the classpath, <code>@WebMvcTest</code> will also scan <code>WebSecurityConfigurer</code> beans.
Instead of disabling security completely for such tests, you can use Spring Security&#8217;s test support.
More details on how to use Spring Security&#8217;s <code>MockMvc</code> support can be found in this <em><a href="howto.html#howto.testing.with-spring-security">howto.html</a></em> how-to section.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Sometimes writing Spring MVC tests is not enough; Spring Boot can help you run <a href="#features.testing.spring-boot-applications.with-running-server">full end-to-end tests with an actual server</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.spring-webflux-tests"><a class="anchor" href="#features.testing.spring-boot-applications.spring-webflux-tests"></a>26.3.14. Auto-configured Spring WebFlux Tests</h4>
<div class="paragraph">
<p>To test that <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/web-reactive.html">Spring WebFlux</a> controllers are working as expected, you can use the <code>@WebFluxTest</code> annotation.
<code>@WebFluxTest</code> auto-configures the Spring WebFlux infrastructure and limits scanned beans to <code>@Controller</code>, <code>@ControllerAdvice</code>, <code>@JsonComponent</code>, <code>Converter</code>, <code>GenericConverter</code>, <code>WebFilter</code>, and <code>WebFluxConfigurer</code>.
Regular <code>@Component</code> and <code>@ConfigurationProperties</code> beans are not scanned when the <code>@WebFluxTest</code> annotation is used.
<code>@EnableConfigurationProperties</code> can be used to include <code>@ConfigurationProperties</code> beans.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A list of the auto-configurations that are enabled by <code>@WebFluxTest</code> can be <a href="test-auto-configuration.html#test-auto-configuration">found in the appendix</a>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you need to register extra components, such as Jackson <code>Module</code>, you can import additional configuration classes using <code>@Import</code> on your test.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Often, <code>@WebFluxTest</code> is limited to a single controller and used in combination with the <code>@MockBean</code> annotation to provide mock implementations for required collaborators.</p>
</div>
<div class="paragraph">
<p><code>@WebFluxTest</code> also auto-configures <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/testing.html#webtestclient"><code>WebTestClient</code></a>, which offers a powerful way to quickly test WebFlux controllers without needing to start a full HTTP server.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You can also auto-configure <code>WebTestClient</code> in a non-<code>@WebFluxTest</code> (such as <code>@SpringBootTest</code>) by annotating it with <code>@AutoConfigureWebTestClient</code>.
The following example shows a class that uses both <code>@WebFluxTest</code> and a <code>WebTestClient</code>:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.reactive.WebFluxTest;
import org.springframework.boot.test.mock.mockito.MockBean;
import org.springframework.http.MediaType;
import org.springframework.test.web.reactive.server.WebTestClient;

import static org.mockito.BDDMockito.given;

</span><span class="fold-block">@WebFluxTest(UserVehicleController.class)
class MyControllerTests {

    @Autowired
    private WebTestClient webClient;

    @MockBean
    private UserVehicleService userVehicleService;

    @Test
    void testExample() throws Exception {
        given(this.userVehicleService.getVehicleDetails("sboot"))
            .willReturn(new VehicleDetails("Honda", "Civic"));
        this.webClient.get().uri("/sboot/vehicle").accept(MediaType.TEXT_PLAIN).exchange()
            .expectStatus().isOk()
            .expectBody(String.class).isEqualTo("Honda Civic");
    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
This setup is only supported by WebFlux applications as using <code>WebTestClient</code> in a mocked web application only works with WebFlux at the moment.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>@WebFluxTest</code> cannot detect routes registered via the functional web framework.
For testing <code>RouterFunction</code> beans in the context, consider importing your <code>RouterFunction</code> yourself via <code>@Import</code> or using <code>@SpringBootTest</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>@WebFluxTest</code> cannot detect custom security configuration registered via a <code>@Bean</code> of type <code>SecurityWebFilterChain</code>.
To include that in your test, you will need to import the configuration that registers the bean via <code>@Import</code> or use <code>@SpringBootTest</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Sometimes writing Spring WebFlux tests is not enough; Spring Boot can help you run <a href="#features.testing.spring-boot-applications.with-running-server">full end-to-end tests with an actual server</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.autoconfigured-spring-data-cassandra"><a class="anchor" href="#features.testing.spring-boot-applications.autoconfigured-spring-data-cassandra"></a>26.3.15. Auto-configured Data Cassandra Tests</h4>
<div class="paragraph">
<p>You can use <code>@DataCassandraTest</code> to test Cassandra applications.
By default, it configures a <code>CassandraTemplate</code>, scans for <code>@Table</code> classes, and configures Spring Data Cassandra repositories.
Regular <code>@Component</code> and <code>@ConfigurationProperties</code> beans are not scanned when the <code>@DataCassandraTest</code> annotation is used.
<code>@EnableConfigurationProperties</code> can be used to include <code>@ConfigurationProperties</code> beans.
(For more about using Cassandra with Spring Boot, see "<a href="#features.nosql.cassandra">Cassandra</a>", earlier in this chapter.)</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A list of the auto-configuration settings that are enabled by <code>@DataCassandraTest</code> can be <a href="test-auto-configuration.html#test-auto-configuration">found in the appendix</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following example shows a typical setup for using Cassandra tests in Spring Boot:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.data.cassandra.DataCassandraTest;

</span><span class="fold-block">@DataCassandraTest
class MyDataCassandraTests {

    @Autowired
    private SomeRepository repository;

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.autoconfigured-spring-data-jpa"><a class="anchor" href="#features.testing.spring-boot-applications.autoconfigured-spring-data-jpa"></a>26.3.16. Auto-configured Data JPA Tests</h4>
<div class="paragraph">
<p>You can use the <code>@DataJpaTest</code> annotation to test JPA applications.
By default, it scans for <code>@Entity</code> classes and configures Spring Data JPA repositories.
If an embedded database is available on the classpath, it configures one as well.
SQL queries are logged by default by setting the <code>spring.jpa.show-sql</code> property to <code>true</code>.
This can be disabled using the <code>showSql()</code> attribute of the annotation.</p>
</div>
<div class="paragraph">
<p>Regular <code>@Component</code> and <code>@ConfigurationProperties</code> beans are not scanned when the <code>@DataJpaTest</code> annotation is used.
<code>@EnableConfigurationProperties</code> can be used to include <code>@ConfigurationProperties</code> beans.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A list of the auto-configuration settings that are enabled by <code>@DataJpaTest</code> can be <a href="test-auto-configuration.html#test-auto-configuration">found in the appendix</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, data JPA tests are transactional and roll back at the end of each test.
See the <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/testing.html#testcontext-tx-enabling-transactions">relevant section</a> in the Spring Framework Reference Documentation for more details.
If that is not what you want, you can disable transaction management for a test or for the whole class as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.test.autoconfigure.orm.jpa.DataJpaTest;
import org.springframework.transaction.annotation.Propagation;
import org.springframework.transaction.annotation.Transactional;

</span><span class="fold-block">@DataJpaTest
@Transactional(propagation = Propagation.NOT_SUPPORTED)
class MyNonTransactionalTests {

    // ...

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Data JPA tests may also inject a <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot-test-autoconfigure/src/main/java/org/springframework/boot/test/autoconfigure/orm/jpa/TestEntityManager.java"><code>TestEntityManager</code></a> bean, which provides an alternative to the standard JPA <code>EntityManager</code> that is specifically designed for tests.
If you want to use <code>TestEntityManager</code> outside of <code>@DataJpaTest</code> instances, you can also use the <code>@AutoConfigureTestEntityManager</code> annotation.
A <code>JdbcTemplate</code> is also available if you need that.
The following example shows the <code>@DataJpaTest</code> annotation in use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.orm.jpa.DataJpaTest;
import org.springframework.boot.test.autoconfigure.orm.jpa.TestEntityManager;

import static org.assertj.core.api.Assertions.assertThat;

</span><span class="fold-block">@DataJpaTest
class MyRepositoryTests {

    @Autowired
    private TestEntityManager entityManager;

    @Autowired
    private UserRepository repository;

    @Test
    void testExample() throws Exception {
        this.entityManager.persist(new User("sboot", "1234"));
        User user = this.repository.findByUsername("sboot");
        assertThat(user.getUsername()).isEqualTo("sboot");
        assertThat(user.getEmployeeNumber()).isEqualTo("1234");
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In-memory embedded databases generally work well for tests, since they are fast and do not require any installation.
If, however, you prefer to run tests against a real database you can use the <code>@AutoConfigureTestDatabase</code> annotation, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.test.autoconfigure.jdbc.AutoConfigureTestDatabase;
import org.springframework.boot.test.autoconfigure.jdbc.AutoConfigureTestDatabase.Replace;
import org.springframework.boot.test.autoconfigure.orm.jpa.DataJpaTest;

</span><span class="fold-block">@DataJpaTest
@AutoConfigureTestDatabase(replace = Replace.NONE)
class MyRepositoryTests {

    // ...

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.autoconfigured-jdbc"><a class="anchor" href="#features.testing.spring-boot-applications.autoconfigured-jdbc"></a>26.3.17. Auto-configured JDBC Tests</h4>
<div class="paragraph">
<p><code>@JdbcTest</code> is similar to <code>@DataJpaTest</code> but is for tests that only require a <code>DataSource</code> and do not use Spring Data JDBC.
By default, it configures an in-memory embedded database and a <code>JdbcTemplate</code>.
Regular <code>@Component</code> and <code>@ConfigurationProperties</code> beans are not scanned when the <code>@JdbcTest</code> annotation is used.
<code>@EnableConfigurationProperties</code> can be used to include <code>@ConfigurationProperties</code> beans.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A list of the auto-configurations that are enabled by <code>@JdbcTest</code> can be <a href="test-auto-configuration.html#test-auto-configuration">found in the appendix</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, JDBC tests are transactional and roll back at the end of each test.
See the <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/testing.html#testcontext-tx-enabling-transactions">relevant section</a> in the Spring Framework Reference Documentation for more details.
If that is not what you want, you can disable transaction management for a test or for the whole class, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.test.autoconfigure.jdbc.JdbcTest;
import org.springframework.transaction.annotation.Propagation;
import org.springframework.transaction.annotation.Transactional;

</span><span class="fold-block">@JdbcTest
@Transactional(propagation = Propagation.NOT_SUPPORTED)
class MyTransactionalTests {

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you prefer your test to run against a real database, you can use the <code>@AutoConfigureTestDatabase</code> annotation in the same way as for <code>DataJpaTest</code>.
(See "<a href="#features.testing.spring-boot-applications.autoconfigured-spring-data-jpa">Auto-configured Data JPA Tests</a>".)</p>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.autoconfigured-spring-data-jdbc"><a class="anchor" href="#features.testing.spring-boot-applications.autoconfigured-spring-data-jdbc"></a>26.3.18. Auto-configured Data JDBC Tests</h4>
<div class="paragraph">
<p><code>@DataJdbcTest</code> is similar to <code>@JdbcTest</code> but is for tests that use Spring Data JDBC repositories.
By default, it configures an in-memory embedded database, a <code>JdbcTemplate</code>, and Spring Data JDBC repositories.
Regular <code>@Component</code> and <code>@ConfigurationProperties</code> beans are not scanned when the <code>@DataJdbcTest</code> annotation is used.
<code>@EnableConfigurationProperties</code> can be used to include <code>@ConfigurationProperties</code> beans.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A list of the auto-configurations that are enabled by <code>@DataJdbcTest</code> can be <a href="test-auto-configuration.html#test-auto-configuration">found in the appendix</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, Data JDBC tests are transactional and roll back at the end of each test.
See the <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/testing.html#testcontext-tx-enabling-transactions">relevant section</a> in the Spring Framework Reference Documentation for more details.
If that is not what you want, you can disable transaction management for a test or for the whole test class as <a href="#features.testing.spring-boot-applications.autoconfigured-jdbc">shown in the JDBC example</a>.</p>
</div>
<div class="paragraph">
<p>If you prefer your test to run against a real database, you can use the <code>@AutoConfigureTestDatabase</code> annotation in the same way as for <code>DataJpaTest</code>.
(See "<a href="#features.testing.spring-boot-applications.autoconfigured-spring-data-jpa">Auto-configured Data JPA Tests</a>".)</p>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.autoconfigured-jooq"><a class="anchor" href="#features.testing.spring-boot-applications.autoconfigured-jooq"></a>26.3.19. Auto-configured jOOQ Tests</h4>
<div class="paragraph">
<p>You can use <code>@JooqTest</code> in a similar fashion as <code>@JdbcTest</code> but for jOOQ-related tests.
As jOOQ relies heavily on a Java-based schema that corresponds with the database schema, the existing <code>DataSource</code> is used.
If you want to replace it with an in-memory database, you can use <code>@AutoConfigureTestDatabase</code> to override those settings.
(For more about using jOOQ with Spring Boot, see "<a href="#features.sql.jooq">Using jOOQ</a>", earlier in this chapter.)
Regular <code>@Component</code> and <code>@ConfigurationProperties</code> beans are not scanned when the <code>@JooqTest</code> annotation is used.
<code>@EnableConfigurationProperties</code> can be used to include <code>@ConfigurationProperties</code> beans.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A list of the auto-configurations that are enabled by <code>@JooqTest</code> can be <a href="test-auto-configuration.html#test-auto-configuration">found in the appendix</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>@JooqTest</code> configures a <code>DSLContext</code>.
The following example shows the <code>@JooqTest</code> annotation in use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.jooq.DSLContext;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.jooq.JooqTest;

</span><span class="fold-block">@JooqTest
class MyJooqTests {

    @Autowired
    private DSLContext dslContext;

    // ...

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>JOOQ tests are transactional and roll back at the end of each test by default.
If that is not what you want, you can disable transaction management for a test or for the whole test class as <a href="#features.testing.spring-boot-applications.autoconfigured-jdbc">shown in the JDBC example</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.autoconfigured-spring-data-mongodb"><a class="anchor" href="#features.testing.spring-boot-applications.autoconfigured-spring-data-mongodb"></a>26.3.20. Auto-configured Data MongoDB Tests</h4>
<div class="paragraph">
<p>You can use <code>@DataMongoTest</code> to test MongoDB applications.
By default, it configures an in-memory embedded MongoDB (if available), configures a <code>MongoTemplate</code>, scans for <code>@Document</code> classes, and configures Spring Data MongoDB repositories.
Regular <code>@Component</code> and <code>@ConfigurationProperties</code> beans are not scanned when the <code>@DataMongoTest</code> annotation is used.
<code>@EnableConfigurationProperties</code> can be used to include <code>@ConfigurationProperties</code> beans.
(For more about using MongoDB with Spring Boot, see "<a href="#features.nosql.mongodb">MongoDB</a>", earlier in this chapter.)</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A list of the auto-configuration settings that are enabled by <code>@DataMongoTest</code> can be <a href="test-auto-configuration.html#test-auto-configuration">found in the appendix</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following class shows the <code>@DataMongoTest</code> annotation in use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.data.mongo.DataMongoTest;
import org.springframework.data.mongodb.core.MongoTemplate;

</span><span class="fold-block">@DataMongoTest
class MyDataMongoDbTests {

    @Autowired
    private MongoTemplate mongoTemplate;

    // ...

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In-memory embedded MongoDB generally works well for tests, since it is fast and does not require any developer installation.
If, however, you prefer to run tests against a real MongoDB server, you should exclude the embedded MongoDB auto-configuration, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.autoconfigure.mongo.embedded.EmbeddedMongoAutoConfiguration;
import org.springframework.boot.test.autoconfigure.data.mongo.DataMongoTest;

</span><span class="fold-block">@DataMongoTest(excludeAutoConfiguration = EmbeddedMongoAutoConfiguration.class)
class MyDataMongoDbTests {

    // ...

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.autoconfigured-spring-data-neo4j"><a class="anchor" href="#features.testing.spring-boot-applications.autoconfigured-spring-data-neo4j"></a>26.3.21. Auto-configured Data Neo4j Tests</h4>
<div class="paragraph">
<p>You can use <code>@DataNeo4jTest</code> to test Neo4j applications.
By default, it scans for <code>@Node</code> classes, and configures Spring Data Neo4j repositories.
Regular <code>@Component</code> and <code>@ConfigurationProperties</code> beans are not scanned when the <code>@DataNeo4jTest</code> annotation is used.
<code>@EnableConfigurationProperties</code> can be used to include <code>@ConfigurationProperties</code> beans.
(For more about using Neo4J with Spring Boot, see "<a href="#features.nosql.neo4j">Neo4j</a>", earlier in this chapter.)</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A list of the auto-configuration settings that are enabled by <code>@DataNeo4jTest</code> can be <a href="test-auto-configuration.html#test-auto-configuration">found in the appendix</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following example shows a typical setup for using Neo4J tests in Spring Boot:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.data.neo4j.DataNeo4jTest;

</span><span class="fold-block">@DataNeo4jTest
class MyDataNeo4jTests {

    @Autowired
    private SomeRepository repository;

    // ...

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, Data Neo4j tests are transactional and roll back at the end of each test.
See the <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/testing.html#testcontext-tx-enabling-transactions">relevant section</a> in the Spring Framework Reference Documentation for more details.
If that is not what you want, you can disable transaction management for a test or for the whole class, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.test.autoconfigure.data.neo4j.DataNeo4jTest;
import org.springframework.transaction.annotation.Propagation;
import org.springframework.transaction.annotation.Transactional;

</span><span class="fold-block">@DataNeo4jTest
@Transactional(propagation = Propagation.NOT_SUPPORTED)
class MyDataNeo4jTests {

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Transactional tests are not supported with reactive access.
If you are using this style, you must configure <code>@DataNeo4jTest</code> tests as described above.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.autoconfigured-spring-data-redis"><a class="anchor" href="#features.testing.spring-boot-applications.autoconfigured-spring-data-redis"></a>26.3.22. Auto-configured Data Redis Tests</h4>
<div class="paragraph">
<p>You can use <code>@DataRedisTest</code> to test Redis applications.
By default, it scans for <code>@RedisHash</code> classes and configures Spring Data Redis repositories.
Regular <code>@Component</code> and <code>@ConfigurationProperties</code> beans are not scanned when the <code>@DataRedisTest</code> annotation is used.
<code>@EnableConfigurationProperties</code> can be used to include <code>@ConfigurationProperties</code> beans.
(For more about using Redis with Spring Boot, see "<a href="#features.nosql.redis">Redis</a>", earlier in this chapter.)</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A list of the auto-configuration settings that are enabled by <code>@DataRedisTest</code> can be <a href="test-auto-configuration.html#test-auto-configuration">found in the appendix</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following example shows the <code>@DataRedisTest</code> annotation in use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.data.redis.DataRedisTest;

</span><span class="fold-block">@DataRedisTest
class MyDataRedisTests {

    @Autowired
    private SomeRepository repository;

    // ...

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.autoconfigured-spring-data-ldap"><a class="anchor" href="#features.testing.spring-boot-applications.autoconfigured-spring-data-ldap"></a>26.3.23. Auto-configured Data LDAP Tests</h4>
<div class="paragraph">
<p>You can use <code>@DataLdapTest</code> to test LDAP applications.
By default, it configures an in-memory embedded LDAP (if available), configures an <code>LdapTemplate</code>, scans for <code>@Entry</code> classes, and configures Spring Data LDAP repositories.
Regular <code>@Component</code> and <code>@ConfigurationProperties</code> beans are not scanned when the <code>@DataLdapTest</code> annotation is used.
<code>@EnableConfigurationProperties</code> can be used to include <code>@ConfigurationProperties</code> beans.
(For more about using LDAP with Spring Boot, see "<a href="#features.nosql.ldap">LDAP</a>", earlier in this chapter.)</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A list of the auto-configuration settings that are enabled by <code>@DataLdapTest</code> can be <a href="test-auto-configuration.html#test-auto-configuration">found in the appendix</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following example shows the <code>@DataLdapTest</code> annotation in use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.data.ldap.DataLdapTest;
import org.springframework.ldap.core.LdapTemplate;

</span><span class="fold-block">@DataLdapTest
class MyDataLdapTests {

    @Autowired
    private LdapTemplate ldapTemplate;

    // ...

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In-memory embedded LDAP generally works well for tests, since it is fast and does not require any developer installation.
If, however, you prefer to run tests against a real LDAP server, you should exclude the embedded LDAP auto-configuration, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.autoconfigure.ldap.embedded.EmbeddedLdapAutoConfiguration;
import org.springframework.boot.test.autoconfigure.data.ldap.DataLdapTest;

</span><span class="fold-block">@DataLdapTest(excludeAutoConfiguration = EmbeddedLdapAutoConfiguration.class)
class MyDataLdapTests {

    // ...

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.autoconfigured-rest-client"><a class="anchor" href="#features.testing.spring-boot-applications.autoconfigured-rest-client"></a>26.3.24. Auto-configured REST Clients</h4>
<div class="paragraph">
<p>You can use the <code>@RestClientTest</code> annotation to test REST clients.
By default, it auto-configures Jackson, GSON, and Jsonb support, configures a <code>RestTemplateBuilder</code>, and adds support for <code>MockRestServiceServer</code>.
Regular <code>@Component</code> and <code>@ConfigurationProperties</code> beans are not scanned when the <code>@RestClientTest</code> annotation is used.
<code>@EnableConfigurationProperties</code> can be used to include <code>@ConfigurationProperties</code> beans.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A list of the auto-configuration settings that are enabled by <code>@RestClientTest</code> can be <a href="test-auto-configuration.html#test-auto-configuration">found in the appendix</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The specific beans that you want to test should be specified by using the <code>value</code> or <code>components</code> attribute of <code>@RestClientTest</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.web.client.RestClientTest;
import org.springframework.http.MediaType;
import org.springframework.test.web.client.MockRestServiceServer;

import static org.assertj.core.api.Assertions.assertThat;
import static org.springframework.test.web.client.match.MockRestRequestMatchers.requestTo;
import static org.springframework.test.web.client.response.MockRestResponseCreators.withSuccess;

</span><span class="fold-block">@RestClientTest(RemoteVehicleDetailsService.class)
class MyRestClientTests {

    @Autowired
    private RemoteVehicleDetailsService service;

    @Autowired
    private MockRestServiceServer server;

    @Test
    void getVehicleDetailsWhenResultIsSuccessShouldReturnDetails() throws Exception {
        this.server.expect(requestTo("/greet/details")).andRespond(withSuccess("hello", MediaType.TEXT_PLAIN));
        String greeting = this.service.callRestService();
        assertThat(greeting).isEqualTo("hello");
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.autoconfigured-spring-restdocs"><a class="anchor" href="#features.testing.spring-boot-applications.autoconfigured-spring-restdocs"></a>26.3.25. Auto-configured Spring REST Docs Tests</h4>
<div class="paragraph">
<p>You can use the <code>@AutoConfigureRestDocs</code> annotation to use <a href="https://spring.io/projects/spring-restdocs">Spring REST Docs</a> in your tests with Mock MVC, REST Assured, or WebTestClient.
It removes the need for the JUnit extension in Spring REST Docs.</p>
</div>
<div class="paragraph">
<p><code>@AutoConfigureRestDocs</code> can be used to override the default output directory (<code>target/generated-snippets</code> if you are using Maven or <code>build/generated-snippets</code> if you are using Gradle).
It can also be used to configure the host, scheme, and port that appears in any documented URIs.</p>
</div>
<div class="sect4">
<h5 id="features.testing.spring-boot-applications.autoconfigured-spring-restdocs.with-mock-mvc"><a class="anchor" href="#features.testing.spring-boot-applications.autoconfigured-spring-restdocs.with-mock-mvc"></a>Auto-configured Spring REST Docs Tests with Mock MVC</h5>
<div class="paragraph">
<p><code>@AutoConfigureRestDocs</code> customizes the <code>MockMvc</code> bean to use Spring REST Docs when testing Servlet-based web applications.
You can inject it by using <code>@Autowired</code> and use it in your tests as you normally would when using Mock MVC and Spring REST Docs, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.restdocs.AutoConfigureRestDocs;
import org.springframework.boot.test.autoconfigure.web.servlet.WebMvcTest;
import org.springframework.http.MediaType;
import org.springframework.test.web.servlet.MockMvc;

import static org.springframework.restdocs.mockmvc.MockMvcRestDocumentation.document;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

</span><span class="fold-block">@WebMvcTest(UserController.class)
@AutoConfigureRestDocs
class MyUserDocumentationTests {

    @Autowired
    private MockMvc mvc;

    @Test
    void listUsers() throws Exception {
        this.mvc.perform(get("/users").accept(MediaType.TEXT_PLAIN))
            .andExpect(status().isOk())
            .andDo(document("list-users"));
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you require more control over Spring REST Docs configuration than offered by the attributes of <code>@AutoConfigureRestDocs</code>, you can use a <code>RestDocsMockMvcConfigurationCustomizer</code> bean, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.test.autoconfigure.restdocs.RestDocsMockMvcConfigurationCustomizer;
import org.springframework.boot.test.context.TestConfiguration;
import org.springframework.restdocs.mockmvc.MockMvcRestDocumentationConfigurer;
import org.springframework.restdocs.templates.TemplateFormats;

</span><span class="fold-block">@TestConfiguration(proxyBeanMethods = false)
public class MyRestDocsConfiguration implements RestDocsMockMvcConfigurationCustomizer {

    @Override
    public void customize(MockMvcRestDocumentationConfigurer configurer) {
        configurer.snippets().withTemplateFormat(TemplateFormats.markdown());
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to make use of Spring REST Docs support for a parameterized output directory, you can create a <code>RestDocumentationResultHandler</code> bean.
The auto-configuration calls <code>alwaysDo</code> with this result handler, thereby causing each <code>MockMvc</code> call to automatically generate the default snippets.
The following example shows a <code>RestDocumentationResultHandler</code> being defined:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.test.context.TestConfiguration;
import org.springframework.context.annotation.Bean;
import org.springframework.restdocs.mockmvc.MockMvcRestDocumentation;
import org.springframework.restdocs.mockmvc.RestDocumentationResultHandler;

</span><span class="fold-block">@TestConfiguration(proxyBeanMethods = false)
public class MyResultHandlerConfiguration {

    @Bean
    public RestDocumentationResultHandler restDocumentation() {
        return MockMvcRestDocumentation.document("{method-name}");
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="features.testing.spring-boot-applications.autoconfigured-spring-restdocs.with-web-test-client"><a class="anchor" href="#features.testing.spring-boot-applications.autoconfigured-spring-restdocs.with-web-test-client"></a>Auto-configured Spring REST Docs Tests with WebTestClient</h5>
<div class="paragraph">
<p><code>@AutoConfigureRestDocs</code> can also be used with <code>WebTestClient</code> when testing reactive web applications.
You can inject it by using <code>@Autowired</code> and use it in your tests as you normally would when using <code>@WebFluxTest</code> and Spring REST Docs, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.restdocs.AutoConfigureRestDocs;
import org.springframework.boot.test.autoconfigure.web.reactive.WebFluxTest;
import org.springframework.test.web.reactive.server.WebTestClient;

import static org.springframework.restdocs.webtestclient.WebTestClientRestDocumentation.document;

</span><span class="fold-block">@WebFluxTest
@AutoConfigureRestDocs
class MyUsersDocumentationTests {

    @Autowired
    private WebTestClient webTestClient;

    @Test
    void listUsers() {
        this.webTestClient
            .get().uri("/")
        .exchange()
        .expectStatus()
            .isOk()
        .expectBody()
            .consumeWith(document("list-users"));
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you require more control over Spring REST Docs configuration than offered by the attributes of <code>@AutoConfigureRestDocs</code>, you can use a <code>RestDocsWebTestClientConfigurationCustomizer</code> bean, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.test.autoconfigure.restdocs.RestDocsWebTestClientConfigurationCustomizer;
import org.springframework.boot.test.context.TestConfiguration;
import org.springframework.restdocs.webtestclient.WebTestClientRestDocumentationConfigurer;

</span><span class="fold-block">@TestConfiguration(proxyBeanMethods = false)
public class MyRestDocsConfiguration implements RestDocsWebTestClientConfigurationCustomizer {

    @Override
    public void customize(WebTestClientRestDocumentationConfigurer configurer) {
        configurer.snippets().withEncoding("UTF-8");
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="features.testing.spring-boot-applications.autoconfigured-spring-restdocs.with-rest-assured"><a class="anchor" href="#features.testing.spring-boot-applications.autoconfigured-spring-restdocs.with-rest-assured"></a>Auto-configured Spring REST Docs Tests with REST Assured</h5>
<div class="paragraph">
<p><code>@AutoConfigureRestDocs</code> makes a <code>RequestSpecification</code> bean, preconfigured to use Spring REST Docs, available to your tests.
You can inject it by using <code>@Autowired</code> and use it in your tests as you normally would when using REST Assured and Spring REST Docs, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.restassured.specification.RequestSpecification;
import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.restdocs.AutoConfigureRestDocs;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.context.SpringBootTest.WebEnvironment;
import org.springframework.boot.web.server.LocalServerPort;

import static io.restassured.RestAssured.given;
import static org.hamcrest.Matchers.is;
import static org.springframework.restdocs.restassured3.RestAssuredRestDocumentation.document;

</span><span class="fold-block">@SpringBootTest(webEnvironment = WebEnvironment.RANDOM_PORT)
@AutoConfigureRestDocs
class MyUserDocumentationTests {

    @Test
    void listUsers(@Autowired RequestSpecification documentationSpec, @LocalServerPort int port) {
        given(documentationSpec)
            .filter(document("list-users"))
        .when()
            .port(port)
            .get("/")
        .then().assertThat()
            .statusCode(is(200));
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you require more control over Spring REST Docs configuration than offered by the attributes of <code>@AutoConfigureRestDocs</code>, a <code>RestDocsRestAssuredConfigurationCustomizer</code> bean can be used, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.test.autoconfigure.restdocs.RestDocsRestAssuredConfigurationCustomizer;
import org.springframework.boot.test.context.TestConfiguration;
import org.springframework.restdocs.restassured3.RestAssuredRestDocumentationConfigurer;
import org.springframework.restdocs.templates.TemplateFormats;

</span><span class="fold-block">@TestConfiguration(proxyBeanMethods = false)
public class MyRestDocsConfiguration implements RestDocsRestAssuredConfigurationCustomizer {

    @Override
    public void customize(RestAssuredRestDocumentationConfigurer configurer) {
        configurer.snippets().withTemplateFormat(TemplateFormats.markdown());
    }

}
</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.autoconfigured-webservices"><a class="anchor" href="#features.testing.spring-boot-applications.autoconfigured-webservices"></a>26.3.26. Auto-configured Spring Web Services Tests</h4>
<div class="paragraph">
<p>You can use <code>@WebServiceClientTest</code> to test applications that use call web services using the Spring Web Services project.
By default, it configures a mock <code>WebServiceServer</code> bean and automatically customizes your <code>WebServiceTemplateBuilder</code>.
(For more about using Web Services with Spring Boot, see "<a href="#features.webservices">Web Services</a>", earlier in this chapter.)</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A list of the auto-configuration settings that are enabled by <code>@WebServiceClientTest</code> can be <a href="test-auto-configuration.html#test-auto-configuration">found in the appendix</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following example shows the <code>@WebServiceClientTest</code> annotation in use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.webservices.client.WebServiceClientTest;
import org.springframework.ws.test.client.MockWebServiceServer;
import org.springframework.xml.transform.StringSource;

import static org.assertj.core.api.Assertions.assertThat;
import static org.springframework.ws.test.client.RequestMatchers.payload;
import static org.springframework.ws.test.client.ResponseCreators.withPayload;

</span><span class="fold-block">@WebServiceClientTest(SomeWebService.class)
class MyWebServiceClientTests {

    @Autowired
    private MockWebServiceServer server;

    @Autowired
    private SomeWebService someWebService;

    @Test
    void mockServerCall() {
        this.server
            .expect(payload(new StringSource("&lt;request/&gt;")))
            .andRespond(withPayload(new StringSource("&lt;response&gt;&lt;status&gt;200&lt;/status&gt;&lt;/response&gt;")));
        assertThat(this.someWebService.test())
            .extracting(Response::getStatus)
            .isEqualTo(200);
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.additional-autoconfiguration-and-slicing"><a class="anchor" href="#features.testing.spring-boot-applications.additional-autoconfiguration-and-slicing"></a>26.3.27. Additional Auto-configuration and Slicing</h4>
<div class="paragraph">
<p>Each slice provides one or more <code>@AutoConfigure&#8230;&#8203;</code> annotations that namely defines the auto-configurations that should be included as part of a slice.
Additional auto-configurations can be added on a test-by-test basis by creating a custom <code>@AutoConfigure&#8230;&#8203;</code> annotation or by adding <code>@ImportAutoConfiguration</code> to the test as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.autoconfigure.ImportAutoConfiguration;
import org.springframework.boot.autoconfigure.integration.IntegrationAutoConfiguration;
import org.springframework.boot.test.autoconfigure.jdbc.JdbcTest;

</span><span class="fold-block">@JdbcTest
@ImportAutoConfiguration(IntegrationAutoConfiguration.class)
class MyJdbcTests {

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Make sure to not use the regular <code>@Import</code> annotation to import auto-configurations as they are handled in a specific way by Spring Boot.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Alternatively, additional auto-configurations can be added for any use of a slice annotation by registering them in <code>META-INF/spring.factories</code> as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>org.springframework.boot.test.autoconfigure.jdbc.JdbcTest=com.example.IntegrationAutoConfiguration</pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A slice or <code>@AutoConfigure&#8230;&#8203;</code> annotation can be customized this way as long as it is meta-annotated with <code>@ImportAutoConfiguration</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.user-configuration-and-slicing"><a class="anchor" href="#features.testing.spring-boot-applications.user-configuration-and-slicing"></a>26.3.28. User Configuration and Slicing</h4>
<div class="paragraph">
<p>If you <a href="using.html#using.structuring-your-code">structure your code</a> in a sensible way, your <code>@SpringBootApplication</code> class is <a href="#features.testing.spring-boot-applications.detecting-configuration">used by default</a> as the configuration of your tests.</p>
</div>
<div class="paragraph">
<p>It then becomes important not to litter the application&#8217;s main class with configuration settings that are specific to a particular area of its functionality.</p>
</div>
<div class="paragraph">
<p>Assume that you are using Spring Batch and you rely on the auto-configuration for it.
You could define your <code>@SpringBootApplication</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.batch.core.configuration.annotation.EnableBatchProcessing;
import org.springframework.boot.autoconfigure.SpringBootApplication;

</span><span class="fold-block">@SpringBootApplication
@EnableBatchProcessing
public class MyApplication {

    // ...

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Because this class is the source configuration for the test, any slice test actually tries to start Spring Batch, which is definitely not what you want to do.
A recommended approach is to move that area-specific configuration to a separate <code>@Configuration</code> class at the same level as your application, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.batch.core.configuration.annotation.EnableBatchProcessing;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
@EnableBatchProcessing
public class MyBatchConfiguration {

    // ...

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Depending on the complexity of your application, you may either have a single <code>@Configuration</code> class for your customizations or one class per domain area.
The latter approach lets you enable it in one of your tests, if necessary, with the <code>@Import</code> annotation.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Test slices exclude <code>@Configuration</code> classes from scanning.
For example, for a <code>@WebMvcTest</code>, the following configuration will not include the given <code>WebMvcConfigurer</code> bean in the application context loaded by the test slice:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyWebConfiguration {

    @Bean
    public WebMvcConfigurer testConfigurer() {
        return new WebMvcConfigurer() {
            // ...
        };
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The configuration below will, however, cause the custom <code>WebMvcConfigurer</code> to be loaded by the test slice.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.stereotype.Component;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

</span><span class="fold-block">@Component
public class MyWebMvcConfigurer implements WebMvcConfigurer {

    // ...

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Another source of confusion is classpath scanning.
Assume that, while you structured your code in a sensible way, you need to scan an additional package.
Your application may resemble the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.annotation.ComponentScan;

</span><span class="fold-block">@SpringBootApplication
@ComponentScan({ "com.example.app", "com.example.another" })
public class MyApplication {

    // ...

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Doing so effectively overrides the default component scan directive with the side effect of scanning those two packages regardless of the slice that you chose.
For instance, a <code>@DataJpaTest</code> seems to suddenly scan components and user configurations of your application.
Again, moving the custom directive to a separate class is a good way to fix this issue.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If this is not an option for you, you can create a <code>@SpringBootConfiguration</code> somewhere in the hierarchy of your test so that it is used instead.
Alternatively, you can specify a source for your test, which disables the behavior of finding a default one.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.spring-boot-applications.spock"><a class="anchor" href="#features.testing.spring-boot-applications.spock"></a>26.3.29. Using Spock to Test Spring Boot Applications</h4>
<div class="paragraph">
<p>Spock 2.x can be used to test a Spring Boot application.
To do so, add a dependency on Spock&#8217;s <code>spock-spring</code> module to your application&#8217;s build.
<code>spock-spring</code> integrates Spring&#8217;s test framework into Spock.
See <a href="https://spockframework.org/spock/docs/2.0/modules.html#_spring_module">the documentation for Spock&#8217;s Spring module</a> for further details.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.testing.utilities"><a class="anchor" href="#features.testing.utilities"></a>26.4. Test Utilities</h3>
<div class="paragraph">
<p>A few test utility classes that are generally useful when testing your application are packaged as part of <code>spring-boot</code>.</p>
</div>
<div class="sect3">
<h4 id="features.testing.utilities.config-data-application-context-initializer"><a class="anchor" href="#features.testing.utilities.config-data-application-context-initializer"></a>26.4.1. ConfigDataApplicationContextInitializer</h4>
<div class="paragraph">
<p><code>ConfigDataApplicationContextInitializer</code> is an <code>ApplicationContextInitializer</code> that you can apply to your tests to load Spring Boot <code>application.properties</code> files.
You can use it when you do not need the full set of features provided by <code>@SpringBootTest</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.test.context.ConfigDataApplicationContextInitializer;
import org.springframework.test.context.ContextConfiguration;

</span><span class="fold-block">@ContextConfiguration(classes = Config.class, initializers = ConfigDataApplicationContextInitializer.class)
class MyConfigFileTests {

    // ...

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Using <code>ConfigDataApplicationContextInitializer</code> alone does not provide support for <code>@Value("${&#8230;&#8203;}")</code> injection.
Its only job is to ensure that <code>application.properties</code> files are loaded into Spring&#8217;s <code>Environment</code>.
For <code>@Value</code> support, you need to either additionally configure a <code>PropertySourcesPlaceholderConfigurer</code> or use <code>@SpringBootTest</code>, which auto-configures one for you.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.utilities.test-property-values"><a class="anchor" href="#features.testing.utilities.test-property-values"></a>26.4.2. TestPropertyValues</h4>
<div class="paragraph">
<p><code>TestPropertyValues</code> lets you quickly add properties to a <code>ConfigurableEnvironment</code> or <code>ConfigurableApplicationContext</code>.
You can call it with <code>key=value</code> strings, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.boot.test.util.TestPropertyValues;
import org.springframework.mock.env.MockEnvironment;

import static org.assertj.core.api.Assertions.assertThat;

</span><span class="fold-block">class MyEnvironmentTests {

    @Test
    void testPropertySources() {
        MockEnvironment environment = new MockEnvironment();
        TestPropertyValues.of("org=Spring", "name=Boot").applyTo(environment);
        assertThat(environment.getProperty("name")).isEqualTo("Boot");
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.utilities.output-capture"><a class="anchor" href="#features.testing.utilities.output-capture"></a>26.4.3. OutputCapture</h4>
<div class="paragraph">
<p><code>OutputCapture</code> is a JUnit <code>Extension</code> that you can use to capture <code>System.out</code> and <code>System.err</code> output.
To use add <code>@ExtendWith(OutputCaptureExtension.class)</code> and inject <code>CapturedOutput</code> as an argument to your test class constructor or test method as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;

import org.springframework.boot.test.system.CapturedOutput;
import org.springframework.boot.test.system.OutputCaptureExtension;

import static org.assertj.core.api.Assertions.assertThat;

</span><span class="fold-block">@ExtendWith(OutputCaptureExtension.class)
class MyOutputCaptureTests {

    @Test
    void testName(CapturedOutput output) {
        System.out.println("Hello World!");
        assertThat(output).contains("World");
    }

}
</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.testing.utilities.test-rest-template"><a class="anchor" href="#features.testing.utilities.test-rest-template"></a>26.4.4. TestRestTemplate</h4>
<div class="paragraph">
<p><code>TestRestTemplate</code> is a convenience alternative to Spring&#8217;s <code>RestTemplate</code> that is useful in integration tests.
You can get a vanilla template or one that sends Basic HTTP authentication (with a username and password).
In either case, the template is fault tolerant.
This means that it behaves in a test-friendly way by not throwing exceptions on 4xx and 5xx errors.
Instead, such errors can be detected via the returned <code>ResponseEntity</code> and its status code.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Spring Framework 5.0 provides a new <code>WebTestClient</code> that works for <a href="#features.testing.spring-boot-applications.spring-webflux-tests">WebFlux integration tests</a> and both <a href="#features.testing.spring-boot-applications.with-running-server">WebFlux and MVC end-to-end testing</a>.
It provides a fluent API for assertions, unlike <code>TestRestTemplate</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is recommended, but not mandatory, to use the Apache HTTP Client (version 4.3.2 or better).
If you have that on your classpath, the <code>TestRestTemplate</code> responds by configuring the client appropriately.
If you do use Apache&#8217;s HTTP client, some additional test-friendly features are enabled:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Redirects are not followed (so you can assert the response location).</p>
</li>
<li>
<p>Cookies are ignored (so the template is stateless).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>TestRestTemplate</code> can be instantiated directly in your integration tests, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.boot.test.web.client.TestRestTemplate;
import org.springframework.http.ResponseEntity;

import static org.assertj.core.api.Assertions.assertThat;

</span><span class="fold-block">class MyTests {

    private TestRestTemplate template = new TestRestTemplate();

    @Test
    void testRequest() throws Exception {
        ResponseEntity&lt;String&gt; headers = this.template.getForEntity("https://myhost.example.com/example", String.class);
        assertThat(headers.getHeaders().getLocation()).hasHost("other.example.com");
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, if you use the <code>@SpringBootTest</code> annotation with <code>WebEnvironment.RANDOM_PORT</code> or <code>WebEnvironment.DEFINED_PORT</code>, you can inject a fully configured <code>TestRestTemplate</code> and start using it.
If necessary, additional customizations can be applied through the <code>RestTemplateBuilder</code> bean.
Any URLs that do not specify a host and port automatically connect to the embedded server, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.time.Duration;

import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.context.SpringBootTest.WebEnvironment;
import org.springframework.boot.test.context.TestConfiguration;
import org.springframework.boot.test.web.client.TestRestTemplate;
import org.springframework.boot.web.client.RestTemplateBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.http.HttpHeaders;

import static org.assertj.core.api.Assertions.assertThat;

</span><span class="fold-block">@SpringBootTest(webEnvironment = WebEnvironment.RANDOM_PORT)
class MySpringBootTests {

    @Autowired
    private TestRestTemplate template;

    @Test
    void testRequest() {
        HttpHeaders headers = this.template.getForEntity("/example", String.class).getHeaders();
        assertThat(headers.getLocation()).hasHost("other.example.com");
    }

    @TestConfiguration(proxyBeanMethods = false)
    static class RestTemplateBuilderConfiguration {

        @Bean
        RestTemplateBuilder restTemplateBuilder() {
            return new RestTemplateBuilder().setConnectTimeout(Duration.ofSeconds(1))
                    .setReadTimeout(Duration.ofSeconds(1));
        }

    }

}
</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.websockets"><a class="anchor" href="#features.websockets"></a>27. WebSockets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot provides WebSockets auto-configuration for embedded Tomcat, Jetty, and Undertow.
If you deploy a war file to a standalone container, Spring Boot assumes that the container is responsible for the configuration of its WebSocket support.</p>
</div>
<div class="paragraph">
<p>Spring Framework provides <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/web.html#websocket">rich WebSocket support</a> for MVC web applications that can be easily accessed through the <code>spring-boot-starter-websocket</code> module.</p>
</div>
<div class="paragraph">
<p>WebSocket support is also available for <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/web-reactive.html#webflux-websocket">reactive web applications</a> and requires to include the WebSocket API alongside <code>spring-boot-starter-webflux</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;javax.websocket&lt;/groupId&gt;
    &lt;artifactId&gt;javax.websocket-api&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.webservices"><a class="anchor" href="#features.webservices"></a>28. Web Services</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Spring Boot provides Web Services auto-configuration so that all you must do is define your <code>Endpoints</code>.</p>
</div>
<div class="paragraph">
<p>The <a href="https://docs.spring.io/spring-ws/docs/3.1.1/reference/html/">Spring Web Services features</a> can be easily accessed with the <code>spring-boot-starter-webservices</code> module.</p>
</div>
<div class="paragraph">
<p><code>SimpleWsdl11Definition</code> and <code>SimpleXsdSchema</code> beans can be automatically created for your WSDLs and XSDs respectively.
To do so, configure their location, as shown in the following example:</p>
</div>
<div class="listingblock primary">
<div class="title">Properties</div>
<div class="content">
<pre class="highlight"><code class="language-properties" data-lang="properties">spring.webservices.wsdl-locations=classpath:/wsdl</code></pre>
</div>
</div>
<div class="listingblock secondary">
<div class="title">Yaml</div>
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">spring:
  webservices:
    wsdl-locations: "classpath:/wsdl"</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="features.webservices.template"><a class="anchor" href="#features.webservices.template"></a>28.1. Calling Web Services with WebServiceTemplate</h3>
<div class="paragraph">
<p>If you need to call remote Web services from your application, you can use the <a href="https://docs.spring.io/spring-ws/docs/3.1.1/reference/html/#client-web-service-template"><code>WebServiceTemplate</code></a> class.
Since <code>WebServiceTemplate</code> instances often need to be customized before being used, Spring Boot does not provide any single auto-configured <code>WebServiceTemplate</code> bean.
It does, however, auto-configure a <code>WebServiceTemplateBuilder</code>, which can be used to create <code>WebServiceTemplate</code> instances when needed.</p>
</div>
<div class="paragraph">
<p>The following code shows a typical example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.webservices.client.WebServiceTemplateBuilder;
import org.springframework.stereotype.Service;
import org.springframework.ws.client.core.WebServiceTemplate;
import org.springframework.ws.soap.client.core.SoapActionCallback;

</span><span class="fold-block">@Service
public class MyService {

    private final WebServiceTemplate webServiceTemplate;

    public MyService(WebServiceTemplateBuilder webServiceTemplateBuilder) {
        this.webServiceTemplate = webServiceTemplateBuilder.build();
    }

    public SomeResponse someWsCall(SomeRequest detailsReq) {
        return (SomeResponse) this.webServiceTemplate.marshalSendAndReceive(detailsReq,
                new SoapActionCallback("https://ws.example.com/action"));
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, <code>WebServiceTemplateBuilder</code> detects a suitable HTTP-based <code>WebServiceMessageSender</code> using the available HTTP client libraries on the classpath.
You can also customize read and connection timeouts as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.time.Duration;

import org.springframework.boot.webservices.client.HttpWebServiceMessageSenderBuilder;
import org.springframework.boot.webservices.client.WebServiceTemplateBuilder;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.ws.client.core.WebServiceTemplate;
import org.springframework.ws.transport.WebServiceMessageSender;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyWebServiceTemplateConfiguration {

    @Bean
    public WebServiceTemplate webServiceTemplate(WebServiceTemplateBuilder builder) {
        WebServiceMessageSender sender = new HttpWebServiceMessageSenderBuilder()
                .setConnectTimeout(Duration.ofSeconds(5))
                .setReadTimeout(Duration.ofSeconds(2))
                .build();
        return builder.messageSenders(sender).build();
    }

}
</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.developing-auto-configuration"><a class="anchor" href="#features.developing-auto-configuration"></a>29. Creating Your Own Auto-configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you work in a company that develops shared libraries, or if you work on an open-source or commercial library, you might want to develop your own auto-configuration.
Auto-configuration classes can be bundled in external jars and still be picked-up by Spring Boot.</p>
</div>
<div class="paragraph">
<p>Auto-configuration can be associated to a &#8220;starter&#8221; that provides the auto-configuration code as well as the typical libraries that you would use with it.
We first cover what you need to know to build your own auto-configuration and then we move on to the <a href="#features.developing-auto-configuration.custom-starter">typical steps required to create a custom starter</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
A <a href="https://github.com/snicoll-demos/spring-boot-master-auto-configuration">demo project</a> is available to showcase how you can create a starter step-by-step.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="features.developing-auto-configuration.understanding-auto-configured-beans"><a class="anchor" href="#features.developing-auto-configuration.understanding-auto-configured-beans"></a>29.1. Understanding Auto-configured Beans</h3>
<div class="paragraph">
<p>Under the hood, auto-configuration is implemented with standard <code>@Configuration</code> classes.
Additional <code>@Conditional</code> annotations are used to constrain when the auto-configuration should apply.
Usually, auto-configuration classes use <code>@ConditionalOnClass</code> and <code>@ConditionalOnMissingBean</code> annotations.
This ensures that auto-configuration applies only when relevant classes are found and when you have not declared your own <code>@Configuration</code>.</p>
</div>
<div class="paragraph">
<p>You can browse the source code of <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure"><code>spring-boot-autoconfigure</code></a> to see the <code>@Configuration</code> classes that Spring provides (see the <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot-autoconfigure/src/main/resources/META-INF/spring.factories"><code>META-INF/spring.factories</code></a> file).</p>
</div>
</div>
<div class="sect2">
<h3 id="features.developing-auto-configuration.locating-auto-configuration-candidates"><a class="anchor" href="#features.developing-auto-configuration.locating-auto-configuration-candidates"></a>29.2. Locating Auto-configuration Candidates</h3>
<div class="paragraph">
<p>Spring Boot checks for the presence of a <code>META-INF/spring.factories</code> file within your published jar.
The file should list your configuration classes under the <code>EnableAutoConfiguration</code> key, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>org.springframework.boot.autoconfigure.EnableAutoConfiguration=\
com.mycorp.libx.autoconfigure.LibXAutoConfiguration,\
com.mycorp.libx.autoconfigure.LibXWebAutoConfiguration</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Auto-configurations must be loaded that way <em>only</em>.
Make sure that they are defined in a specific package space and that they are never the target of component scanning.
Furthermore, auto-configuration classes should not enable component scanning to find additional components.
Specific <code>@Import</code>s should be used instead.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can use the <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/AutoConfigureAfter.java"><code>@AutoConfigureAfter</code></a> or <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/AutoConfigureBefore.java"><code>@AutoConfigureBefore</code></a> annotations if your configuration needs to be applied in a specific order.
For example, if you provide web-specific configuration, your class may need to be applied after <code>WebMvcAutoConfiguration</code>.</p>
</div>
<div class="paragraph">
<p>If you want to order certain auto-configurations that should not have any direct knowledge of each other, you can also use <code>@AutoConfigureOrder</code>.
That annotation has the same semantic as the regular <code>@Order</code> annotation but provides a dedicated order for auto-configuration classes.</p>
</div>
<div class="paragraph">
<p>As with standard <code>@Configuration</code> classes, the order in which auto-configuration classes are applied only affects the order in which their beans are defined.
The order in which those beans are subsequently created is unaffected and is determined by each bean&#8217;s dependencies and any <code>@DependsOn</code> relationships.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.developing-auto-configuration.condition-annotations"><a class="anchor" href="#features.developing-auto-configuration.condition-annotations"></a>29.3. Condition Annotations</h3>
<div class="paragraph">
<p>You almost always want to include one or more <code>@Conditional</code> annotations on your auto-configuration class.
The <code>@ConditionalOnMissingBean</code> annotation is one common example that is used to allow developers to override auto-configuration if they are not happy with your defaults.</p>
</div>
<div class="paragraph">
<p>Spring Boot includes a number of <code>@Conditional</code> annotations that you can reuse in your own code by annotating <code>@Configuration</code> classes or individual <code>@Bean</code> methods.
These annotations include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#features.developing-auto-configuration.condition-annotations.class-conditions">Class Conditions</a></p>
</li>
<li>
<p><a href="#features.developing-auto-configuration.condition-annotations.bean-conditions">Bean Conditions</a></p>
</li>
<li>
<p><a href="#features.developing-auto-configuration.condition-annotations.property-conditions">Property Conditions</a></p>
</li>
<li>
<p><a href="#features.developing-auto-configuration.condition-annotations.resource-conditions">Resource Conditions</a></p>
</li>
<li>
<p><a href="#features.developing-auto-configuration.condition-annotations.web-application-conditions">Web Application Conditions</a></p>
</li>
<li>
<p><a href="#features.developing-auto-configuration.condition-annotations.spel-conditions">SpEL Expression Conditions</a></p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="features.developing-auto-configuration.condition-annotations.class-conditions"><a class="anchor" href="#features.developing-auto-configuration.condition-annotations.class-conditions"></a>29.3.1. Class Conditions</h4>
<div class="paragraph">
<p>The <code>@ConditionalOnClass</code> and <code>@ConditionalOnMissingClass</code> annotations let <code>@Configuration</code> classes be included based on the presence or absence of specific classes.
Due to the fact that annotation metadata is parsed by using <a href="https://asm.ow2.io/">ASM</a>, you can use the <code>value</code> attribute to refer to the real class, even though that class might not actually appear on the running application classpath.
You can also use the <code>name</code> attribute if you prefer to specify the class name by using a <code>String</code> value.</p>
</div>
<div class="paragraph">
<p>This mechanism does not apply the same way to <code>@Bean</code> methods where typically the return type is the target of the condition: before the condition on the method applies, the JVM will have loaded the class and potentially processed method references which will fail if the class is not present.</p>
</div>
<div class="paragraph">
<p>To handle this scenario, a separate <code>@Configuration</code> class can be used to isolate the condition, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.autoconfigure.condition.ConditionalOnClass;
import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
// Some conditions ...
public class MyAutoConfiguration {

    // Auto-configured beans ...

    @Configuration(proxyBeanMethods = false)
    @ConditionalOnClass(SomeService.class)
    public static class SomeServiceConfiguration {

        @Bean
        @ConditionalOnMissingBean
        public SomeService someService() {
            return new SomeService();
        }

    }

}
</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If you use <code>@ConditionalOnClass</code> or <code>@ConditionalOnMissingClass</code> as a part of a meta-annotation to compose your own composed annotations, you must use <code>name</code> as referring to the class in such a case is not handled.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-auto-configuration.condition-annotations.bean-conditions"><a class="anchor" href="#features.developing-auto-configuration.condition-annotations.bean-conditions"></a>29.3.2. Bean Conditions</h4>
<div class="paragraph">
<p>The <code>@ConditionalOnBean</code> and <code>@ConditionalOnMissingBean</code> annotations let a bean be included based on the presence or absence of specific beans.
You can use the <code>value</code> attribute to specify beans by type or <code>name</code> to specify beans by name.
The <code>search</code> attribute lets you limit the <code>ApplicationContext</code> hierarchy that should be considered when searching for beans.</p>
</div>
<div class="paragraph">
<p>When placed on a <code>@Bean</code> method, the target type defaults to the return type of the method, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyAutoConfiguration {

    @Bean
    @ConditionalOnMissingBean
    public SomeService someService() {
        return new SomeService();
    }

}
</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the preceding example, the <code>myService</code> bean is going to be created if no bean of type <code>MyService</code> is already contained in the <code>ApplicationContext</code>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You need to be very careful about the order in which bean definitions are added, as these conditions are evaluated based on what has been processed so far.
For this reason, we recommend using only <code>@ConditionalOnBean</code> and <code>@ConditionalOnMissingBean</code> annotations on auto-configuration classes (since these are guaranteed to load after any user-defined bean definitions have been added).
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>@ConditionalOnBean</code> and <code>@ConditionalOnMissingBean</code> do not prevent <code>@Configuration</code> classes from being created.
The only difference between using these conditions at the class level and marking each contained <code>@Bean</code> method with the annotation is that the former prevents registration of the <code>@Configuration</code> class as a bean if the condition does not match.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
When declaring a <code>@Bean</code> method, provide as much type information as possible in the method&#8217;s return type.
For example, if your bean&#8217;s concrete class implements an interface the bean method&#8217;s return type should be the concrete class and not the interface.
Providing as much type information as possible in <code>@Bean</code> methods is particularly important when using bean conditions as their evaluation can only rely upon to type information that&#8217;s available in the method signature.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-auto-configuration.condition-annotations.property-conditions"><a class="anchor" href="#features.developing-auto-configuration.condition-annotations.property-conditions"></a>29.3.3. Property Conditions</h4>
<div class="paragraph">
<p>The <code>@ConditionalOnProperty</code> annotation lets configuration be included based on a Spring Environment property.
Use the <code>prefix</code> and <code>name</code> attributes to specify the property that should be checked.
By default, any property that exists and is not equal to <code>false</code> is matched.
You can also create more advanced checks by using the <code>havingValue</code> and <code>matchIfMissing</code> attributes.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-auto-configuration.condition-annotations.resource-conditions"><a class="anchor" href="#features.developing-auto-configuration.condition-annotations.resource-conditions"></a>29.3.4. Resource Conditions</h4>
<div class="paragraph">
<p>The <code>@ConditionalOnResource</code> annotation lets configuration be included only when a specific resource is present.
Resources can be specified by using the usual Spring conventions, as shown in the following example: <code>file:/home/user/test.dat</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-auto-configuration.condition-annotations.web-application-conditions"><a class="anchor" href="#features.developing-auto-configuration.condition-annotations.web-application-conditions"></a>29.3.5. Web Application Conditions</h4>
<div class="paragraph">
<p>The <code>@ConditionalOnWebApplication</code> and <code>@ConditionalOnNotWebApplication</code> annotations let configuration be included depending on whether the application is a &#8220;web application&#8221;.
A servlet-based web application is any application that uses a Spring <code>WebApplicationContext</code>, defines a <code>session</code> scope, or has a <code>ConfigurableWebEnvironment</code>.
A reactive web application is any application that uses a <code>ReactiveWebApplicationContext</code>, or has a <code>ConfigurableReactiveWebEnvironment</code>.</p>
</div>
<div class="paragraph">
<p>The <code>@ConditionalOnWarDeployment</code> annotation lets configuration be included depending on whether the application is a traditional WAR application that is deployed to a container.
This condition will not match for applications that are run with an embedded server.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-auto-configuration.condition-annotations.spel-conditions"><a class="anchor" href="#features.developing-auto-configuration.condition-annotations.spel-conditions"></a>29.3.6. SpEL Expression Conditions</h4>
<div class="paragraph">
<p>The <code>@ConditionalOnExpression</code> annotation lets configuration be included based on the result of a <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/core.html#expressions">SpEL expression</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.developing-auto-configuration.testing"><a class="anchor" href="#features.developing-auto-configuration.testing"></a>29.4. Testing your Auto-configuration</h3>
<div class="paragraph">
<p>An auto-configuration can be affected by many factors: user configuration (<code>@Bean</code> definition and <code>Environment</code> customization), condition evaluation (presence of a particular library), and others.
Concretely, each test should create a well defined <code>ApplicationContext</code> that represents a combination of those customizations.
<code>ApplicationContextRunner</code> provides a great way to achieve that.</p>
</div>
<div class="paragraph">
<p><code>ApplicationContextRunner</code> is usually defined as a field of the test class to gather the base, common configuration.
The following example makes sure that <code>MyServiceAutoConfiguration</code> is always invoked:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">private final ApplicationContextRunner contextRunner = new ApplicationContextRunner()
        .withConfiguration(AutoConfigurations.of(MyServiceAutoConfiguration.class));
</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If multiple auto-configurations have to be defined, there is no need to order their declarations as they are invoked in the exact same order as when running the application.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each test can use the runner to represent a particular use case.
For instance, the sample below invokes a user configuration (<code>UserConfiguration</code>) and checks that the auto-configuration backs off properly.
Invoking <code>run</code> provides a callback context that can be used with <code>AssertJ</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
void defaultServiceBacksOff() {
    this.contextRunner.withUserConfiguration(UserConfiguration.class).run((context) -&gt; {
        assertThat(context).hasSingleBean(MyService.class);
        assertThat(context).getBean("myCustomService").isSameAs(context.getBean(MyService.class));
    });
}

@Configuration(proxyBeanMethods = false)
static class UserConfiguration {

    @Bean
    MyService myCustomService() {
        return new MyService("mine");
    }

}
</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to easily customize the <code>Environment</code>, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
void serviceNameCanBeConfigured() {
    this.contextRunner.withPropertyValues("user.name=test123").run((context) -&gt; {
        assertThat(context).hasSingleBean(MyService.class);
        assertThat(context.getBean(MyService.class).getName()).isEqualTo("test123");
    });
}
</code></pre>
</div>
</div>
<div class="paragraph">
<p>The runner can also be used to display the <code>ConditionEvaluationReport</code>.
The report can be printed at <code>INFO</code> or <code>DEBUG</code> level.
The following example shows how to use the <code>ConditionEvaluationReportLoggingListener</code> to print the report in auto-configuration tests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.junit.jupiter.api.Test;

import org.springframework.boot.autoconfigure.logging.ConditionEvaluationReportLoggingListener;
import org.springframework.boot.logging.LogLevel;
import org.springframework.boot.test.context.runner.ApplicationContextRunner;

</span><span class="fold-block">class MyConditionEvaluationReportingTests {

    @Test
    void autoConfigTest() {
        new ApplicationContextRunner()
            .withInitializer(new ConditionEvaluationReportLoggingListener(LogLevel.INFO))
            .run((context) -&gt; {
                    // Test something...
            });
    }

}
</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-auto-configuration.testing.simulating-a-web-context"><a class="anchor" href="#features.developing-auto-configuration.testing.simulating-a-web-context"></a>29.4.1. Simulating a Web Context</h4>
<div class="paragraph">
<p>If you need to test an auto-configuration that only operates in a Servlet or Reactive web application context, use the <code>WebApplicationContextRunner</code> or <code>ReactiveWebApplicationContextRunner</code> respectively.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-auto-configuration.testing.overriding-classpath"><a class="anchor" href="#features.developing-auto-configuration.testing.overriding-classpath"></a>29.4.2. Overriding the Classpath</h4>
<div class="paragraph">
<p>It is also possible to test what happens when a particular class and/or package is not present at runtime.
Spring Boot ships with a <code>FilteredClassLoader</code> that can easily be used by the runner.
In the following example, we assert that if <code>MyService</code> is not present, the auto-configuration is properly disabled:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Test
void serviceIsIgnoredIfLibraryIsNotPresent() {
    this.contextRunner.withClassLoader(new FilteredClassLoader(MyService.class))
            .run((context) -&gt; assertThat(context).doesNotHaveBean("myService"));
}
</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.developing-auto-configuration.custom-starter"><a class="anchor" href="#features.developing-auto-configuration.custom-starter"></a>29.5. Creating Your Own Starter</h3>
<div class="paragraph">
<p>A typical Spring Boot starter contains code to auto-configure and customize the infrastructure of a given technology, let&#8217;s call that "acme".
To make it easily extensible, a number of configuration keys in a dedicated namespace can be exposed to the environment.
Finally, a single "starter" dependency is provided to help users get started as easily as possible.</p>
</div>
<div class="paragraph">
<p>Concretely, a custom starter can contain the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>autoconfigure</code> module that contains the auto-configuration code for "acme".</p>
</li>
<li>
<p>The <code>starter</code> module that provides a dependency to the <code>autoconfigure</code> module as well as "acme" and any additional dependencies that are typically useful.
In a nutshell, adding the starter should provide everything needed to start using that library.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This separation in two modules is in no way necessary.
If "acme" has several flavors, options or optional features, then it is better to separate the auto-configuration as you can clearly express the fact some features are optional.
Besides, you have the ability to craft a starter that provides an opinion about those optional dependencies.
At the same time, others can rely only on the <code>autoconfigure</code> module and craft their own starter with different opinions.</p>
</div>
<div class="paragraph">
<p>If the auto-configuration is relatively straightforward and does not have optional feature, merging the two modules in the starter is definitely an option.</p>
</div>
<div class="sect3">
<h4 id="features.developing-auto-configuration.custom-starter.naming"><a class="anchor" href="#features.developing-auto-configuration.custom-starter.naming"></a>29.5.1. Naming</h4>
<div class="paragraph">
<p>You should make sure to provide a proper namespace for your starter.
Do not start your module names with <code>spring-boot</code>, even if you use a different Maven <code>groupId</code>.
We may offer official support for the thing you auto-configure in the future.</p>
</div>
<div class="paragraph">
<p>As a rule of thumb, you should name a combined module after the starter.
For example, assume that you are creating a starter for "acme" and that you name the auto-configure module <code>acme-spring-boot</code> and the starter <code>acme-spring-boot-starter</code>.
If you only have one module that combines the two, name it <code>acme-spring-boot-starter</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-auto-configuration.custom-starter.configuration-keys"><a class="anchor" href="#features.developing-auto-configuration.custom-starter.configuration-keys"></a>29.5.2. Configuration keys</h4>
<div class="paragraph">
<p>If your starter provides configuration keys, use a unique namespace for them.
In particular, do not include your keys in the namespaces that Spring Boot uses (such as <code>server</code>, <code>management</code>, <code>spring</code>, and so on).
If you use the same namespace, we may modify these namespaces in the future in ways that break your modules.
As a rule of thumb, prefix all your keys with a namespace that you own (e.g. <code>acme</code>).</p>
</div>
<div class="paragraph">
<p>Make sure that configuration keys are documented by adding field javadoc for each property, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.time.Duration;

import org.springframework.boot.context.properties.ConfigurationProperties;

</span><span class="fold-block">@ConfigurationProperties("acme")
public class AcmeProperties {

    /**
     * Whether to check the location of acme resources.
     */
    private boolean checkLocation = true;

    /**
     * Timeout for establishing a connection to the acme server.
     */
    private Duration loginTimeout = Duration.ofSeconds(3);

</span><span class="fold-block hide-when-unfolded">    // getters/setters ...

</span><span class="fold-block hide-when-folded">    public boolean isCheckLocation() {
        return this.checkLocation;
    }

    public void setCheckLocation(boolean checkLocation) {
        this.checkLocation = checkLocation;
    }

    public Duration getLoginTimeout() {
        return this.loginTimeout;
    }

    public void setLoginTimeout(Duration loginTimeout) {
        this.loginTimeout = loginTimeout;
    }

</span><span class="fold-block">}
</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
You should only use plain text with <code>@ConfigurationProperties</code> field Javadoc, since they are not processed before being added to the JSON.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here are some rules we follow internally to make sure descriptions are consistent:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Do not start the description by "The" or "A".</p>
</li>
<li>
<p>For <code>boolean</code> types, start the description with "Whether" or "Enable".</p>
</li>
<li>
<p>For collection-based types, start the description with "Comma-separated list"</p>
</li>
<li>
<p>Use <code>java.time.Duration</code> rather than <code>long</code> and describe the default unit if it differs from milliseconds, e.g. "If a duration suffix is not specified, seconds will be used".</p>
</li>
<li>
<p>Do not provide the default value in the description unless it has to be determined at runtime.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Make sure to <a href="configuration-metadata.html#configuration-metadata.annotation-processor">trigger meta-data generation</a> so that IDE assistance is available for your keys as well.
You may want to review the generated metadata (<code>META-INF/spring-configuration-metadata.json</code>) to make sure your keys are properly documented.
Using your own starter in a compatible IDE is also a good idea to validate that quality of the metadata.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-auto-configuration.custom-starter.autoconfigure-module"><a class="anchor" href="#features.developing-auto-configuration.custom-starter.autoconfigure-module"></a>29.5.3. The &#8220;autoconfigure&#8221; Module</h4>
<div class="paragraph">
<p>The <code>autoconfigure</code> module contains everything that is necessary to get started with the library.
It may also contain configuration key definitions (such as <code>@ConfigurationProperties</code>) and any callback interface that can be used to further customize how the components are initialized.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
You should mark the dependencies to the library as optional so that you can include the <code>autoconfigure</code> module in your projects more easily.
If you do it that way, the library is not provided and, by default, Spring Boot backs off.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Spring Boot uses an annotation processor to collect the conditions on auto-configurations in a metadata file (<code>META-INF/spring-autoconfigure-metadata.properties</code>).
If that file is present, it is used to eagerly filter auto-configurations that do not match, which will improve startup time.
It is recommended to add the following dependency in a module that contains auto-configurations:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-autoconfigure-processor&lt;/artifactId&gt;
    &lt;optional&gt;true&lt;/optional&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you have defined auto-configurations directly in your application, make sure to configure the <code>spring-boot-maven-plugin</code> to prevent the <code>repackage</code> goal from adding the dependency into the fat jar:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;project&gt;
    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
                &lt;configuration&gt;
                    &lt;excludes&gt;
                        &lt;exclude&gt;
                            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                            &lt;artifactId&gt;spring-boot-autoconfigure-processor&lt;/artifactId&gt;
                        &lt;/exclude&gt;
                    &lt;/excludes&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;
&lt;/project&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>With Gradle 4.5 and earlier, the dependency should be declared in the <code>compileOnly</code> configuration, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gradle" data-lang="gradle">dependencies {
    compileOnly "org.springframework.boot:spring-boot-autoconfigure-processor"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>With Gradle 4.6 and later, the dependency should be declared in the <code>annotationProcessor</code> configuration, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-gradle" data-lang="gradle">dependencies {
    annotationProcessor "org.springframework.boot:spring-boot-autoconfigure-processor"
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.developing-auto-configuration.custom-starter.starter-module"><a class="anchor" href="#features.developing-auto-configuration.custom-starter.starter-module"></a>29.5.4. Starter Module</h4>
<div class="paragraph">
<p>The starter is really an empty jar.
Its only purpose is to provide the necessary dependencies to work with the library.
You can think of it as an opinionated view of what is required to get started.</p>
</div>
<div class="paragraph">
<p>Do not make assumptions about the project in which your starter is added.
If the library you are auto-configuring typically requires other starters, mention them as well.
Providing a proper set of <em>default</em> dependencies may be hard if the number of optional dependencies is high, as you should avoid including dependencies that are unnecessary for a typical usage of the library.
In other words, you should not include optional dependencies.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Either way, your starter must reference the core Spring Boot starter (<code>spring-boot-starter</code>) directly or indirectly (i.e. no need to add it if your starter relies on another starter).
If a project is created with only your custom starter, Spring Boot&#8217;s core features will be honoured by the presence of the core starter.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.kotlin"><a class="anchor" href="#features.kotlin"></a>30. Kotlin support</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a href="https://kotlinlang.org">Kotlin</a> is a statically-typed language targeting the JVM (and other platforms) which allows writing concise and elegant code while providing <a href="https://kotlinlang.org/docs/reference/java-interop.html">interoperability</a> with existing libraries written in Java.</p>
</div>
<div class="paragraph">
<p>Spring Boot provides Kotlin support by leveraging the support in other Spring projects such as Spring Framework, Spring Data, and Reactor.
See the <a href="https://docs.spring.io/spring-framework/docs/5.3.9/reference/html/languages.html#kotlin">Spring Framework Kotlin support documentation</a> for more information.</p>
</div>
<div class="paragraph">
<p>The easiest way to start with Spring Boot and Kotlin is to follow <a href="https://spring.io/guides/tutorials/spring-boot-kotlin/">this comprehensive tutorial</a>.
You can create new Kotlin projects via <a href="https://start.spring.io/#!language=kotlin">start.spring.io</a>.
Feel free to join the #spring channel of <a href="https://slack.kotlinlang.org/">Kotlin Slack</a> or ask a question with the <code>spring</code> and <code>kotlin</code> tags on <a href="https://stackoverflow.com/questions/tagged/spring+kotlin">Stack Overflow</a> if you need support.</p>
</div>
<div class="sect2">
<h3 id="features.kotlin.requirements"><a class="anchor" href="#features.kotlin.requirements"></a>30.1. Requirements</h3>
<div class="paragraph">
<p>Spring Boot requires at least Kotlin 1.3.x and manages a suitable Kotlin version via dependency management.
To use Kotlin, <code>org.jetbrains.kotlin:kotlin-stdlib</code> and <code>org.jetbrains.kotlin:kotlin-reflect</code> must be present on the classpath.
The <code>kotlin-stdlib</code> variants <code>kotlin-stdlib-jdk7</code> and <code>kotlin-stdlib-jdk8</code> can also be used.</p>
</div>
<div class="paragraph">
<p>Since <a href="https://discuss.kotlinlang.org/t/classes-final-by-default/166">Kotlin classes are final by default</a>, you are likely to want to configure <a href="https://kotlinlang.org/docs/reference/compiler-plugins.html#spring-support">kotlin-spring</a> plugin in order to automatically open Spring-annotated classes so that they can be proxied.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/FasterXML/jackson-module-kotlin">Jackson&#8217;s Kotlin module</a> is required for serializing / deserializing JSON data in Kotlin.
It is automatically registered when found on the classpath.
A warning message is logged if Jackson and Kotlin are present but the Jackson Kotlin module is not.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
These dependencies and plugins are provided by default if one bootstraps a Kotlin project on <a href="https://start.spring.io/#!language=kotlin">start.spring.io</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features.kotlin.null-safety"><a class="anchor" href="#features.kotlin.null-safety"></a>30.2. Null-safety</h3>
<div class="paragraph">
<p>One of Kotlin&#8217;s key features is <a href="https://kotlinlang.org/docs/reference/null-safety.html">null-safety</a>.
It deals with <code>null</code> values at compile time rather than deferring the problem to runtime and encountering a <code>NullPointerException</code>.
This helps to eliminate a common source of bugs without paying the cost of wrappers like <code>Optional</code>.
Kotlin also allows using functional constructs with nullable values as described in this <a href="https://www.baeldung.com/kotlin-null-safety">comprehensive guide to null-safety in Kotlin</a>.</p>
</div>
<div class="paragraph">
<p>Although Java does not allow one to express null-safety in its type system, Spring Framework, Spring Data, and Reactor now provide null-safety of their API via tooling-friendly annotations.
By default, types from Java APIs used in Kotlin are recognized as <a href="https://kotlinlang.org/docs/reference/java-interop.html#null-safety-and-platform-types">platform types</a> for which null-checks are relaxed.
<a href="https://kotlinlang.org/docs/reference/java-interop.html#jsr-305-support">Kotlin&#8217;s support for JSR 305 annotations</a> combined with nullability annotations provide null-safety for the related Spring API in Kotlin.</p>
</div>
<div class="paragraph">
<p>The JSR 305 checks can be configured by adding the <code>-Xjsr305</code> compiler flag with the following options: <code>-Xjsr305={strict|warn|ignore}</code>.
The default behavior is the same as <code>-Xjsr305=warn</code>.
The <code>strict</code> value is required to have null-safety taken in account in Kotlin types inferred from Spring API but should be used with the knowledge that Spring API nullability declaration could evolve even between minor releases and more checks may be added in the future).</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Generic type arguments, varargs and array elements nullability are not yet supported.
See <a href="https://jira.spring.io/browse/SPR-15942">SPR-15942</a> for up-to-date information.
Also be aware that Spring Boot&#8217;s own API is <a href="https://github.com/spring-projects/spring-boot/issues/10712">not yet annotated</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features.kotlin.api"><a class="anchor" href="#features.kotlin.api"></a>30.3. Kotlin API</h3>
<div class="sect3">
<h4 id="features.kotlin.api.run-application"><a class="anchor" href="#features.kotlin.api.run-application"></a>30.3.1. runApplication</h4>
<div class="paragraph">
<p>Spring Boot provides an idiomatic way to run an application with <code>runApplication&lt;MyApplication&gt;(*args)</code> as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">import org.springframework.boot.autoconfigure.SpringBootApplication
import org.springframework.boot.runApplication

@SpringBootApplication
class MyApplication

fun main(args: Array&lt;String&gt;) {
    runApplication&lt;MyApplication&gt;(*args)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a drop-in replacement for <code>SpringApplication.run(MyApplication::class.java, *args)</code>.
It also allows customization of the application as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">runApplication&lt;MyApplication&gt;(*args) {
    setBannerMode(OFF)
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="features.kotlin.api.extensions"><a class="anchor" href="#features.kotlin.api.extensions"></a>30.3.2. Extensions</h4>
<div class="paragraph">
<p>Kotlin <a href="https://kotlinlang.org/docs/reference/extensions.html">extensions</a> provide the ability to extend existing classes with additional functionality.
The Spring Boot Kotlin API makes use of these extensions to add new Kotlin specific conveniences to existing APIs.</p>
</div>
<div class="paragraph">
<p><code>TestRestTemplate</code> extensions, similar to those provided by Spring Framework for <code>RestOperations</code> in Spring Framework, are provided.
Among other things, the extensions make it possible to take advantage of Kotlin reified type parameters.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="features.kotlin.dependency-management"><a class="anchor" href="#features.kotlin.dependency-management"></a>30.4. Dependency management</h3>
<div class="paragraph">
<p>In order to avoid mixing different versions of Kotlin dependencies on the classpath, Spring Boot imports the Kotlin BOM.</p>
</div>
<div class="paragraph">
<p>With Maven, the Kotlin version can be customized via the <code>kotlin.version</code> property and plugin management is provided for <code>kotlin-maven-plugin</code>.
With Gradle, the Spring Boot plugin automatically aligns the <code>kotlin.version</code> with the version of the Kotlin plugin.</p>
</div>
<div class="paragraph">
<p>Spring Boot also manages the version of Coroutines dependencies by importing the Kotlin Coroutines BOM.
The version can be customized via the <code>kotlin-coroutines.version</code> property.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<code>org.jetbrains.kotlinx:kotlinx-coroutines-reactor</code> dependency is provided by default if one bootstraps a Kotlin project with at least one reactive dependency on <a href="https://start.spring.io/#!language=kotlin">start.spring.io</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features.kotlin.configuration-properties"><a class="anchor" href="#features.kotlin.configuration-properties"></a>30.5. @ConfigurationProperties</h3>
<div class="paragraph">
<p><code>@ConfigurationProperties</code> when used in combination with <a href="#features.external-config.typesafe-configuration-properties.constructor-binding"><code>@ConstructorBinding</code></a> supports classes with immutable <code>val</code> properties as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-kotlin" data-lang="kotlin">@ConstructorBinding
@ConfigurationProperties("example.kotlin")
data class KotlinExampleProperties(
        val name: String,
        val description: String,
        val myService: MyService) {

    data class MyService(
            val apiToken: String,
            val uri: URI
    )
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
To generate <a href="configuration-metadata.html#configuration-metadata.annotation-processor">your own metadata</a> using the annotation processor, <a href="https://kotlinlang.org/docs/reference/kapt.html"><code>kapt</code> should be configured</a> with the <code>spring-boot-configuration-processor</code> dependency.
Note that some features (such as detecting the default value or deprecated items) are not working due to limitations in the model kapt provides.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="features.kotlin.testing"><a class="anchor" href="#features.kotlin.testing"></a>30.6. Testing</h3>
<div class="paragraph">
<p>While it is possible to use JUnit 4 to test Kotlin code, JUnit 5 is provided by default and is recommended.
JUnit 5 enables a test class to be instantiated once and reused for all of the class&#8217;s tests.
This makes it possible to use <code>@BeforeAll</code> and <code>@AfterAll</code> annotations on non-static methods, which is a good fit for Kotlin.</p>
</div>
<div class="paragraph">
<p>To mock Kotlin classes, <a href="https://mockk.io/">MockK</a> is recommended.
If you need the <code>Mockk</code> equivalent of the Mockito specific <a href="#features.testing.spring-boot-applications.mocking-beans"><code>@MockBean</code> and <code>@SpyBean</code> annotations</a>, you can use <a href="https://github.com/Ninja-Squad/springmockk">SpringMockK</a> which provides similar <code>@MockkBean</code> and <code>@SpykBean</code> annotations.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.kotlin.resources"><a class="anchor" href="#features.kotlin.resources"></a>30.7. Resources</h3>
<div class="sect3">
<h4 id="features.kotlin.resources.further-reading"><a class="anchor" href="#features.kotlin.resources.further-reading"></a>30.7.1. Further reading</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://kotlinlang.org/docs/reference/">Kotlin language reference</a></p>
</li>
<li>
<p><a href="https://kotlinlang.slack.com/">Kotlin Slack</a> (with a dedicated #spring channel)</p>
</li>
<li>
<p><a href="https://stackoverflow.com/questions/tagged/spring+kotlin">Stackoverflow with <code>spring</code> and <code>kotlin</code> tags</a></p>
</li>
<li>
<p><a href="https://try.kotlinlang.org/">Try Kotlin in your browser</a></p>
</li>
<li>
<p><a href="https://blog.jetbrains.com/kotlin/">Kotlin blog</a></p>
</li>
<li>
<p><a href="https://kotlin.link/">Awesome Kotlin</a></p>
</li>
<li>
<p><a href="https://spring.io/guides/tutorials/spring-boot-kotlin/">Tutorial: building web applications with Spring Boot and Kotlin</a></p>
</li>
<li>
<p><a href="https://spring.io/blog/2016/02/15/developing-spring-boot-applications-with-kotlin">Developing Spring Boot applications with Kotlin</a></p>
</li>
<li>
<p><a href="https://spring.io/blog/2016/03/20/a-geospatial-messenger-with-kotlin-spring-boot-and-postgresql">A Geospatial Messenger with Kotlin, Spring Boot and PostgreSQL</a></p>
</li>
<li>
<p><a href="https://spring.io/blog/2017/01/04/introducing-kotlin-support-in-spring-framework-5-0">Introducing Kotlin support in Spring Framework 5.0</a></p>
</li>
<li>
<p><a href="https://spring.io/blog/2017/08/01/spring-framework-5-kotlin-apis-the-functional-way">Spring Framework 5 Kotlin APIs, the functional way</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="features.kotlin.resources.examples"><a class="anchor" href="#features.kotlin.resources.examples"></a>30.7.2. Examples</h4>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/sdeleuze/spring-boot-kotlin-demo">spring-boot-kotlin-demo</a>: regular Spring Boot + Spring Data JPA project</p>
</li>
<li>
<p><a href="https://github.com/mixitconf/mixit">mixit</a>: Spring Boot 2 + WebFlux + Reactive Spring Data MongoDB</p>
</li>
<li>
<p><a href="https://github.com/sdeleuze/spring-kotlin-fullstack">spring-kotlin-fullstack</a>: WebFlux Kotlin fullstack example with Kotlin2js for frontend instead of JavaScript or TypeScript</p>
</li>
<li>
<p><a href="https://github.com/spring-petclinic/spring-petclinic-kotlin">spring-petclinic-kotlin</a>: Kotlin version of the Spring PetClinic Sample Application</p>
</li>
<li>
<p><a href="https://github.com/sdeleuze/spring-kotlin-deepdive">spring-kotlin-deepdive</a>: a step by step migration for Boot 1.0 + Java to Boot 2.0 + Kotlin</p>
</li>
<li>
<p><a href="https://github.com/sdeleuze/spring-boot-coroutines-demo">spring-boot-coroutines-demo</a>: Coroutines sample project</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.container-images"><a class="anchor" href="#features.container-images"></a>31. Container Images</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is easily possible to package a Spring Boot fat jar as a docker image.
However, there are various downsides to copying and running the fat jar as is in the docker image.
There’s always a certain amount of overhead when running a fat jar without unpacking it, and in a containerized environment this can be noticeable.
The other issue is that putting your application&#8217;s code and all its dependencies in one layer in the Docker image is sub-optimal.
Since you probably recompile your code more often than you upgrade the version of Spring Boot you use, it’s often better to separate things a bit more.
If you put jar files in the layer before your application classes, Docker often only needs to change the very bottom layer and can pick others up from its cache.</p>
</div>
<div class="sect2">
<h3 id="features.container-images.layering"><a class="anchor" href="#features.container-images.layering"></a>31.1. Layering Docker Images</h3>
<div class="paragraph">
<p>To make it easier to create optimized Docker images, Spring Boot supports adding a layer index file to the jar.
It provides a list of layers and the parts of the jar that should be contained within them.
The list of layers in the index is ordered based on the order in which the layers should be added to the Docker/OCI image.
Out-of-the-box, the following layers are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>dependencies</code> (for regular released dependencies)</p>
</li>
<li>
<p><code>spring-boot-loader</code> (for everything under <code>org/springframework/boot/loader</code>)</p>
</li>
<li>
<p><code>snapshot-dependencies</code> (for snapshot dependencies)</p>
</li>
<li>
<p><code>application</code> (for application classes and resources)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following shows an example of a <code>layers.idx</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">- "dependencies":
  - BOOT-INF/lib/library1.jar
  - BOOT-INF/lib/library2.jar
- "spring-boot-loader":
  - org/springframework/boot/loader/JarLauncher.class
  - org/springframework/boot/loader/jar/JarEntry.class
- "snapshot-dependencies":
  - BOOT-INF/lib/library3-SNAPSHOT.jar
- "application":
  - META-INF/MANIFEST.MF
  - BOOT-INF/classes/a/b/C.class</code></pre>
</div>
</div>
<div class="paragraph">
<p>This layering is designed to separate code based on how likely it is to change between application builds.
Library code is less likely to change between builds, so it is placed in its own layers to allow tooling to re-use the layers from cache.
Application code is more likely to change between builds so it is isolated in a separate layer.</p>
</div>
<div class="paragraph">
<p>Spring Boot also supports layering for war files with the help of a <code>layers.idx</code>.</p>
</div>
<div class="paragraph">
<p>For Maven, refer to the <a href="https://docs.spring.io/spring-boot/docs/2.5.3/maven-plugin/reference/htmlsingle/#repackage-layers">packaging layered jar or war section</a> for more details on adding a layer index to the archive.
For Gradle, refer to the <a href="https://docs.spring.io/spring-boot/docs/2.5.3/gradle-plugin/reference/htmlsingle/#packaging-layered-archives">packaging layered jar or war section</a> of the Gradle plugin documentation.</p>
</div>
</div>
<div class="sect2">
<h3 id="features.container-images.building"><a class="anchor" href="#features.container-images.building"></a>31.2. Building Container Images</h3>
<div class="paragraph">
<p>Spring Boot applications can be containerized <a href="#features.container-images.building.dockerfiles">using Dockerfiles</a>, or by <a href="#features.container-images.building.buildpacks">using Cloud Native Buildpacks to create docker compatible container images that you can run anywhere</a>.</p>
</div>
<div class="sect3">
<h4 id="features.container-images.building.dockerfiles"><a class="anchor" href="#features.container-images.building.dockerfiles"></a>31.2.1. Dockerfiles</h4>
<div class="paragraph">
<p>While it is possible to convert a Spring Boot fat jar into a docker image with just a few lines in the Dockerfile, we will use the <a href="#features.container-images.layering">layering feature</a> to create an optimized docker image.
When you create a jar containing the layers index file, the <code>spring-boot-jarmode-layertools</code> jar will be added as a dependency to your jar.
With this jar on the classpath, you can launch your application in a special mode which allows the bootstrap code to run something entirely different from your application, for example, something that extracts the layers.</p>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
The <code>layertools</code> mode can not be used with a <a href="deployment.html#deployment.installing">fully executable Spring Boot archive</a> that includes a launch script.
Disable launch script configuration when building a jar file that is intended to be used with <code>layertools</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Here’s how you can launch your jar with a <code>layertools</code> jar mode:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ java -Djarmode=layertools -jar my-app.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will provide the following output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Usage:
  java -Djarmode=layertools -jar my-app.jar

Available commands:
  list     List layers from the jar that can be extracted
  extract  Extracts layers from the jar for image creation
  help     Help about any command</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>extract</code> command can be used to easily split the application into layers to be added to the dockerfile.
Here&#8217;s an example of a Dockerfile using <code>jarmode</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-dockerfile" data-lang="dockerfile">FROM adoptopenjdk:11-jre-hotspot as builder
WORKDIR application
ARG JAR_FILE=target/*.jar
COPY ${JAR_FILE} application.jar
RUN java -Djarmode=layertools -jar application.jar extract

FROM adoptopenjdk:11-jre-hotspot
WORKDIR application
COPY --from=builder application/dependencies/ ./
COPY --from=builder application/spring-boot-loader/ ./
COPY --from=builder application/snapshot-dependencies/ ./
COPY --from=builder application/application/ ./
ENTRYPOINT ["java", "org.springframework.boot.loader.JarLauncher"]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Assuming the above <code>Dockerfile</code> is in the current directory, your docker image can be built with <code>docker build .</code>, or optionally specifying the path to your application jar, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">$ docker build --build-arg JAR_FILE=path/to/myapp.jar .</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a multi-stage dockerfile.
The builder stage extracts the directories that are needed later.
Each of the <code>COPY</code> commands relates to the layers extracted by the jarmode.</p>
</div>
<div class="paragraph">
<p>Of course, a Dockerfile can be written without using the jarmode.
You can use some combination of <code>unzip</code> and <code>mv</code> to move things to the right layer but jarmode simplifies that.</p>
</div>
</div>
<div class="sect3">
<h4 id="features.container-images.building.buildpacks"><a class="anchor" href="#features.container-images.building.buildpacks"></a>31.2.2. Cloud Native Buildpacks</h4>
<div class="paragraph">
<p>Dockerfiles are just one way to build docker images.
Another way to build docker images is directly from your Maven or Gradle plugin, using buildpacks.
If you’ve ever used an application platform such as Cloud Foundry or Heroku then you’ve probably used a buildpack.
Buildpacks are the part of the platform that takes your application and converts it into something that the platform can actually run.
For example, Cloud Foundry’s Java buildpack will notice that you’re pushing a <code>.jar</code> file and automatically add a relevant JRE.</p>
</div>
<div class="paragraph">
<p>With Cloud Native Buildpacks, you can create Docker compatible images that you can run anywhere.
Spring Boot includes buildpack support directly for both Maven and Gradle.
This means you can just type a single command and quickly get a sensible image into your locally running Docker daemon.</p>
</div>
<div class="paragraph">
<p>Refer to the individual plugin documentation on how to use buildpacks with <a href="https://docs.spring.io/spring-boot/docs/2.5.3/maven-plugin/reference/htmlsingle/#build-image">Maven</a> and <a href="https://docs.spring.io/spring-boot/docs/2.5.3/gradle-plugin/reference/htmlsingle/#build-image">Gradle</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The <a href="https://github.com/paketo-buildpacks/spring-boot">Paketo Spring Boot buildpack</a> has also been updated to support the <code>layers.idx</code> file so any customization that is applied to it will be reflected in the image created by the buildpack.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In order to achieve reproducible builds and container image caching, Buildpacks can manipulate the application resources metadata (such as the file "last modified" information).
You should ensure that your application does not rely on that metadata at runtime.
Spring Boot can use that information when serving static resources, but this can be disabled with <code>spring.web.resources.cache.use-last-modified</code>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="features.whats-next"><a class="anchor" href="#features.whats-next"></a>32. What to Read Next</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you want to learn more about any of the classes discussed in this section, you can check out the <a href="https://docs.spring.io/spring-boot/docs/2.5.3/api/">Spring Boot API documentation</a> or you can browse the <a href="https://github.com/spring-projects/spring-boot/tree/v2.5.3">source code directly</a>.
If you have specific questions, take a look at the <a href="howto.html#howto">how-to</a> section.</p>
</div>
<div class="paragraph">
<p>If you are comfortable with Spring Boot&#8217;s core features, you can continue on and read about <a href="actuator.html#actuator">production-ready features</a>.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2021-07-22 12:51:30 UTC
</div>
</div>
</div>
</div>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>if (window.parent == window) {(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create', 'UA-2728886-23', 'auto', {'siteSpeedSampleRate': 100});ga('send', 'pageview');}</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js" data-cf-beacon='{"rayId":"67541be02e991969","token":"bffcb8a918ae4755926f76178bfbd26b","version":"2021.7.0","si":10}'></script>
</body>
</html>